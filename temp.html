<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1, maximum-scale=1, initial-scale=1, shrink-to-fit=no">
    <meta name="theme-color" id="theme-color" content="#fff">
    <meta name="msapplication-navbutton-color" id="msapplication-navbutton-color" content="#fff">
    <meta name="apple-mobile-web-app-status-bar-style" id="apple-mobile-web-app-status-bar-style" content="#fff">
    <meta http-equiv="Pragma" content="no-cache" />

            <meta http-equiv="Content-Security-Policy"
              content="script-src 'self' https://t1.daumcdn.net http://t1.daumcdn.net http://dmaps.daum.net https://d.novelpia.com https://s.novelpia.com https://appleid.cdn-apple.com https://novelpia.com https://wcs.naver.net http://wcs.naver.net https://www.gstatic.com https://nsp.pay.naver.com https://www.googletagmanager.com https://www.google-analytics.com https://connect.facebook.net https://cdn.megadata.co.kr https://dnh523js9661q.cloudfront.net https://nefing.com https://www.googleadservices.com https://googleads.g.doubleclick.net https://apis.google.com https://auth.mobilians.co.kr https://npg.settlebank.co.kr http://dynamic.criteo.com https://sslwidget.criteo.com http://fin.rainbownine.net http://fin.rainbownine.net http://static.dable.io http://cdn.taboola.com https://api3.tnkfactory.com https://static.ads-twitter.com https://analytics.tiktok.com https://api.dable.io https://trc.taboola.com http://ad-log.dable.io http://tpc.googlesyndication.com https://tags.creativecdn.com https://tenping.kr https://ssl.pstatic.net 'unsafe-inline' 'unsafe-eval' ">
        
    <link rel="apple-touch-icon" sizes="57x57" href="//images.novelpia.com/img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="//images.novelpia.com/img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="//images.novelpia.com/img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="//images.novelpia.com/img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="//images.novelpia.com/img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="//images.novelpia.com/img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="//images.novelpia.com/img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="//images.novelpia.com/img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="//images.novelpia.com/img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="//images.novelpia.com/img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="//images.novelpia.com/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="//images.novelpia.com/img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="//images.novelpia.com/img/favicon/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" id="msapplication-TileColor" content="#fff">
    <meta name="msapplication-TileImage" content="//images.novelpia.com/img/favicon/ms-icon-144x144.png">
    <meta name="google-site-verification" content="SvbsjlEBvYjVzT6qZ3uEFstMTzeRuMR6xf2x_fNnDnY" />
    <meta name="naver-site-verification" content="6b26502bc08cf8f1fda8a0f0ae2ff4bc87a2175c" />

    <!-- Twitter -->
    <meta name="twitter:site" content="@themepixels">
    <meta name="twitter:creator" content="@themepixels">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="노벨피아 - 웹소설로 꿈꾸는 세상! - 한국 멸망 후 100년이 흘렀습니다">
    <meta name="twitter:description" content=""무슨 일이 있었던 거죠?"

흠...한국이 멸망했어요. 어느 순간 갑자기 좀비, 괴물, 초능력자, 이상현상이 동시다발적으로 나타났고, 정부는 제때 대응하지 못했죠.

"네">
    <meta name="twitter:image" content="https://novelpia.com/img/novelpia2.png">

    <!-- Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="노벨피아 - 웹소설로 꿈꾸는 세상! - 한국 멸망 후 100년이 흘렀습니다">
    <meta property="og:url" content="https://novelpia.com/viewer/3929317">
    <meta property="og:description" content=""무슨 일이 있었던 거죠?"

흠...한국이 멸망했어요. 어느 순간 갑자기 좀비, 괴물, 초능력자, 이상현상이 동시다발적으로 나타났고, 정부는 제때 대응하지 못했죠.

"네">
    <meta property="og:image" content="https://novelpia.com/imagebox/cover/2cee947e7b165d4dcba1f26cdf1b5114_22741_ori.file">
    <meta property="og:image:secure_url" content="https://novelpia.com/img/novelpia2.png">
    <meta property="og:image:type" content="image/png">

    <!-- Meta -->
    <meta name="description" content=""무슨 일이 있었던 거죠?"

흠...한국이 멸망했어요. 어느 순간 갑자기 좀비, 괴물, 초능력자, 이상현상이 동시다발적으로 나타났고, 정부는 제때 대응하지 못했죠.

"네">
    <meta name="author" content="Devlife">

    <title>노벨피아 - 웹소설로 꿈꾸는 세상! - 한국 멸망 후 100년이 흘렀습니다</title>

    <!-- vendor css -->
    <link href="/lib/Ionicons/css/ionicons.css?temp=3" rel="stylesheet">
    <link href="/lib/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="/lib/jquery-toggles/toggles-full.css" rel="stylesheet">

    <!-- Amanda CSS -->
    <link rel='stylesheet' href='/css/amanda.min2.css?v=1728295643' >    <link rel="stylesheet" href="/css/jquery_toastr.min.css">
    <link rel='stylesheet' href='/css/novelpia.css?v=1728295643' >    <script src='/js/novelpia.js?v=1729214799' type='text/javascript' ></script>    <script src="/lib/jquery/jquery.min.js"></script>
    <script src="/lib/jquery/jquery_cookie.js"></script>
    <script src="/js/ramda.min.js"></script>
    <script src="/js/lang.ko.js"></script>
    <script>
        $.cookie("SITE_LANG", 'ko-KR', { expires: 2, path: '/', domain: 'novelpia.com', secure: false }) ;
    </script>
    
    <script src="/lib/jquery-toggles/toggles.min.js"></script>



    <script src="/js/jquery_toastr.min.js"></script>
    <script src="/js/amanda2.js"></script>
    <script src="/js/lazyload.js?tmp=1"></script>
    <script src="/js/jquery.switcher.min.js"></script>


    <script src="/js/jdetects.min.js?tmp=5"></script>
    <script src="/lib/popper.js/popper.js?tmp=1"></script>
    <script src="/lib/bootstrap/bootstrap.js"></script>
    <script src="/js/moment.min.js"></script>
    <script src="/js/axios.min.js"></script>

    <meta name="naver-site-verification" content="6b26502bc08cf8f1fda8a0f0ae2ff4bc87a2175c" />


            <noscript><meta http-equiv="refresh" content="0; url=/page/nojs"></noscript>
    
            <script>
            $.cookie('REF_DATA', '/viewer/3929317', { expires: 365, path: '/', domain: '.novelpia.com', secure: false });
        </script>
                <script type="text/javascript">
            // F12 버튼 방지
            $(document).ready(function(){
                var ctrlDown = false, shiftDown = false, ctrlKey = 17, cmdKey = 91, shiftKey = 16

                $(document).bind('keydown',function(e){
                    if (e.keyCode == ctrlKey || e.keyCode == cmdKey) ctrlDown = true;
                    if (e.keyCode == shiftKey) shiftDown = true;

                    if ( e.keyCode == 123 /* F12 */ || (ctrlDown && shiftDown && (e.keyCode == 67)) || (ctrlDown && shiftDown && (e.keyCode == 73)) || (ctrlDown && shiftDown && (e.keyCode == 74))) {
                        e.preventDefault();
                        e.returnValue = false;
                    }
                    if ( e.keyCode == 17 || e.keyCode == 16 || e.keyCode == 27 /* F12 */) {
                        $('#loads').hide();
                    }
                })
            });

            // 우측 클릭 방지
            // document.onmousedown=disableclick;
            // status="마우스 우클릭이 불가능 합니다.";

            // function disableclick(event){
            //     if (event.button==2) {
            //         alert(status);
            //         return false;
            //     }
            // }
        </script>
    


                <!-- Facebook Pixel Code -->
            
            <script type="text/javascript" src="/js/vue.production.js"></script>
    
    <style>
        .loads {display:none;user-select:none;position: fixed;top:0px;left:0px;right:0px;z-index:1000000;background-color:rgba(255,255,255,0.9);width:100%;height:100%;}

        

                #submenu_bar::-webkit-scrollbar {
            width: 5px; height: 5px;
        }

        #submenu_bar::-webkit-scrollbar-thumb {
            background-color: #bbb;
            background-clip: padding-box;
            border: 0px solid transparent;
            border-radius: 10px;
        }

        #submenu_bar::-webkit-scrollbar-track {
            background-color: #eee;
            border-radius: 10px;
        }
        #submenu_bar {
            padding-bottom: 6px;
        }
            </style>
    



<!-- 아래부분 주석 처리되어있던거 임시로 풀었음 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-409317505"></script>
<!-- 테스트용 추가 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-11459037694"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-11459913752"></script>
<!-- 새로 추가 240621 - ssChoi -->
<script async src="https://www.googletagmanager.com/gtag/js?id=AW-16618390941"></script>
<script>

  // 구글 서브,테스트 제거 22.06.02 - ssChoi
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'AW-409317505');
  gtag('config', 'AW-11406713813');
  //테스트용 추가
  gtag('config', 'AW-11459037694');
  gtag('config', 'AW-11459913752');
  gtag('config', 'AW-358639531');
  gtag('config', 'AW-16484715676');
  gtag('config', 'AW-16525245181');
  gtag('config', 'AW-16573513263');
  gtag('config', 'AW-16583562065');
  gtag('config', 'AW-16618390941');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-187123192-1"></script>
<script>
  gtag('config', 'UA-187123192-1');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-X2P0SJ3118"></script>
<script>
  gtag('config', 'G-X2P0SJ3118');
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-TPMXGV7');</script>
<!-- End Google Tag Manager -->

<!-- Social Google Tag Manager -->
<!-- DV360 -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-THMVXHB');</script>
<!-- End Google Tag Manager --><!-- End Google Tag Manager -->


<!-- Criteo 로더 파일 -->
<script type="text/javascript" src="//dynamic.criteo.com/js/ld/ld.js?a=90950" async="true"></script>
<!-- END Criteo 로더 파일 -->

<!-- Criteo -> bottom에 이미 있기 때문에 주석처리 -->
<script type="text/javascript">
window.criteo_q = window.criteo_q || [];
var deviceType = /iPad/.test(navigator.userAgent) ? "t" : /Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(navigator.userAgent) ? "m" : "d";
window.criteo_q.push(
 { event: "setAccount", account: 90950},
 { event: "setEmail", email: "", hash_method: "md5" },
 { event: "setZipcode", zipcode: "" },
 { event: "setSiteType", type: deviceType},
 { event: "viewHome"});
</script>
<!-- END Criteo 홈페이지 태그 -->

<script type="text/javascript" src="https://dnh523js9661q.cloudfront.net/apis/apTracker.v4.js?v=0413"></script>
<script type="text/javascript">
adpick_webtracking({ event: 'tracking' });
</script>

<!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '259877689542130');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=259877689542130&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->
<script type="text/javascript" charset="UTF-8" src="//t1.daumcdn.net/adfit/static/kp.js"></script>
<script type="text/javascript">
	  kakaoPixel('5947846367882331136').pageView();
</script>

<!-- Twitter conversion tracking base code -->
<script>
!function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
},s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='https://static.ads-twitter.com/uwt.js',
a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
twq('config','o9p8p');
twq('config','of6p2'); // 2023-06-09 cjd 트위터계정 추가
twq('config','on0nz'); // 2024-07-25 css 트위터계정 추가
</script>
<!-- End Twitter conversion tracking base code -->

<!-- 틱톡 픽셀 스크립트 START 2023.09.25 lkh tn-->
<script>
    !function (w, d, t) {
        w.TiktokAnalyticsObject=t;
        var ttq=w[t]=w[t]||[];
        ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],
            ttq.setAndDefer=function(t,e){
            t[e]=function(){
                t.push([e].concat(Array.prototype.slice.call(arguments,0)))
            }
        };
        for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);
        ttq.instance=function(t){
            for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);
            return e},
            ttq.load=function(e,n){
            var i="https://analytics.tiktok.com/i18n/pixel/events.js";
            ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};
            var o=document.createElement("script");
            o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;
            var a=document.getElementsByTagName("script")[0];
            a.parentNode.insertBefore(o,a)
        };

        ttq.load('CIHONGJC77U4TTM9TGN0');
        ttq.page();
    }(window, document, 'ttq');
</script>
<!-- 틱톡 픽셀 스크립트 END -->

<!--구글 애드센스 검중 - 2023-12-11 lkh-->
<!--<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1237751169501691" crossorigin="anonymous"></script>
<script src='//img.mobon.net/js/common/HawkEyesMaker.js'></script>-->

<!--RTBHOUSE 메인 태깅 코드-->
<script>
    (function (w,d,dn,t){w[dn]=w[dn]||[];w[dn].push({eventType:'init',value:t,dc:'asia'});
        var f=d.getElementsByTagName('script')[0],c=d.createElement('script');c.async=true;
        c.src='https://tags.creativecdn.com/Ia2n3reS3UT3JNA477ic.js';
        f.parentNode.insertBefore(c,f);})(window,document,'rtbhEvents','Ia2n3reS3UT3JNA477ic');
</script>

<!--텐핑 랜딩 페이지-->
<script src="//tenping.kr/scripts/cpa/tenping.cpa.V2_Domain.min.js"></script></head>
<body class="collapse-menu"   oncontextmenu='return false' onselectstart='return false' ondragstart='return false' >
<span itemscope="" itemtype="http://schema.org/Organization">
    <link itemprop="url" href="https://novelpia.com/">
    <a itemprop="sameAs" href="https://www.facebook.com/%EB%85%B8%EB%B2%A8%ED%94%BC%EC%95%84-349126292859014"></a>
    <a itemprop="sameAs" href="https://blog.naver.com/adnovelpia"></a>
    <a itemprop="sameAs" href="https://www.pinterest.co.kr/novelpia_official/_created/"></a>
    <a itemprop="sameAs" href="https://www.youtube.com/channel/UC4Mw_07vcLJ9uOZuukobTYQ"></a>
    <a itemprop="sameAs" href="https://twitter.com/novel_pia"></a>
    <a itemprop="sameAs" href="https://www.instagram.com/novelpia_official/"></a>
</span>

<div class="loads" style="text-align:center;">
    <div class="loading"></div>
    <br><br><span style="text-align:center;color:#666;background-color:#eeeeee66;padding:6px 16px;cursor:pointer;border-radius:10px;font-size:12px;" onclick="$('.loads').hide();">페이지로딩 닫기</span>
</div>
<script>
    const g_app = 'WEB';
</script><link rel='stylesheet' href='/css/basic_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/events.css?v=1728295643' ><link rel='stylesheet' href='/css/viewer_novelpia.css?v=1728295643' ><link rel='stylesheet' href='/css/viewer_comment.css?v=1728295643' ><link rel='stylesheet' href='/css/viewer_menu.css?v=1728295643' ><link rel='stylesheet' href='/css/openstore_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/viewer_recommend_cancel_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/viewer_recommend_toast_component.css?v=1728295643' ><link rel='stylesheet' href='/css/user_login.css?v=1728295643' ><script src='/js/viewer_novelpia_ver2.js?v=1730436810' type='text/javascript' ></script>
<link rel="stylesheet" href="/css/jquery.swiper.css">
<link rel="stylesheet" href="/lib/pickr/themes/nano.min.css"/>
<script src="/js/sortable.min.js"></script>
<script src="/js/jquery.swiper.js"></script>

<!-- 틱톡 픽셀 스크립트 START -->
<script type="text/javascript">
    // add this before event code to all pages where PII data postback is expected and appropriate
    ttq.identify({
        "email": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855", // string. The email of the customer if available. It must be hashed with SHA-256 on the client side.
        "phone_number": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855", // string. The phone number of the customer if available. It must be hashed with SHA-256 on the client side.
        "external_id": "5feceb66ffc86f38d952786c6d696c79c2dbc239dd4e91b46729d73a27fb57e9", // A unique ID from the advertiser such as user or external cookie IDs. It must be hashed with SHA256 on the client side.
    });

    ttq.track('ViewContent', {
        "contents": [{
            "content_id": "3929317", // string. ID of the product. Example: "1077218".
        }],
        "value": "1", // number. Value of the order or items sold. Example: 100.
        "currency": "KRW", // string. The 4217 currency code. Example: "USD".
        "query": "한국 멸망 후 100년이 흘렀습니다", // string. The word or phrase used to search. Example: "SAVE10COUPON".
    });
</script>
<!-- 틱톡 픽셀 스크립트 END -->
<!--RTBHOUSE 장바구니 추가 코드-->
<script>
    (rtbhEvents = window.rtbhEvents || []).push(
        {
            eventType: 'basketadd',
            offerId: '310060'
        },
        {
            eventType: 'uid',
            id: '0'
        });
</script>




    <script>
        let localStorageData = localStorage.getItem('userLastNovelData');
        let novelDataArray = [];
        let novelData = {content_data : {"novel_no":"310060","novel_name":"\ud55c\uad6d \uba78\ub9dd \ud6c4 100\ub144\uc774 \ud758\ub800\uc2b5\ub2c8\ub2e4","novel_search":"\u314e\u314f\u3134\u3131\u315c\u3131 \u3141\u3155\u3139\u3141\u314f\u3147 \u314e\u315c 100\u3134\u3155\u3134\u3147\u3163 \u314e\u3161\u3139\u3139\u3153\u3146\u3145\u3161\u3142\u3134\u3163\u3137\u314f|\u314e\u314f\u3131\u315c \u3141\u3155\u3141\u314f \u314e\u315c 100\u3134\u3155\u3147\u3163 \u314e\u3161\u3139\u3153\u3145\u3161\u3134\u3163\u3137\u314f|\u314e\u3131 \u3141\u3141 \u314e 100\u3134\u3147 \u314e\u3139\u3145\u3134\u3137","novel_subtitle":null,"novel_age":"0","mem_no":"1210394","novel_thumb":"","novel_img":null,"novel_thumb_all":"\/imagebox\/cover\/2cee947e7b165d4dcba1f26cdf1b5114_22741_ori.file","novel_img_all":"\/imagebox\/cover\/2cee947e7b165d4dcba1f26cdf1b5114_22741_q_ori.file","novel_count":"0","novel_status":"1","novel_type":"2","novel_genre":"[\"\ud604\ub300\ud310\ud0c0\uc9c0\",\"\ud310\ud0c0\uc9c0\",\"\ud604\ub300\",\"\ud558\ub818\",\"\uc544\ud3ec\uce7c\ub9bd\uc2a4\",\"\uc880\ube44\",\"\ub098\ub808\uc774\uc158\"]","novel_story":"\"\ubb34\uc2a8 \uc77c\uc774 \uc788\uc5c8\ub358 \uac70\uc8e0?\"\r\n\r\n\ud760...\ud55c\uad6d\uc774 \uba78\ub9dd\ud588\uc5b4\uc694. \uc5b4\ub290 \uc21c\uac04 \uac11\uc790\uae30 \uc880\ube44, \uad34\ubb3c, \ucd08\ub2a5\ub825\uc790, \uc774\uc0c1\ud604\uc0c1\uc774 \ub3d9\uc2dc\ub2e4\ubc1c\uc801\uc73c\ub85c \ub098\ud0c0\ub0ac\uace0, \uc815\ubd80\ub294 \uc81c\ub54c \ub300\uc751\ud558\uc9c0 \ubabb\ud588\uc8e0.\r\n\r\n\"\ub124?\r\n\r\n\uadf8\uac8c \ubc8c\uc368 100\ub144\uc774\ub124\uc694.\r\n\r\n\"\ub124\uc5d0\uc5d0?\"","novel_weekly":"106","novel_notice":null,"novel_plus_want":"0","count_view":"97","count_good":"6","count_book":"6","count_pick":"0","writer_nick":"\ub3c4\uc11c\ubd80\uc6d0","writer_original":"","isbn":"","last_viewdate":"2024-10-08 18:32:48","is_monopoly":"0","is_del":"0","is_complete":"0","is_donation_refusal":"0","is_secondary_creation":"0","is_contest":"15","start_date":"2024-10-05 10:00:00","status_date":"2024-11-05 15:00:19","del_date":null,"complete_date":null,"plus_date":null,"plus_call_date":null,"plus_check_admin_no":null,"last_write_date":null,"novel_live":"0","live_stop_end_date":null,"is_indent":"0","main_genre":"12","is_osmu":null,"flag_collect":"0","local_code":"ko","monopoly_date":null,"flag_img_policy":"1","flag_translate":"0","reg_date":"2024-10-05 02:08:31","update_dt":"2024-10-09 01:49:10","plus_start_date":null,"mem_nick":"\ub3c4\uc11c\ubd80\uc6d0"}, episode_no : 3929317, viewer_type : 'novel'};
        if(localStorageData !== null){
            novelDataArray = JSON.parse(localStorageData);
            //에피소드만 업데이트
            let delIndex = novelDataArray.findIndex(items => items.content_data.novel_no == 310060);
            if(delIndex >= 0){
                novelDataArray.splice(delIndex, 1);
            }
        }
        novelDataArray.push(novelData);
        if(novelDataArray.length > 2){
            novelDataArray.shift();
        }
        localStorage.setItem('userLastNovelData',JSON.stringify(novelDataArray));
    </script>
    <script> $.cookie('out_url', '/viewer/3929317', { path: '/', domain: 'novelpia.com', secure: false });</script><link rel='stylesheet' href='/css/metacraft_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/sub_sale_modal_v3.css?v=1728886750' ><style>
.modal_background{
	width: 100%;
    height: 100%;
    position: absolute;
    background: rgba(0, 0, 0, 0.6);
    z-index: 999;
}
#sub_sale_modal_v3 .layer-close-x {
    position: absolute;
    top: 0;
    right: 0;
    width: 70px;
    height: 70px;
    color: #000;
    z-index: 5;
    text-align: center;
    line-height: 50px;
    cursor: pointer;
}
#sub_sale_modal_v3 .layer-close-x:after {
    display: inline-block;
    content: "\00d7";
    font-size: 30px;
}
	#sub_sale_modal_v3 {
		background:#fff;
		border:1px solid #000;
		max-width:500px;
		width:100%;
		margin: 0 auto;
		background-color: #fff;
		display: flex;
		flex-direction: column;
		align-items: center;	
		text-align:center;
	}


	#sub_sale_modal_v3 .modal-title img{
		max-width:450px;
		width:100%;
		margin-top:20px;
	}
	#sub_sale_modal_v3 .madal-notice h1{
		font-size:24px;		
		font-weight:600;
		margin-bottom: 10px;
		margin-top: 10px;
	}
	#sub_sale_modal_v3 .madal-notice h1 span{
		color:#ff5998;
	}
	#sub_sale_modal_v3 .madal-notice p{
		font-size:18px;
		margin-top: 0px;
		margin-bottom:5px;
		font-weight:400;
	}	
	#sub_sale_modal_v3 .madal-notice p span{
		color:#7632ff;
	}
	#sub_sale_modal_v3 .modal-btn{
		max-width:450px;
		width:100%;
		margin-bottom:20px;
	}
	#sub_sale_modal_v3 .modal-btn button{
		max-width:450px;
		width:100%;
		background:#7632FF;
		color:#fff;
		border:none;
		outline:none;
		padding:15px 0;
		font-size:16px;
		margin-top:20px;
		cursor:pointer;
	}
	#sub_sale_modal_v3 .modal-btn p{
		text-decoration: underline;
		color:#666666;
		font-size:14px;
		margin-top:5px;
		cursor:pointer;
	}
	#sub_sale_modal_v3 .basic-modal-close{
		background-size: 100% !important;
	}

	#sub_sale_modal_v3 ul, #sub_sale_modal_v3 ol {
		margin: 0;
		padding:0px;
		list-style-position: inside;
		text-align:left;     
		width: 450px;
	}
	#sub_sale_modal_v3 ul{
		padding: 10px 0 10px 20px;
		background: #f7f7f7;
	}
	#sub_sale_modal_v3 ol {
	  	list-style-image: url("data:image/svg+xml;charset=UTF-8,<svg xmlns='http://www.w3.org/2000/svg' height='15' width='15' viewBox='0 0 24 24' fill='none' stroke='black' stroke-width='3'><polyline points='20 6 9 17 4 12'></polyline></svg>");
	}

	#sub_sale_modal_v3 ol li{
		padding:0px;
		margin: 0;
		font-size:16px;
		font-weight:500;
		line-height:35px;
	}

	@media screen and (max-width: 891px) {
		#sub_sale_modal_v3 {
			max-width: 350px;
			width: 100%;
		}
		#sub_sale_modal_v3 .modal-title img {
			max-width: 300px;
			width: 100%;
			margin-top: 21px;
		}
		#sub_sale_modal_v3 .modal-btn button {
			 max-width: 300px;
			 margin-top: 10px;
		}
		#sub_sale_modal_v3 .madal-notice h1 {
			font-size: 20px;
			margin-bottom: 5px;
		}
		#sub_sale_modal_v3 .madal-notice p {
			 font-size: 16px;
		}
		#sub_sale_modal_v3 ol li{
			font-size:14px;
			line-height:25px;
		}
		 #sub_sale_modal_v3 ul, #sub_sale_modal_v3 ol {
		 width:300px;
		  }
	}
</style>

<div class="modal_background"></div>

<div class="sub-sale-modal-v2" id="sub_sale_modal_v3" >
	<div><div href="" class="layer-close-x"></div></div>
	<div class="modal-title"><img src="//images.novelpia.com/img/new/event/sub_sale/ver2/new/age_first_bnr.png"></div>
	<div class="madal-notice">
		<h1><span>첫 구독 무료</span> 혜택 받으세요!</h1>		
		<p>지금 구독하면 한 달 동안 0원에 <br><span>유료 웹소설/웹만화 무제한 열람</span></p>
		<!--ul>
			<ol>
				<li>인기 웹소설 유료회차 열람</li>
				<li>성인/전 연령 웹만화 유료회차 열람</li>
				<li>언제든지 해지 가능</li>
			</ol>
		</ul-->
	</div>
	<div class="modal-btn">
					<button class="plus_payment_go">혜택 받기</button>
				<p class="modal_close_btn">괜찮아요, 무료회차만 볼게요.</p>
	</div>
</div>


<script>

let is_viewer = "1";

function go_auth(){
	//$.cookie('_redirectrurl',, {  path: '/', domain: 'novelpia.com', secure: false });
	location.href = "/page/age_auth?adult=1";
}

function sub_sale_modal_close(){
	$('#sub_sale_modal_v3').hide();
}

function location_go(){
	if(is_viewer == 1){
		sub_sale_chk();
	}else{
		location.href = "/event/plus_free";
	}
}

function sub_sale_chk(){
	const sub_sale_flag = "1";
	const sub_sale_phone = "0";

	if(sub_sale_flag == 0){
		return 0;
	}

	if(sub_sale_flag != 0 && sub_sale_phone == 0 ){
		$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3P3BheW1lbnQ9MQ==', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		location.href = "/page/age_auth?adult=1";
	}

	if(sub_sale_flag != 0 && sub_sale_phone == 1){
		$('#sub_sale_modal_v3').hide();
		$('#payment_app').show();
	}
}

$('.layer-close-x, .modal_close_btn').click(function(){
	$.cookie('first_viewer_modal', '1', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
	$('#sub_sale_modal_v3').hide();
	$('.modal_background').hide();
});

$('.plus_payment_go').click(function(){
	location.href="/event/plus_free?event=is_member_login";
});

$('.payment_modal_on').click(function(){
	$('#sub_sale_modal_v3').hide();
	$('#payment_app').show();
	//$('#plus_payment_modal').modal('show');
});

</script><link rel='stylesheet' href='/css/plus_payment_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/metacraft_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/sub_sale_modal.css?v=1728295643' ><style>
#sub_sale_modal .modal-wrapper {
	background-color: #fff;
	display: flex;
	flex-direction: column;
	align-items: center;
	top: 50%;
    transform: translateY(-50%);
}

#sub_sale_modal .main-modal-wrapper {
	display: flex;
	flex-direction: column;
	align-items: center;
	/* padding-bottom:40px; */
}

#sub_sale_modal .modal-title img{
	width:100%;
}
	
#sub_sale_modal .boss-img{
	overflow:hidden;
	/* height:260px; */
}

#sub_sale_modal .boss-img img {
    position: relative;
	/*
    width: 150%;
    top: 50%;
    left: 50%;
    transform: translate(-50%,-55%);
	*/
}

#sub_sale_modal .btn-go-wnp{
	max-width:388px;
	width:100%;
}

#sub_sale_modal .basic-modal-top{
	position:absolute;
	top:0;
	z-index:999;
}
#sub_sale_modal .basic-modal-close{
	background-size: 100% !important;
}

@media screen and (max-width: 891px) {

	#sub_sale_modal .modal-wrapper {
	}

	#sub_sale_modal .boss-img{
		height:auto;
	}

	#sub_sale_modal .boss-img img {
		/*
        top: 50%;
        left: 50%;
        transform: translate(-50%, -5%);
		*/
        margin: auto;
        max-height: 260px;
	}

	#sub_sale_modal .main-modal-wrapper {
		/* padding-bottom:25px; */
	}

	#sub_sale_modal .btn-go-wnp{
		width:80%;
		margin:auto;
		text-align:center;
	}

}

</style>




<div class="sub-sale-modal " id="sub_sale_modal">
    <div class="modal-wrapper">
		<div class="basic-modal-top">
			<div class="basic-modal-name"></div>
			<div class="basic-modal-close"></div>
		</div>
        <div class="target-modal">
            <div class="pop_ad" style="width: 100%;">
                <div class="main-modal-wrapper">
                    <div class="boss-img">
                        <img src="">
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-button-wrapper" style="width: 100%;">
            <button class="detail-modal-button " onclick="go_auth();" style="width: 100%; background:#000;" data-dismiss="modal">본인인증 하러가기</button>
        </div>
    </div>
</div>



<script >

function go_auth(){
	//$.cookie('_redirectrurl',"\/viewer\/3929317", {  path: '/', domain: 'novelpia.com', secure: false });
	location.href = "/page/age_auth?adult=1";
}

$('.basic-modal-close').click(function(){
	$('#sub_sale_modal').hide();
});

</script><script type="module">
    const app = new Vue({
        el: '#payment_app',
        data: {
            num: 10,
            goods: 1,
            is_viewer: true,
            viewer_page: "viewer",
            app_store: 'WEB',
            app_version: '0',

            mem_no: 0,
            is_first_payment: false,
            is_secret_mode: is_secret_mode(),

            is_plus_payment_agree: false,

            stat_induce_pay: '21',
            induce_type: '3',
            induce_flag_type: '22',

            content_no: '310060',

			sub_sale_flag: '1',
			sub_sale_phone: '0',
			is_100: 1,	// 100원 이벤트 flag
        },
        methods: {
            login() {
                this.close();
                member_login_modal_on();
            },
            pay(pg_type) {
                if(this.mem_no === 0) {
                    alert('로그인 후 결제 가능합니다.');
                    this.login();
                    return false;
                }
                if(this.is_plus_payment_agree === false) {
                    alert('구독 안내사항에 동의해주시기 바랍니다.');
                    return false;
                }
                let url = '';

				if(this.num == 10){
					if(this.is_100 == 1){
						this.goods = 7;
					}else{
						this.goods = 2;
					}
				}

                switch(pg_type) {
                    case 'naverpay':
                        url = `https://pay.novelpia.com/pay/naver/step1?goods=${this.goods}&site=novelpia`;
                        break;
                    case 'kakaopay':
                        url = `https://pay.novelpia.com/kakaopay/payment?goods=${this.goods}&_redirectrurl=%2Fviewer%2F3929317`;
                        break;
                    case 'toss':
                        url = `https://pay.novelpia.com/toss/payment?goods=${this.goods}&_redirectrurl=%2Fviewer%2F3929317`;
                        break;
                    default:
                        return false;
                        break;
                }
			    $.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
                window.open(url, 'payment_popup', 'width=500,height=600');
            },
            back() {
                if(this.is_viewer === true && this.induce_flag_type == '25'){
                    location.href = `/comic_episode/${this.content_no}`;
                } else if (this.is_viewer === true && this.induce_flag_type == '22'){
                    location.href = `/novel/${this.content_no}`;
                } else {
                    //location.href =  '/';
                    this.close();
                }
            },
			event_back() {
				// 100원 이벤트 이탈시 1개월 단일이용권 체크
				this.form_data_init(2);
			},
			event_back2(){
				if(this.is_viewer === true){
					this.form_data_init(7);
					if(this.viewer_page == "viewer"){
						location.href = `/novel/${this.content_no}`;
					}else if(this.viewer_page == "comic"){
						location.href = `/comic_episode/${this.content_no}`;
					}else{
						location.href = `/`;
					}
				}else{
					this.close();
					this.form_data_init(7);
				}
			},
			form_data_init(goods){
				if(goods == 2){
					this.is_100 = 0;
					this.goods = 2;
					$('#induce_goods_no').val(this.goods);
					$('.mchtId_class').val('novelpia');
					$('.autoPayType_class').val('');
					$('.pmtPrdtNm_class').val("PLUS 멤버십 구독권");
					$('.settle_amount').val(16900);
					$('.settle_param').val(this.mem_no+"|"+this.goods);
				}else if(goods == 7){
					this.is_100 = 1;
					this.goods = 7;
					$('#induce_goods_no').val(this.goods);
					$('.mchtId_class').val('novelpia2');
					$('.autoPayType_class').val('M');
					$('.pmtPrdtNm_class').val("PLUS 월 정기 구독");
					$('.settle_amount').val(100);
					$('.settle_param').val(this.mem_no+"|"+this.goods);
				}
			},
            open() {
                $('#plus_payment_modal').modal('show');
            },
            set_cookie_payment() {
                $.cookie('modal_flag_type', this.num, { expires: 1, path: '/', domain: 'novelpia.com' , secure: false });
                $.cookie('induce_flag_type', this.induce_flag_type, { expires: 1, path: '/', domain: 'novelpia.com' , secure: false }); // 결제추적
                $.cookie('induce_type', this.induce_type, { expires: 1, path: '/', domain: 'novelpia.com' , secure: false }); // 결제추적
                $.cookie('induce_is_first', this.is_first_payment, { expires: 1, path: '/', domain: 'novelpia.com' , secure: false }); // 결제추적
                //$.cookie('_redirectrurl', '//', { path: '/', domain: '//', secure: false });
            },
            close() {
                $('#plus_payment_modal').modal('hide');
            },
            toggle_plus_policy() {
                $('.plus-pay-folding-info-v2').toggle();
            },
			modal_show(){
				if(this.num == 10){
					$('#sub_sale_modal').show();
				}
			},
			sub_modal_check(item){
				if(this.sub_sale_phone == 0){
					if(confirm("본인인증이 필요합니다.")){
						location.href="/page/age_auth?adult=1";
					}else{
						document.getElementById(item).checked = false;
					}
				}
				
			}
        },
        mounted() {
            this.set_cookie_payment();
			if(this.num == 10){
				this.goods = 7;
				$('#induce_goods_no').val(this.goods);
				$('.settle_amount').val(100);
				$('.settle_param').val(this.mem_no+"|"+this.goods);
			} else {
                if(this.viewer_page == 'viewer') {                     /*inc_stat("stat_induce_pay", {
                        flag_type: this.stat_induce_pay,
                        item_no: this.goods
                    });*/
                    // this.open();
                }
            }
        }
    });
</script>
<div id="payment_app">
    <template v-if="num === 1">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background" data-backdrop="">
            <div class="plus_payment_all_wrapper">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_03-3.png">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span>상품정보</span>
                                    <span v-if="is_first_payment === true">PLUS 월정기 멤버십 + <img class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span v-else>PLUS 월정기 멤버십</span>
                                </div>
                                <div>
                                    <span>총 상품금액</span>
                                    <span>9,900원</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
									<p>∙ 100원 프로모션 구독 상품은 첫 달 100원이 결제되며, 다음 구독 갱신일부터 9900원이 결제됩니다.</p>
									<p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
									<p>∙ 이미 구독한 상품을 재차 구독 시 이용 가능 기간이 추가되나, 일부 상품은 재차 구독이 제한될 수 있습니다.</p>
									<p>∙ 구독 상품은 모든 디바이스에서 자유롭게 사용 가능합니다.</p>
									<p>∙ 정기구독 상품은 다음 구독 갱신일까지 이용가능한 상품이며, 매월 동일 일자에 갱신됩니다.</p>
									<p>∙ 휴대전화, ARS를 이용하여 구독한 상품의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
									<p>∙ 콘텐츠 제공을 개시하는 등의 사유가 있을 경우 환불에 제한이 있을 수 있습니다.</p>
									<p>∙ 구독이 완료되기 전에 구독 화면을 닫을 경우, 구독이 완료되지 않을 수 있습니다.</p>
									<p>∙ 각 프로모션 및 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>
    <template v-else-if="num === 2">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-2" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_01-2.png">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <span class="plus-top-box-v2-title"><img class="" src="//images.novelpia.com/img/new/plus/gift_icon.png"> PLUS 월 정기 멤버십 구독 시 혜택</span>
                                <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                <span v-if="is_first_payment === true"><i class="ion ion-checkmark"></i> <img class="" src="//images.novelpia.com/img/new/icon/bronze.png"> 뱃지 업그레이드</span>
                            </div>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span>상품정보</span>
                                    <span v-if="is_first_payment === true">PLUS 월정기 멤버십 + <img class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span v-else>PLUS 월정기 멤버십</span>
                                </div>
                                <div>
                                    <span>총 상품금액</span>
                                    <span>9,900원</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>

                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>
    <template v-else-if="num === 3">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-3" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_02-2.png">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span class="plus-top-box-v2-title">PLUS 월정기 멤버십 <img v-if="is_first_payment === true" class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span>9,900원</span>
                                </div>
                                <div>
                                    <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                    <span v-if="is_first_payment === true"><i class="ion ion-checkmark"></i> <img class="" src="//images.novelpia.com/img/new/icon/bronze.png"> 뱃지 업그레이드</span>
                                </div>
                            </div>
                            <div class="plus-top-box-v2">
                                <div>
                                    <p>
                                        <img class="" src="//images.novelpia.com/img/new/plus/plus_novel.png">
                                    </p>
                                </div>
                                <div>
                                    <p><span>구독 해지는 언제 어디서든 간편</span>하게 가능하니까! 부담 없이 시작하세요~</p>
                                </div>
                            </div>

                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>
    <template v-if="num === 4">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-4" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_04-2.png">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus_payment_content_wrapper">
                                <div class="plus-top-box-v2">
                                    <div>
                                        <span v-if="is_first_payment === true">PLUS 월정기 멤버십 + <img src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                        <span v-else>PLUS 월정기 멤버십</span>
                                        <span>9,900원</span>
                                    </div>
                                </div>
                                <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                                <div class="plus-pay-v2">
                                    <div class="settle_mobile_pay">
                                        <img src="/img/new/plus/plus_pay_phone.png">
                                        <span>휴대폰</span>
                                    </div>
                                    <div class="settle_card_pay">
                                        <img src="/img/new/plus/plus_pay_card.png">
                                        <span>신용카드</span>
                                    </div>
                                    <div @click="pay('naverpay')">
                                        <img src="/img/new/plus/plus_pay_naver.png">
                                        <span>네이버페이</span>
                                    </div>
                                    <div @click="pay('kakaopay')">
                                        <img src="/img/new/plus/plus_pay_kakao.png">
                                        <span>카카오페이</span>
                                    </div>
                                    <div @click="pay('toss')">
                                        <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                        <span>토스</span>
                                    </div>
                                </div>
                                <div class="plus-pay-folding-v2">
                                    <div class="plus-pay-folding-title-v2">
                                        <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                        <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                        <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                    </div>
                                    <div class="plus-pay-folding-info-v2">
                                        <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                        <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                        <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                        <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                        <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>

    <template v-else-if="num === 5">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-5" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_05.jpg">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span class="plus-top-box-v2-title">PLUS 월정기 멤버십 <img v-if="is_first_payment === true" class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <div class="plus-box-price-compare">
                                        <span>16,900원</span>
                                        <span>9,900원</span>
                                    </div>
                                </div>
                                <div>
                                    <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                </div>
                            </div>
                            <div class="plus-top-box-v2">
                                <div>
                                    <p>
                                        <img class="" src="//images.novelpia.com/img/new/plus/plus_novel.png">
                                    </p>
                                </div>
                                <div>
                                    <p>이 다음화 부터는 구독이 필요한 회차입니다.</p>
                                </div>
                            </div>

                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>

    <template v-else-if="num === 6">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-6" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_06.jpg">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                </div>
                                <div>
                                    <span class="plus-top-box-v2-title">PLUS 월정기 멤버십 <img v-if="is_first_payment === true" class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span>9,900원</span>
                                </div>
                            </div>
                            <div class="plus-top-box-v2">
                                <div>
                                    <p><span>※ 구독 해지는 간편</span>하게 가능하니까 부담 없이 시작하세요~</p>
                                </div>
                            </div>

                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>

                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>

    <template v-else-if="num === 7">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-7" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_07.jpg">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                </div>
                                <div>
                                    <span class="plus-top-box-v2-title">PLUS 월정기 멤버십 <img v-if="is_first_payment === true" class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span>9,900원</span>
                                </div>
                            </div>
                            <div class="plus-top-box-v2">
                                <div>
                                    <p><span>※ 구독 해지는 간편</span>하게 가능하니까 부담 없이 시작하세요~</p>
                                </div>
                            </div>

                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>

    <template v-else-if="num === 8">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-8" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_08.jpg">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span class="plus-top-box-v2-title">PLUS 월정기 멤버십 <img v-if="is_first_payment === true" class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span>9,900원</span>
                                </div>
                                <div>
                                    <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                </div>
                            </div>
                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>

    <template v-else-if="num === 9">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background model-9" data-backdrop="">
            <div class="plus_payment_all_wrapper" style="position:relative;">
                <div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
                    <div class="plus-modal-close-v2">
                        <img @click="back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
                    </div>
                    <div class="plus-modal-top-v2">
                        <img class="" src="//images.novelpia.com/img/new/plus/plus_payment_modal_top_09.jpg">
                    </div>
                    <template v-if="app_store === 'IOS'">
                        <div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
                    </template>
                    <template v-else>
                        <template v-if="is_secret_mode == 1">
                            <div class="plus-modal-top-v2" style="text-align:center;">
                                <p>시크릿 모드에서는 구독 할 수 없습니다.</p>
                            </div>
                        </template>
                        <template v-else>
                            <div class="plus-top-box-v2">
                                <div>
                                    <span class="plus-top-box-v2-title">PLUS 월정기 멤버십 <img v-if="is_first_payment === true" class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
                                    <span>9,900원</span>
                                </div>
                                <div>
                                    <span><i class="ion ion-checkmark"></i> 무제한 플러스 작품 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 무제한 웹소설, 웹만화 이용</span>
                                    <span><i class="ion ion-checkmark"></i> 마음에 드는 회차 소장 가능</span>
                                </div>
                            </div>
                            <div class="plus-top-box-v2">
                                <div>
                                    <p>
                                        <img class="" src="//images.novelpia.com/img/new/plus/plus_novel.png">
                                    </p>
                                </div>
                                <div>
                                    <p><span>구독 해지는 언제 어디서든 간편</span>하게 가능하니까! 부담 없이 시작하세요~</p>
                                </div>
                            </div>

                            <p class="plus-pay-v2-title">구독 수단 선택하기</p>
                            <div class="plus-pay-v2">
                                <div class="settle_mobile_pay">
                                    <img class="" src="/img/new/plus/plus_pay_phone.png">
                                    <span>휴대폰</span>
                                </div>
                                <div class="settle_card_pay">
                                    <img class="" src="/img/new/plus/plus_pay_card.png">
                                    <span>신용카드</span>
                                </div>
                                <div @click="pay('naverpay')">
                                    <img class="" src="/img/new/plus/plus_pay_naver.png">
                                    <span>네이버페이</span>
                                </div>
                                <div @click="pay('kakaopay')">
                                    <img src="/img/new/plus/plus_pay_kakao.png">
                                    <span>카카오페이</span>
                                </div>
                                <div @click="pay('toss')">
                                    <img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
                                    <span>토스페이</span>
                                </div>
                            </div>
                            <div class="plus-pay-folding-v2">
                                <div class="plus-pay-folding-title-v2">
                                    <input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree">
                                    <label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
                                    <i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
                                </div>
                                <div class="plus-pay-folding-info-v2">
                                    <p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
                                    <p>∙ 구독은 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.</p>
                                    <p>∙ 휴대전화, ARS를 이용하여 구독한 건의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
                                    <p>∙ 구독이 완료되기 전에 해당 창을 닫으면 구독이 완료되지 않을 수 있습니다.</p>
                                    <p>∙ 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
                                </div>
                            </div>
                        </template>
                    </template>
                </div>
            </div>
        </div>
    </template>
	<template v-if="num === 10">
        <div id="plus_payment_modal" :class="{'viewer': is_viewer === true}" class="basic-modal-background" data-backdrop="">
			<template v-if="is_100">
				<div class="plus_payment_all_wrapper">
					<div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 ">
						<div class="plus-modal-close-v2">
							<img @click="event_back" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
						</div>
						<div class="plus-modal-top-v2" style="margin-top: 0px; margin-bottom:10px;">
														<img class="" v-if="is_secret_mode != 1" src="//images.novelpia.com/img/new/event/sub_sale/ver2/new/payment_first_bnr_03.png">
						</div>
						<template v-if="app_store === 'IOS'">
							<div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
						</template>
						<template v-else>
							<template v-if="is_secret_mode == 1">
								<div class="plus-modal-top-v2" style="text-align:center;">
									<p>시크릿 모드에서는 구독 할 수 없습니다.</p>
								</div>
							</template>
							<template v-else>
								<div class="plus-top-box-v2">
									<div>
										<span>상품정보</span>
										<span v-if="is_first_payment === true">PLUS 월정기 멤버십 + <img class="" src="//images.novelpia.com/img/new/icon/bronze.png"></span>
										<span v-else>PLUS 월정기 멤버십</span>
									</div>
									<div>
										<span>총 상품금액</span>
										<span>0원</span>
									</div>
								</div>
								<div class="plus-pay-folding-v2">
									<div class="plus-pay-folding-title-v2">
										<input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree" @click="sub_modal_check('plus_payment_agree')">
										<label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
										<i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
									</div>
									<div class="plus-pay-folding-info-v2">
										<p>∙ 첫 구독 프로모션 상품은 구독 수단 등록 후 이용 가능하며, 다음 구독 갱신일부터 9,900원이 결제됩니다. </p>
										<p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
										<p>∙ 해당 상품은 대상자에 한해 본인명의 기준으로 최초 1회 이용이 가능한 상품입니다.</p>
										<p>∙ 해당 상품은 모든 디바이스에서 자유롭게 사용 가능합니다.</p>
										<p>∙ 해당 상품은 다음 구독 갱신일까지 이용가능한 상품이며, 매월 동일 일자에 갱신됩니다.</p>
										<p>∙ 구독이 완료되기 전에 구독 화면을 닫을 경우, 구독이 완료되지 않을 수 있습니다.</p>
										<p>∙ 각 프로모션 및 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
									</div>
								</div>
								<p class="plus-pay-v2-title">구독 수단 선택하기</p>
								<div class="plus-pay-v2">
									<div class="settle_card_pay">
										<img class="" src="/img/new/plus/plus_pay_card.png">
										<span>신용카드</span>
									</div>
									<div @click="pay('naverpay')">
										<img class="" src="/img/new/plus/plus_pay_naver.png">
										<span>네이버페이</span>
									</div>
									<div @click="pay('kakaopay')">
										<img src="/img/new/plus/plus_pay_kakao.png">
										<span>카카오페이</span>
									</div>
																	</div>
							</template>
						</template>
					</div>
				</div>
			</template>

			<template v-else>
				<div class="plus_payment_all_wrapper">
					<div class="plus-modal-wrapper-v2 basic-pay-wrapper-v2 exit-100event">
						<div class="plus-modal-close-v2">
							<img @click="event_back2" class="plus-modal-close-v2-img" src="/img/new/plus/ico_plus_02.png" alt="닫기버튼">
						</div>
						<div class="plus-modal-top-v2 exit-100-txt" style="margin-top: 0px; margin-bottom:10px;">
							<p class="txt-100-line1">구독 상품이 부담스럽다면</p>
							<p class="txt-100-line2"><span>한달만</span> 이용해보세요!</p>
						</div>
						<template v-if="app_store === 'IOS'">
							<div style="margin:40px; text-align:center;color:#666;">현재 IOS 앱에서는 결제 서비스를 지원하고 있지 않습니다.</div>
						</template>
						<template v-else>
							<template v-if="is_secret_mode == 1">
								<div class="plus-modal-top-v2" style="text-align:center;">
									<p>시크릿 모드에서는 구독 할 수 없습니다.</p>
								</div>
							</template>
							<template v-else>
								<div class="plus-top-box-v2">
									<div>
										<span>상품정보</span>
										<span v-if="is_first_payment === true">1개월 플러스 이용권</span>
										<span v-else>PLUS 멤버십 구독권</span>
									</div>
									<div>
										<span>총 상품금액</span>
										<span>16,900원</span>
									</div>
								</div>
								<div class="plus-pay-folding-v2">
									<div class="plus-pay-folding-title-v2">
										<input type="checkbox" v-model="is_plus_payment_agree" id="plus_payment_agree" @click="sub_modal_check('plus_payment_agree')">
										<label for="plus_payment_agree"><p></p><span>구독 안내사항</span><span>에 동의합니다.</span></label>
										<i class="icon ion-ios-help-outline" @click="toggle_plus_policy"></i>
									</div>
									<div class="plus-pay-folding-info-v2">
										<p>∙ 해당 상품은 출판물로 면세항목을 적용 받습니다.</p>
										<p>∙ 해당 상품은 대상자에 한해 본인명의 기준으로 최초 1회 이용이 가능한 상품입니다.</p>
										<p>∙ 해당 상품은 모든 디바이스에서 자유롭게 사용 가능합니다.</p>
										<p>∙ 해당 상품은 다음 구독 갱신일까지 이용가능한 상품이며, 매월 동일 일자에 갱신됩니다.</p>
										<p>∙ 휴대전화를 이용하여 구독한 상품의 취소를 원하실 경우, 당월 구독건에 한해서 가능합니다.</p>
										<p>∙ 콘텐츠 제공을 개시하는 등의 사유가 있을 경우 환불에 제한이 있을 수 있습니다.</p>
										<p>∙ 구독이 완료되기 전에 구독 화면을 닫을 경우, 구독이 완료되지 않을 수 있습니다.</p>
										<p>∙ 각 프로모션 및 할인 혜택은 사전 예고 없이 종료될 수 있습니다.</p>
									</div>
								</div>
								<p class="plus-pay-v2-title">구독 수단 선택하기</p>
								<div class="plus-pay-v2">
									<div class="settle_mobile_pay">
										<img class="" src="/img/new/plus/plus_pay_phone.png">
										<span>휴대폰</span>
									</div>
									<div class="settle_card_pay">
										<img class="" src="/img/new/plus/plus_pay_card.png">
										<span>신용카드</span>
									</div>
									<div @click="pay('naverpay')">
										<img class="" src="/img/new/plus/plus_pay_naver.png">
										<span>네이버페이</span>
									</div>
									<div @click="pay('kakaopay')">
										<img src="/img/new/plus/plus_pay_kakao.png">
										<span>카카오페이</span>
									</div>
									<div @click="pay('toss')">
										<img src="//image.novelpia.com/img/new/plus/logo_tosspay.png">
										<span>토스</span>
									</div>
								</div>
								<div class="exit-100-button">
									<button class="btn-100-go" @click="form_data_init(7)">아니에요. 0원에 구독할게요.</button>
									<button class="btn-no-back" @click="event_back2()">조금 더 둘러볼게요.</button>
								</div>
							</template>
						</template>
					</div>
				</div>
			</template>
        </div>
    </template>
</div><link rel='stylesheet' href='/css/free_ticket_modal.css?v=1728295643' ><script>
    const free_ticket = {
        mem_no: 0,
        csrf: '',
        viewer_page: true,
        content_no: 0,
        flag_type: 0,
        episode_no: 0,
        start_range_start: 0,
        async receive_free_ticket(ticket_no) {
            const param = {
                cmd: 'free_ticket_receive',
                csrf: this.csrf,
                ticket_no: ticket_no
            }

            const result = await http('post', '/proc/free_ticket', param);
            const {status, errmsg, code} = result;

            if(status !== 200) {
                alert(errmsg);
                if(code == 1000) { // 로그인
                    this.login();
                } else if(code == 1006) { // 본인인증
                    this.age_auth();
                } else {
                    location.reload();
                }
                return false;
            }

            alert('발급되었습니다.');
            location.reload();
        },
        async use_free_ticket() {
            const param = {
                cmd: 'use_free_ticket',
                csrf: this.csrf,
                content_no: this.content_no,
                flag_type: this.flag_type,
                episode_no: this.episode_no,
                episode_range_start: this.episode_range_start,
            };

            const result = await http('post', '/proc/free_ticket', param);
            const {status, errmsg, code} = result;

            if(status !== 200) {
                alert(errmsg);
                if(code == 1000) { // 로그인
                    this.login();
                } else if(code == 1006) { // 본인인증
                    this.age_auth();
                } else {
                    //location.reload();
                }

                return false;
            }

            location.href = `/viewer/${this.episode_no}`;
        },
        back() {
                            history.back(-1);
                        this.close_modal();
        },
        plus() {
            member_plus_modal_on();
        },
        join() {
            member_join_modal_on();
        },
        login() {
            member_login_modal_on();
        },
        age_auth() {
            location.href = '/page/age_auth';
            $.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
        },
        open_modal(content_no, flag_type, episode_no, episode_cnt, start_range_start) {
            this.content_no = content_no;
            this.flag_type = flag_type;
            this.episode_no = episode_no;
            this.start_range_start = start_range_start;

            $('#free_ticket_modal #episode_cnt').text(episode_cnt);
            $('#free_ticket_modal').modal('show');
        },
        close_modal() {
            $('#free_ticket_modal').modal('hide');
        },
    }

    const member_plus_modal_on = () => {
                    $('#plus_payment_modal').modal('show');
            }
</script>
<div class="free-ticket-modal-background s_inv" id="free_ticket_modal" data-backdrop="static">
    <div class="free-ticket-modal-wrapper">
        <div class="free-ticket-modal-top">
            <div class="free-ticket-modal-name"></div>
            <div class="free-ticket-modal-close" data-dismiss="modal" onclick="free_ticket.back();"></div>
        </div>
        <div class="free-ticket-modal-contents">
            <div class="free-ticket-img-box">
                <img class="s_inv" src="//images.novelpia.com/img/new/icon/free_ticket_ico.svg" width="28">
            </div>
            <div class="free-ticket-sub-title">
                보유열람권 <span class="free-ticket-cnt">장</span>
            </div>
            <div class="free-ticket-title">
                <div> <span id="episode_cnt"></span>화</div>
            </div>
            <div class="mt-4">
                <button type="button" class="btn btn-free-ticket-use" data-dismiss="modal" onclick="free_ticket.use_free_ticket();">열람권 사용하고 보기</button>
                <button type="button" class="s_inv btn btn-free-ticket-plus" data-dismiss="modal" onclick="free_ticket.plus()">PLUS 멤버십 구독하고 모든 회차 보기</button>
            </div>
        </div>
    </div>
</div>
<script src="/lib/pickr/pickr.min.js"></script>
<script src="/lib/pickr/pickr.es5.min.js"></script>
<script src="/js/cryptojs-aes.min.js"></script>
<script src="/js/cryptojs-aes-format.js"></script>

<script>
    var animation_100 = 100;
    var animation_500 = 500;
    var animation_1000 = 1000;

    if(localStorage['viewer_animation'] != 'on') {
        animation_100 = 0;
        animation_500 = 0;
        animation_1000 = 0;
    }

    if(localStorage['viewer_topbar'] == 'show') {
        try { window.novelpia.topbar_on(); } catch (e) {  }
    } else {
        try { window.novelpia.topbar_off(); } catch (e) {  }
    }

    if(localStorage['viewer_volume'] == 'on') {
        try { window.novelpia.volume_on(); } catch (e) {  }
    } else {
        try { window.novelpia.volume_off(); } catch (e) {  }
    }

    var stateObj = { d: "1" };
    //location.replace("/novel/310060");
    //history.pushState(stateObj, "", "/novel/310060");

    var option_btn_theme = 0;

    function btn_theme2() {
        if(option_btn_theme == 0){
            $('#scroll_up_btn').hide();
            $('#scroll_down_btn').hide();
            option_btn_list = 0;
            option_btn_comment = 0;
            option_btn_theme = 1;
            $('#btn_theme').attr('src', '//images.novelpia.com/img/new/viewer/navbar/v2/setting_on.svg');
            $('#btn_comment').attr('src', '//images.novelpia.com/img/new/viewer/navbar/v2/comment.svg');
            $('#btn_comment + span').removeClass("comment-on");
            $('#btn_list').attr('src', '//images.novelpia.com/img/new/viewer/navbar/v2/list.svg');
            $('#btn_comment_text').css("color", "#000");
            $('#novel_box').show();
            $('#list_box').hide();
            $('#comment_box').hide();
            $('#theme_box').show();
            $('#float-menu').hide();
        } else {
            option_btn_theme = 0;
            $('#btn_theme').attr('src', '//images.novelpia.com/img/new/viewer/navbar/v2/setting.svg');
            $('#btn_comment_text').css("color", "#000");
            $('#novel_box').show();
            $('#list_box').hide();
            $('#comment_box').hide();
            $('#theme_box').hide();
            $('#float-menu').show();
        }
    }

    function btn_comment2() {
        if(location.hash == '#comments') {
            history.go(-1);
            $('#float-menu').show();
        } else if(location.hash == '#' || location.hash == '') {
            location.hash = 'comments';
            $('#float-menu').hide();
        } else {
            location.replace('#comments');
            $('#float-menu').hide();
        }
    }

    function btn_list2() {
        if(location.hash == '#lists') {
            history.go(-1);
            if($(".curation-wrapper").hasClass("list-curation")){
                $(".curation-wrapper").show();
                $(".curation-wrapper").removeClass("list-curation");
            }
            $('#float-menu').show();
        } else if(location.hash == '#' || location.hash == '') {
            location.hash = 'lists';
            if($(".curation-wrapper").is(":visible") == true){
                $(".curation-wrapper").addClass("list-curation");
                $(".curation-wrapper").hide();
            }
            $('#float-menu').hide();
        } else {
            location.replace('#lists');
            if($(".curation-wrapper").is(":visible") == true){
                $(".curation-wrapper").addClass("list-curation");
                $(".curation-wrapper").hide();
            }
            $('#float-menu').hide();
        }
    }

    $(document).ready(function(){
        document.ondragstart = function(){
            return false;
        }
        document.onselectstart = function(){
            return false;
        }
        $("body").contextmenu(function(){
            return false;
        });
        // 설정창 resize;
        if($(window).height() < 562){ $("#option_panel_1").height(380 - (562 - $(window).height())); }else{ $("#option_panel_1").height(380); }
        if($(window).height() < 562){ $("#option_panel_2").height(380 - (562 - $(window).height())); }else{ $("#option_panel_2").height(380); }

        viewer_screen_height = $(document).height();

        get_viewer_like();
        get_viewer_vote();
    });
    if($.cookie('DARKMODE') == 1) {
        $('.loads').css("filter", "");
    } else {
        $('.loads').css("filter", "invert(1)");
    }

</script>
<style>

    /* img{
        width: 100%;
    } */


    .rangeslider__fill {
        max-width: 100%;
    }

    @media print {
        .np{
            display:none;
        }
    }

    .hidden_ep2 { display:none; }
    .ep_num_bg { background-color: #f5f5f5;padding: 4px 8px;font-size: 9px;border-radius: 7px; }
    .ep_style1 { height:30px;width:30px;border-radius:15px;background-color:#f4f4f4;position:relative;margin: 10px; }
    .ep_style2 { background-color:#fff;padding: 2px 0px;border-radius: 10px;opacity:0.5; }
    .ep_style3 { text-align:center;width:75px;font-size:12px; }
    .ep_style4 { height:80px;border-bottom:1px solid rgba(0,0,0,0.3);background-color: #feffe5;cursor:pointer; }
    .ep_style5 { height:80px;border-bottom:1px solid rgba(0,0,0,0.3);cursor:pointer;border-top:1px solid #EFEFEF; }
    .ep_style_on { height:20px;width:20px;border-radius:10px;background-color:#8463f5;top:5px;left:5px;position:absolute; }
    .ep_style_off { height:20px;width:20px;border-radius:10px;background-color:#e9e9e9;top:5px;left:5px;position:absolute; }

    #i-am-progress-indicator {
        position:fixed;
        top:0;
        left:0;
        height:5px;
        background:#ccc;
        width:0%;
    }
    .no-drag {-ms-user-select: none; -moz-user-select: -moz-none; -webkit-user-select: none; -khtml-user-select: none; user-select:none;}
    .line {
        -webkit-touch-callout: none!important;
        -moz-user-select: none!important;
        -webkit-user-select: none!important;
        -ms-user-select: none!important;
        -o-user-select: none!important;
        user-select: none!important;
        -khtml-user-select: none!important;
    }
    .cover-wrapper{
        height: 100%;
        text-align:center;
        position: relative;
    }
    .cover-img{
        max-width:100%;
    }
    .cover-no{
        display:none;
    }
    .cover-text{
        font-size: 14px;
        color: #999;
        border: 1px solid #ccc;
        width: fit-content;
        padding: 0px 10px;
        border-radius: 7px;
        margin: 10px auto;
        cursor: pointer;
        position: relative;
        z-index: 1;
    }

    .illust-wrapper{
        position: relative;
        display: block;
    }

    .illust-wrapper span{
        cursor: pointer;
        position: absolute;
        top: 50%;
        left: 0;
        transform: translate(0%, -50%);
        text-align: center;
        width: 60%;
        background-color: #999;
        opacity:0.5;
        margin: 0 20% 0 20%;
    }

    .no-illust{
        display: block !important;
        opacity:0;
        max-width:100%;
    }

    .show-illustration{
        opacity: 1 !important;
    }

    .illust-text{
        filter: invert(1);
    }
</style>
    <style>
        .dark_scroll::-webkit-scrollbar{
            background-color:#0e0e0e;
        }

        .dark_scroll::-webkit-scrollbar-track{
            background-color:#0e0e0e;
        }

        .dark_scroll::-webkit-scrollbar-thumb{
            background-color:#3e3e3e;
            border: 2px solid #0e0e0e;
        }
    </style>
<div style="position:absolute;width:100%;left:0px;right:0px;bottom:0px;top:0px;height:100%;user-select:none;" class="no-drag" id="viewer_no_drag" oncontextmenu="return false" onselectstart="return false" ondragstart="return false" ondrop="return false">

    <div id="components">
        <component :is="recommendToast" v-if="toastShow" :type="toastType"></component>
    </div>

    <script>
        playAlert = setInterval(function() {
            if($('#viewer_no_drag').css('user-select') != 'none') {
                location = "/page/plugin";
            }
        }, 1000);
    </script>
    <!-- 본문영역 -->
    <input type="hidden" id="is_indent" value="0">
    <div style="position:relative;height:100%;;top:0px;margin:0px auto;overflow-y:scroll;padding:0px 20px;will-change: transform;letter-spacing:0px;" id="novel_box" class="novel_box no-drag"
         oncontextmenu="return false" onselectstart="return false" ondragstart="return false" ondrop="return false"
    >
        <div style="max-width:900px;margin:0px auto;opacity:0;word-break: break-word;" id="novel_text"  class="no-drag"
             oncontextmenu="return false" onselectstart="return false" ondragstart="return false" ondrop="return false"
        >
                        <div style="text-align:center;" id="load_bar"><br><br><br><div style="background-color:#eeeeee66;">소설 내용을 불러오고 있습니다.</div></div>
            <ol onclick="navi_view();" style="padding:0px;margin:0px;" id="novel_drawing" class="no-drag np" oncontextmenu="return false" onselectstart="return false" ondragstart="return false" ondrop="return false"></ol>
            <ol onclick="navi_view();" style="padding:0px;margin:0px;overflow-x:hidden;max-width:900px;height:100%;margin:0px 0px;scrollbar-width: none;overflow-y: hidden;" id="novel_drawing_page_c" class="no-drag np" oncontextmenu="return false" onselectstart="return false" ondragstart="return false" ondrop="return false"><span id= "novel_drawing_page_info" style="padding:0px;margin:0px;"></span>
                <ol id="novel_drawing_page" class="no-drag np" style="padding:0px;margin:0px;" oncontextmenu="return false" onselectstart="return false" ondragstart="return false" ondrop="return false"></ol>
                <div style="position:fixed;width:100%;left:0px;right:0px;bottom:0px;height:40px; user-select:none;line-height:21px;font-size:14px" align="center">
                    <span style="background-color:rgba(155,155,155,0.1);border-radius:10px;padding:4px 12px;" id="page_cnt">1/1</span>
                </div>
            </ol>
            <div id="novel_drawing_left" style="position:absolute;background-color:rgba(0,0,0,0);width:25%;height:calc(100%);left:0px;top:0px;font-size:128px;;text-align:left;" onclick="page_back();"><div style="position: absolute; left: 50px;    top: calc(50% - 71px);"><i class="icon ion-chevron-left mobile_hidden3" style="opacity: 0.1;"></i></div></div>
            <div id="novel_drawing_right" style="position:absolute;background-color:rgba(0,0,0,0);width:25%;height:calc(100%);right:0px;top:0px;font-size:128px;text-align:right;" onclick="page_next();"><div style="position: absolute; right: 50px; top:calc(50% - 71px);"><i class="icon ion-chevron-right mobile_hidden3" style="opacity: 0.1;"></i></div></div>
                    <style>
            /* Slider main container */
            .bottom_banner_wrapper {
                margin: 30px auto 0 auto;
                max-width: 900px;
                overflow: hidden;
            }

           .swiper-slide {
               text-align: center;
               max-width: 900px;
               margin-right: 10px;
           }

            .swiper-slide > img {
                height: auto;
                width:100%;
                /*margin:30px 0 0 0;*/
            }
        </style>
        
            <script>
                    setTimeout(function() {
        new Swiper('.bottom_banner_wrapper', {
            loop: ,
            slidesPerView: 1,
            spaceBetween: 20,
        });
    },1000);
                    </script>
    <script>
        //다음화 링크 체크
        function check_next_episode_link(content_no){
                        const check_next_epi = Number('0');
            console.log(check_next_epi);
            if(check_next_epi === 0){//볼수 있음
                go_next_episode(content_no);
                return;
            }
            if(check_next_epi === 3){//비회원
                member_join_modal_on();
                return;
            }

            go_next_episode(content_no);
            return;
        }

        function go_next_episode(next_content_no){
            pageload('/viewer/' + next_content_no + '/', 1);
        }
    </script>

    </div>
</div>

<!--회원가입모달-->

<input type="hidden" id="novel_no" value="310060">
<input type="hidden" id="content_no" value="3929317">
<input type="hidden" id="back_epi_auto_url" value="">
<input type="hidden" id="next_epi_auto_url" value="/viewer/3930273">
<input type="hidden" id="content_no_next" value="3930273">
<input type="hidden" id="csrf" value="">

<textarea id="footer_plus" style="display:none;"><div style='background-color: rgba(155,155,155,0.1); border: 1px solid  rgba(155,155,155,0.2); border-radius: 10px; padding: 10px 20px;margin-top:10px;word-break: break-word; display:none;' id='writer_comments_box'><i class='icon ion-chatbubble-working'></i> 작가의 한마디 (작가후기)<br>잘 부탁드립니다 님!&lt;br /&gt;
&lt;br /&gt;
오타와 오류 지적은 환영입니다.&lt;br /&gt;
&lt;br /&gt;
글 피드백이나 아쉬운 점, 개선하면 좋을 듯한 점이 있으시다면 댓글로 남겨주시면 감사할 것 같습니다.</div><!-- Slider main container -->
<div class="bottom_banner_wrapper">
    <!-- Additional required wrapper -->
    <div class="swiper-wrapper">
        <!-- Slides -->
        <div class="swiper-slide" style="background: #eaccff" onclick="location.href='/event/plus_free'">
             <img src="//images.novelpia.com/upload/banner/202411/d53965d2fb0d4473ce82d6f77f86811b1730769972326545435">
        </div>
    </div>
</div><div id='next_epi_btn_bottom' style='background-color: rgba(155,155,155,0.1); border: 1px solid  rgba(155,155,155,0.2); border-radius: 10px; padding: 10px 20px;margin-top:10px;text-align:center;margin:30px 0px 100px 0;cursor:pointer;display:none;' onclick="check_next_episode_link(3930273);">다음화 보기</div><br></textarea>
<style>
    .curation-wrapper{
        display:none;
    }
    .curation{
        width: 100%;
        position: relative;
    }
    .curation-box-wrapper{
        background-color: rgba(155,155,155,0.1);
    }
    .curation img{
        width: 100%;
    }
    #curation-title, #curation-box{
        max-width: 900px;margin: 0 auto;
    }
    .curation h4{
        font-size: 14px;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        margin: 7px 0 3px 0;
        color: #000;
    }
    .curation p{
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        color:#666;
        font-size: 14px;
    }
    #curation-title{
        font-size: 20px;
        margin-bottom: 13px;
        padding-left:20px;
    }
    #curation-box{
        display: flex;
        padding: 25px 20px 18px 20px;
        justify-content: space-between;
        overflow: hidden;
    }
    #curation-box a{
        width: 100px;
    }
    .is-last-btn{
        margin-bottom:350px !important;
    }
    .novel_15, .novel_19{
        position: absolute;
        right: 5px;
        top: 5px;
        font-size: 10px;
        color: #FFF;
        background-color: #527FE7;
        padding: 5px;
        line-height: 12px;
        border-radius: 50%;
        z-index: 1;
    }
    .novel_19{
        background-color: #EA6863;
    }
    .curation-btn{
        display:none;
    }
    @media (min-width:0px) and (max-width:891px) {
        #curation-box{
            gap: 30px;
            padding: 3px 18px 10px 18px;

            overflow-x: auto;
            overflow-y: hidden;
        }
        #curation-title {
            font-size: 16px;
            margin-bottom: 8px;
            padding: 5px 20px 10px 20px;
        }
        .curation-wrapper{
            background-color: rgba(155,155,155,0.1);
            padding-top: 15px;
        }
        .curation {
            width: 80px;
            margin: 0 auto;
        }
        .is-last-btn{
            margin-bottom:300px !important;
        }
        .curation-box-wrapper{
            background-color: transparent;
        }
        .curation-title-wrapper{
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .curation-btn{
            display: flex;
            margin-right: 20px;
        }
        .curation-btn div{
            width: 26px;
            height: 26px;
            background-color: rgba(255,255,255,0.3);
            text-align: center;
            font-size: 15px;
            border: 1px solid #DDD;
            position: relative;
            bottom: 5px;
        }
        #curation-title{
            margin:0;
        }
    }
</style>
<!-- 리스트 -->
<div style="position:static;width:100%;right:0px;left:0px;bottom:60px;height:calc(100% - 60px);display:none;overflow-y:scroll;-webkit-overflow-scrolling:touch;will-change: transform;" id="list_box">
    <table style="width:100%;max-width:900px;margin:63px auto 0 auto;">

        <tr>
            <td valign="top" style="width:800px;border-bottom:2px solid #000;height: 60px;padding:0px 20px;">
                <div class="mobile_hidden">
                    <img src="//images.novelpia.com/img/new/list/list_title.png" style="margin:25px 0px;" class="episode_title">
                    <div style="height:70px;line-height:70px;float:right;"><span onclick="episode_sort('down');"><img src="//images.novelpia.com/img/new/list/old.png" class="sort_down"></span>&nbsp;&nbsp;&nbsp;<span onclick="episode_sort('up');"><img src="//images.novelpia.com/img/new/list/new.png" class="sort_up"></span></div>
                </div>
                <div class="mobile_show">
                    <img src="//images.novelpia.com/img/new/list/list_title.png" style="margin:20px 0px;height:15px;" class="episode_title">
                    <div style="height:50px;line-height:50px;float:right;"><span onclick="episode_sort('down');"><img src="//images.novelpia.com/img/new/list/old.png" style="height:13px;"  class="sort_down"></span>&nbsp;&nbsp;&nbsp;<span onclick="episode_sort('up');"><img src="//images.novelpia.com/img/new/list/new.png" style="height:13px;" class="sort_up"></span></div>
                </div>
            </td>
            <script>
                if(localStorage['novel_sort_' + $('#novel_no').val()] == 'UP') {
                    $('.sort_up').attr('src', '/img/new/list/new_on.png');
                    $('.sort_down').attr('src', '/img/new/list/old.png');
                } else {
                    $('.sort_up').attr('src', '/img/new/list/new.png');
                    $('.sort_down').attr('src', '/img/new/list/old_on.png');
                }
            </script>
        </tr>
    </table>
    <table style="width:100%;max-width:900px;margin:0px auto;">

        <tr>
            </table>
    <div id="episode_list_viewer" style="width:100%;max-width:900px;margin:0px auto;"></div>

    <script>

        function episode_buy(idx) {

            $.ajax({
                data: { "episode_no": idx, "csrf": "", "option": "viewer" },
                type: "POST",
                url: "/proc/episode_buy",
                cache: false,
                success: function(data) {
                    $('#load_alert').html(data);
                }
            });

        }

    </script>
</div>
<!-- 3일 무료 -->
<!-- 댓글 -->
<link rel='stylesheet' href='/css/openstore_modal.css?v=1728295643' ><link rel='stylesheet' href='/css/novel_donation_modal.css?v=1728295643' ><script src='https://npg.settlebank.co.kr/resources/js/v1/SettlePG.js' type='text/javascript' ></script>
<!--로얄티콘 구매 팝업-->
<div class="detail-modal-background s_inv" id="modal_opensotre_stamp">
    <div class="common-layer-wrapper layer-emoticon-padding">
        <div class="close-x" data-dismiss="modal"></div>
        <template v-if="modal_status === 'purchase_ready'">
            <div class="common-layer-title">로얄티콘 구매하기</div>
            <div v-if="is_member_grade_discount === true" class="img-notice s_inv">
                <p>※ 회원님은 현재 <span style="color:#7632FF; font-weight: 600;">{{ get_member_grade_text }} 등급</span>으로 <span style="color:#7632FF; font-weight: 600;">{{ member_discount_rate }}% 할인</span>이 적용됩니다.</p>
            </div>
            <div class="stamp-plus-txt"></div>
            <div class="stamp-img"><img class="s_inv" :src="`${G_CDN_DOMAIN_IMG}${item.stamp_url}`"></div>
            <div class="stamp-buy-info">
                <div class="stamp-txt">
                    <div class="stamp-item-name">{{ item.stamp_name }}</div>
                    <!--<div class="stamp-item-writer"></div>-->
                </div>
                <div class="stamp-price">
                    <template v-if="is_member_grade_discount === true">
                        <!--금뱃지이상-->
                        <img class="s_inv" src="//images.novelpia.com/img/new/plus/stamp/coin_gold.png"><span class="discount">{{ item.coin }}코인</span>{{ item.discount_coin }}코인
                    </template>
                    <template v-else>
                        <!--금뱃지미만 -->
                        <img class="s_inv" src="//images.novelpia.com/img/new/plus/stamp/coin_gold.png">{{ item.coin }}코인
                    </template>
                </div>
            </div>
            <div class="layer-botton-section">
                <button v-if="item.novel_no > 0" class="color-pp" @click="move_novel(item.novel_no)">작품보기</button>
                <button v-if="item.is_purchase === false && item.state === 2" class="color-pp" @click="purchase">구매하기</button>
                <button v-else-if="item.is_purchase === false && item.state === 0" class="color-gr">판매종료</button>
                <button v-else class="color-gr">구매완료</button>
            </div>
            <div class="layer-notice" style="margin-bottom:-10px;">
                <div class="notice-scroll">
                    <div class="layer-notice-title">상품안내</div>
                    <ul>
                        <li>- 결제 완료 후 즉시 계정으로 상품이 귀속됩니다.</li>
                        <li>- 구매한 로얄티콘은 PC와 모바일 앱에서 사용할 수 있습니다.</li>
                        <li>- 일부 사용자의 경우 일부 기능 또는 구매가 제한될 수 있습니다.</li>
                        <li>- 로얄티콘의 경우 골드코인으로만 구매하실 수 있습니다.</li>
                        <li>- 로얄티콘 획득 시 메타짱 뱃지를 얻으실 수 있습니다.</li>
                    </ul>
                </div>
            </div>
            <div class="layer-notice">
                <div class="notice-scroll">
                    <div class="layer-notice-title">해지 및 환불 안내</div>
                    <ul>
                        <li>- 결제 후 계약 내용에 관한 서면을 교부 받은 날로부터 7일 이내 청약을 철회할 수 있습니다.</li>
                        <li>- 다음 내용에 해당될 경우 청약철회 또는 환불 신청이 제한될 수 있습니다.
                            <ul>
                                <li>1) 구매일로부터 7일 이내에 디지털 콘텐츠의 제공이 개시된 경우</li>
                                <li>2) 구매일로부터 7일이 경과한 후 단순변심으로 인한 청약철회 또는 환불 신청</li>
                            </ul>
                        </li>
                        <li>결제 후 콘텐츠의 내용이 표시·광고 내용과 다르거나 계약내용과 다르게 이행된 경우에는 당해 콘텐츠를 제공받은 날로부터 3개월 이내, 그 사실을 안 날 또는 알 수 있었던 날로부터 30일 이내에 청약철회등을 할 수 있습니다.</li>
                        <li>청약 철회/환불 요청을 원하실 경우 문의하기를 통해 신청하실 수 있습니다.</li>
                    </ul>
                </div>
            </div>
        </template>

        <template v-if="modal_status === 'plus_ready'">
            <div class="common-layer-title">로얄티콘</div>
            <div class="img-notice s_inv">
                <img src="//images.novelpia.com/img/new/common/icon_bb_plus2.png" class="notice-img-royalticon">
                <p>본 로얄티콘은 <span class="txt-color-pp">PLUS 정기 구독중인 회원</span>들에게 드리는 상품이며, 별도의 구매는 불가합니다.</p>
            </div>
            <div class="stamp-plus-txt"></div>
            <div class="stamp-img">
                <div class="stamp-number"><p class="txt-num">{{ item.stamp_plus_no.format() }}</p><p>회차</p></div>
                <img class="s_inv" :src="`${G_CDN_DOMAIN_IMG}${item.stamp_url}`">
            </div>
            <div class="stamp-buy-info">
                <div class="stamp-txt">
                    <div class="stamp-item-name">{{ item.stamp_name }}</div>
                    <div class="stamp-item-writer">노벨피아</div>
                </div>
                <div class="stamp-price">
                    <img class="s_inv" src="//images.novelpia.com/img/new/icon/icon_plus.svg">구독자 혜택
                </div>
            </div>
            <div class="layer-botton-section">
                <button v-if="is_member_plus === false && item.is_purchase === false" class="color-pp" @click="plus">PLUS 구독하기</button>
                <button v-else-if="is_member_plus === true && item.is_purchase === true" class="color-gr">이미 소장중입니다</button>
                <button v-else-if="is_member_plus === true && item.is_purchase === false" class="color-pp" @click="move_stamp">로얄티콘 수령하러 가기</button>
                <button v-else-if="is_member_plus === false && item.is_purchase === true" class="color-pp" @click="plus">재구독시 사용이 가능합니다.</button>
            </div>
            <div class="layer-notice" style="margin-bottom:-10px;">
                <div class="notice-scroll">
                    <div class="layer-notice-title">상품안내</div>
                    <ul>
                        <li>- 플러스 구독 이후 기간 내에 수동으로 다운받으시는 상품입니다.</li>
                        <li>- 상기 로얄티콘은 PLUS 정기 구독 유지 시 사용가능 합니다.</li>
                        <li>- 수령한 로얄티콘은 PC, 모바일 앱에서 사용이 가능합니다.</li>
                        <li>- 일부 사용자의 경우, 기능이 제한 될 수 있습니다.</li>
                        <li>- 상기 로얄티콘의 경우 구매가 불가능한 상품입니다.</li>
                    </ul>
                </div>
            </div>
        </template>

        <template v-if="modal_status === 'game'">
            <div class="common-layer-title">로얄티콘</div>
            <div class="img-notice s_inv">
                <p>본 로얄티콘은 이벤트로 지급되는 상품이며, 별도의 구매는 불가합니다.</p>
            </div>
            <div class="stamp-plus-txt"></div>
            <div class="stamp-img">
                <img class="s_inv" :src="`${G_CDN_DOMAIN_IMG}${item.stamp_url}`">
            </div>
            <div class="stamp-buy-info">
                <div class="stamp-txt">
                    <div class="stamp-item-name">{{ item.stamp_name }}</div>
                    <div class="stamp-item-writer">노벨피아</div>
                </div>
            </div>
            <div class="layer-botton-section">
                <button v-if="item.is_purchase === false" class="color-gr">구매하실 수 없는 상품입니다.</button>
                <button v-else class="color-gr">이미 소장중입니다</button>
            </div>
            <div class="layer-notice" style="margin-bottom:-10px;">
                <div class="notice-scroll">
                    <div class="layer-notice-title">상품안내</div>
                    <ul>
                        <li>- 지급일로부터 즉시 계정으로 귀속됩니다.</li>
                        <li>- 수령한 로얄티콘은 PC, 모바일 앱에서 사용이 가능합니다.</li>
                        <li>- 일부 사용자의 경우, 기능이 제한 될 수 있습니다.</li>
                        <li>- 상기 로얄티콘의 경우 구매가 불가능한 상품입니다.</li>
                    </ul>
                </div>
            </div>
        </template>

        <template v-else-if="modal_status === 'purchase_complete'">
            <div class="layer-center-img"><img src="//images.novelpia.com/img/new/plus/stamp/layer_img_buying2.png"></div>
            정상적으로 구입이 완료되었습니다!
            <div class="layer-botton-section">
                <button class="color-bk" data-dismiss="modal">닫기</button>
            </div>
        </template>

        <template v-else-if="modal_status === 'coin'">
            <div class="layer-center-img"><img src="//images.novelpia.com/img/new/plus/stamp/layer_img_coin2.png"></div>
            코인이 부족합니다.
            <div class="layer-botton-section">
                <button class="color-pp" @click="store">코인스토어 바로가기</button>
                <button class="color-bk" data-dismiss="modal">닫기</button>
            </div>
        </template>

        <template v-else-if="modal_status === 'login'">
            <div class="layer-center-img"><img src="//images.novelpia.com/img/new/plus/stamp/layer_img_login2.png"></div>
            로그인이 필요합니다.
            <div class="layer-botton-section">
                <button class="color-bk" data-dismiss="modal">닫기</button>
            </div>
        </template>
    </div>
</div>

<div id="coinModalComp" style="display: none" ref="coinModalComp">
        <coin_pay_modal
        :mem_id = mem_id
        :mem_no = mem_no
        :mem_nick = mem_nick
        :mem_email = mem_email
        :mem_name = mem_name
        :pg_mid = pg_mid
        :pg_mid_nomal = pg_mid_nomal
        :payment_server = payment_server
        :app_store = app_store
        @_parent_modal_close = "coinChargeModalClose"
    ></coin_pay_modal>
</div>

<script type="module">
    import coin_pay_modal from "/js/component/coin/coin_pay_modal.js?v=241105164147";

    const coin_modal_obj = new Vue({
        el: "#coinModalComp",
        data :{
            /////////////////// 코인결제모달 관련//////////////////////
            mem_id : "",
            mem_no : Number(0),
            mem_nick : "",
            mem_email : "",
            mem_name : "",
            pg_mid : "novelpia2",
            pg_mid_nomal : "novelpia",
            payment_server : "https://npg.settlebank.co.kr",
            app_store : "WEB",
        },
        components : {
            "coin_pay_modal" : coin_pay_modal,
        },
        methods: {
            coinChargeModalOpen(){
                this.is_coin_charge_modal = true;
            },
            coinChargeModalClose(){
                this.$refs.coinModalComp.style.display = "none";
            },

        }
    });

    window.openstoreStampModal = new Vue({
        el: '#modal_opensotre_stamp',
        data: {
            is_member_plus: false,
            is_member_grade_discount: false,
            member_discount_rate: 0,
            member_grade: '',
            G_CDN_DOMAIN_IMG: G_CDN_DOMAIN_IMG,
            item: {},
            modal_status: null,
            csrf: '',
        },
        components: {
            coin_modal_obj : "coin_modal_obj"
        },
        methods: {
            async get_stamp_data(stamp_no) {
                const param = {
                    mode: 'get_stamp_data',
                    stamp_no: stamp_no,
                }
                const result  = await http('get', '/proc/stamp_proc', param);
                const {status, errmsg, data} = result;

                if(status !== 200) {
                    alert(errmsg);
                    return false;
                }

                this.item = data;

                switch(this.item.state) {
                    case 0:
                    case 2:
                        this.modal_status = 'purchase_ready';
                        if(this.is_member_grade_discount === true) {
                            this.item.discount_coin = (100 - this.member_discount_rate) * this.item.coin / 100;
                        }
                        break;
                    case 5:
                        this.modal_status = 'plus_ready';
                        break;

                    case 8:
                        this.modal_status = 'game';
                        break;

                                    default:
                        alert('로얄티콘 정보가 없습니다.');
                        return false;
                        break;
                }

                return true;
            },
            async get_member_grade_discount() {
                const param = {
                    mode: 'get_member_grade_discount',
                }
                const result  = await http('get', '/proc/stamp_proc', param);
                const {status, errmsg, data} = result;

                if(status !== 200) {
                    //alert(errmsg);
                    return false;
                }

                this.is_member_grade_discount = data['is_member_grade_discount'];
                this.member_discount_rate = data['member_discount_rate'];
                this.member_grade = data['member_grade'];
            },
            async purchase() {
                if(confirm('해당 로얄티콘을 구매 하시겠습니까?') === false) {
                    return false;
                }
                const param = {
                    mode: 'purchase_member_stamp',
                    stamp_no: this.item.idx,
                    csrf: this.csrf,
                }
                const result  = await http('post', '/proc/stamp_proc', param);
                const {status, errmsg, data} = result;

                if(status !== 200) {
                    if(status === 401) {
                        this.modal_status = 'login';
                    } else if(status === 402) {
                        this.modal_status = 'coin';
                    } else {
                        alert(errmsg);
                    }

                    return false;
                }

                this.modal_status = 'purchase_complete';

                if(typeof get_user_stamp === 'function') { // 댓글쪽에서 호출체크
                    get_user_stamp();
                }
            },
            plus() {
                this.close();
                $('#plus_payment_modal').modal('show');
                inc_stat("stat_induce_pay", {
                    flag_type: 46,
                    item_no: 1
                });
            },
            move_stamp() {
                location.href = "/event/royalticon_gift";
            },
            async open(stamp_no) {
                if(await this.get_stamp_data(stamp_no) === true) {
                    $('#modal_opensotre_stamp').modal('show');
                }
            },
            close() {
                $('#modal_opensotre_stamp').modal('hide');
            },
            move_novel(novel_no) {
                location.href = `/novel/${novel_no}`;
            },
            store() {
                $('#modal_opensotre_stamp').modal('hide');
                $("#coinModalComp").show();
                //location.href = '/coin_shop';
            },
            block_right_click(){
                //관리자만 우클릭 허가
                const mem_admin = 0;

                if ( mem_admin >= 10){
                    $("#modal_opensotre_stamp .common-layer-wrapper").on("contextmenu", function() {
                        return true;
                    });
                }
                else {
                    $("#modal_opensotre_stamp .common-layer-wrapper").on("contextmenu", function() {
                        return false;
                    });
                }
            }
        },
        computed: {
            get_member_grade_text() {
                switch(this.member_grade) {
                    case 'dia':
                        return '다이아';
                    case 'platinum':
                        return '플래티넘';
                    case 'gold':
                        return '골드';
                    case 'silver':
                        return '실버';
                    case 'bronze':
                        return '브론즈';
                    default:
                        return '';
                }
            }
        },
        mounted() {
            this.get_member_grade_discount();
            this.block_right_click();
        }
    });
</script>
<div id="modal_member_novel_badge" class="detail-modal-background s_inv">
    <div class="novel-badge-layer">
        <template v-if="status === 1">
            <div class="layer-title">
                <p>작품 뱃지 설정</p>
                <div @click="close" class="close-x"></div>
            </div>
            <div class="user-badge-preview">
                <div class="user-nic-pv"><b style='cursor:pointer;font-weight:500;' onclick="location='/user/';"></b></div>
                <div v-for="item, key in 3" class="user-badge" :class="{empty: R.isNil(select_badge_list[key]) === true}">
                    <img v-if="R.isNil(select_badge_list[key]) === false" :src="`//images.novelpia.com${select_badge_list[key].badge_url}`" :alt="select_badge_list[key].badge_name">
                </div>
            </div>
            <div class="badge-select-box">
                <template v-if="badge_list.length > 0">
                    <div v-for="item, key in badge_list" class="badge-item" v-if="is_novel_badge == item.is_novel_badge && item.is_owned === 1">
                        <input :id="`badge${key}`" type="checkbox" :value="key" @change="set_badge(item)" :checked="item.is_used === 1">
                        <label :for="`badge${key}`">
                            <img :src="`//images.novelpia.com${item.badge_url}`" :alt="item.badge_name">
                        </label>
                    </div>
                </template>
            </div>
            <div class="badge-layer-botton-section">
                <button class="color-wt" @click="reset">전부 선택 취소</button>
                <button class="color-bk" @click="save">작품뱃지 저장</button>
            </div>
        </template>
        <template v-else-if="status === 2">
            <div class="layer-title">
                <div @click="close" class="close-x"></div>
            </div>
            <div>
                <p class="novel-badge-title">해당 댓글에서만 보이는 작품뱃지입니다.</p>
                <p class="novel-badge-sub-title">내 댓글에서 설정이 가능합니다.</p>
            </div>
            <div class="badge-layer-botton-section">
                <button class="color-bk" @click="close">닫기</button>
            </div>
        </template>
        <template v-else>
            <div class="layer-title">
                <div @click="close" class="close-x"></div>
            </div>
            <div>
                <img src="//images.novelpia.com/img/new/plus/modal_img_plus03.png" width="100">
                <p class="novel-badge-title">뱃지로 작가님을 응원해 봐요!</p>
                <p class="novel-badge-sub-title">댓글별로 뱃지 설정이 가능해요.</p>
            </div>
            <div class="badge-layer-botton-section">
                <button class="color-wt" @click="close">닫기</button>
                <button class="color-bk" @click="open(comment_idx, 1)">설정하기</button>
            </div>
        </template>
    </div>
</div>

<script type="module">
    Vue.prototype.R = R;
    window.modal_member_novel_badge = new Vue({
        el: '#modal_member_novel_badge',
        data: {
            mem_no: 0,
            is_member_login: false,
            comment_idx: null,
            is_novel_badge: 0,
            badge_list: [],
            select_badge_list: [],
            status: 1,
            story_member_no: 1210394        },
        methods: {
            set_badge(item) {
                if(event.target.checked === true && this.select_badge_list.length >= 3) {
                    event.target.checked = false;
                    return false;
                }

                if(event.target.checked === true) {
                    this.select_badge_list.push(item);
                } else {
                    this.select_badge_list = this.select_badge_list.filter((v) => v.badge_no !== item.badge_no);
                }
            },
            reset() {
                this.select_badge_list = [];
                $('.badge-select-box :checkbox').prop('checked', false);
            },
            open(comment_idx, status) {
                if(this.is_member_login === false) {
                    this.login();
                    return false;
                }

                this.comment_idx = comment_idx;
                this.status = 0;

                if(status === 1) {
                    this.status = 1;
                    this.get_list();
                } else if(status === 2) {
                    this.status = 2;
                }

                $('#modal_member_novel_badge').modal('show');
            },
            close() {
                $('#modal_member_novel_badge').modal('hide');
            },
            async save() {
                const badge_no_list = this.select_badge_list.map((item) => item.badge_no);
                const param = {
                    mode: 'save_member_comment_badge',
                    comment_idx: this.comment_idx,
                    badge_no_list: badge_no_list,
                };

                const result = await http('post', '/proc/viewer', param);
                if(result.status !== 200) {
                    if(result.status === 401) {
                        alert(result.errmsg);
                        this.login();
                    }
                    return false;
                }
                
                let user_name = '';
                if(this.story_member_no === this.mem_no) {
                    user_name = '<img src="//images.novelpia.com/old/img/new/icon/novel_master.png" style="vertical-align: text-middle;height:18px;" class="c_inv" title="소설작가" onclick="alert(\'현재 보시는 소설의 작가입니다\');">';

                }

                user_name += result.user_name;
                $(`#comment_load .comment[data-idx="${this.comment_idx}"]`).find('.user_name').html(user_name);


                if($.cookie('DARKMODE') == 1) {
                    $('#comment_load .user_name img').css('filter', 'invert(1)');
                }

                alert('저장하였습니다.');
                this.close();
            },
            login() {
                member_login_modal_on();
                return false;
            },
            async get_list() {
                const param = {
                    mode: 'get_member_comment_badge',
                    comment_idx: this.comment_idx,
                };

                const result = await http('post', '/proc/viewer', param);
                if(result.status != 200) {
                    return false;
                }

                this.badge_list = result.result;
                this.select_badge_list = this.badge_list.filter((item) => item.is_used === 1);
            },
        },
    });
</script>
<link rel='stylesheet' href='/css/novel_donation_modal.css?v=1728295643' ><script src='https://npg.settlebank.co.kr/resources/js/v1/SettlePG.js' type='text/javascript' ></script>
<div>
    <!-- pay form-->
    <form id="STPG_payForm">
        <input type="hidden" id="goodsNo"/>
        <input type="hidden" name="mchtId" value="novelpia" >
        <input type="hidden" name="method"  value="" >
        <input type="hidden" name="mchtName" value="노벨피아" >		<!-- 상점한글명 -->
        <input type="hidden" name="mchtEName" value="Novelpia" >		<!-- 상점영문명 -->
        <input type="hidden" name="pmtPrdtNm" value="" >
        <input type="hidden" name="trdAmt" value="">               <!-- 거래금액(암호문) -->
        <input type="hidden" name="plainTrdAmt" value="">
        <input type="hidden" name="mchtParam" value="" />          <!-- 상점예약필드 -->
        <input type="hidden" name="notiUrl" value="https://pay.novelpia.com/settlebank/settle_noti" >         <!-- 결과처리 URL -->
        <input type="hidden" name="nextUrl" value="https://pay.novelpia.com/settlebank/pay_receiveResult" >   <!-- 결과화면 URL -->
        <input type="hidden" name="cancUrl" value="https://pay.novelpia.com/settlebank/pay_receiveResult" >   <!-- 결제취소 URL -->
        <input type="hidden" name="trdDt" value="" >
        <input type="hidden" name="trdTm" value="" >
        <input type="hidden" name="autoPayType" class="autoPayType_class" value="">
        <input type="hidden" name="mchtTrdNo" value="" >

        <!-- 승인 요청 파라미터(옵션) -->
        <input type="hidden" name="plainMchtCustNm" value="" />            <!-- 고객명(평문) -->
        <input type="hidden" name="plainMchtCustId" value="" />

        <!-- 암호화 처리 후 세팅될 파라미터-->
        <input type="hidden" name="mchtCustId" />           <!-- 상점고객아이디(암호문) -->
    </form>

    <!--코인 충전하기-->
    <div class="basic-modal-background" id="user_donation_coin" style="display:none;">
        <div class="user-modal-wrapper">
            <div class="coin-modal-header">
                <div class="modal-back" id="coinBack"><img src="//images.novelpia.com/old/img/new/plus/v2/arrow_goback_2.png" alt="뒤로가기"></div>
                코인 충전하기
            </div>
            <div class="coin-item-list-wrapper">
                                <div class="coin-item-box" data-no="10" data-coin="50">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">50코인</p>
                    <p class="coin-price">5,000원</p>
                </div>
                                <div class="coin-item-box" data-no="11" data-coin="100">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">100코인</p>
                    <p class="coin-price">10,000원</p>
                </div>
                                <div class="coin-item-box" data-no="12" data-coin="200">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">200코인</p>
                    <p class="coin-price">20,000원</p>
                </div>
                                <div class="coin-item-box" data-no="13" data-coin="300">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">300코인</p>
                    <p class="coin-price">30,000원</p>
                </div>
                                <div class="coin-item-box" data-no="14" data-coin="500">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">500코인</p>
                    <p class="coin-price">50,000원</p>
                </div>
                                <div class="coin-item-box" data-no="15" data-coin="1000">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">1,000코인</p>
                    <p class="coin-price">100,000원</p>
                </div>
                                <div class="coin-item-box" data-no="16" data-coin="2000">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">2,000코인</p>
                    <p class="coin-price">200,000원</p>
                </div>
                                <div class="coin-item-box" data-no="17" data-coin="3000">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">3,000코인</p>
                    <p class="coin-price">300,000원</p>
                </div>
                                <div class="coin-item-box" data-no="18" data-coin="5000">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">5,000코인</p>
                    <p class="coin-price">500,000원</p>
                </div>
                                <div class="coin-item-box" data-no="19" data-coin="10000">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img">10,000코인</p>
                    <p class="coin-price">1,000,000원</p>
                </div>
                            </div>
        </div>
    </div>


    <!--결제수단-->
    <div class="basic-modal-background" id="user_donation_pay" style="display:none;">
        <div class="user-modal-wrapper">
            <div class="coin-modal-header">
                <div class="modal-back" id="payBackBtn"><img src="//images.novelpia.com/old/img/new/plus/v2/arrow_goback_2.png" alt="뒤로가기"></div>
                결제수단 선택
            </div>
            <div class="payment-select-coin">
                <div class="coin-item-box select">
                    <p><img src="//images.novelpia.com/old/img/new/plus/v2/icon_paymentcoin_m.png" class="coin-img"><span id="payCoin">50</span>코인</p>
                    <p class="coin-price-pay">5,000원</p>
                </div>
            </div>
            <div class="payment-item-list-wrapper">
                <div class="payment-item-box settle-bank-pay" data-val="card">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_card.png">
                    신용카드
                </div>
                <div class="payment-item-box settle-bank-pay" data-val="mobile">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_mobile.png">
                    휴대폰
                </div>
                <div class="payment-item-box kakao-pay">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_kakaopay.png">
                    카카오페이
                </div>
                <div class="payment-item-box naver-pay">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_naverpay.png">
                    네이버페이
                </div>
                <div class="payment-item-box settle-bank-pay" data-val="culturecash">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_cultureland.png">
                    문화상품권
                </div>
                <div class="payment-item-box settle-bank-pay" data-val="booknlife">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_booknlife.png">
                    도서상품권
                </div>
                <div class="payment-item-box mobile-pop">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_pop.png">
                    모바일팝
                </div>
                <div class="payment-item-box settle-bank-pay" data-val="bank">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_send.png">
                    계좌이체
                </div>
                <div class="payment-item-box settle-bank-pay" data-val="vbank">
                    <img src="//images.novelpia.com/old/img/new/plus/v2/paylogo_input.png">
                    가상계좌 입금
                </div>
                <div class="payment-item-box toss-pay">
                    <img src="//images.novelpia.com/old/img/new/plus/logo-toss-pay.svg" style="max-width:70px;">
                    토스
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function open_coin_pay_modal(fn){
        if("/event/novelgoods_purchase" === "/viewer/3929317") {
            $.cookie('_redirectrurl', 'L2V2ZW50L25vdmVsZ29vZHM=', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
        }else{
            $.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
        }
        if (typeof fn === 'function') {
            fn();
        }
        $("#user_donation_coin").show();
    }

    (function(){
        const event_init = () =>{
            $(document).on("click", ".coin-item-box", fn_obj.pay_modal_select_box);
            $(document).on("click", "#payBackBtn", fn_obj.coin_modal_open);
            //결제관련 이벤트
            $(document).on("click", ".settle-bank-pay", fn_obj.open_settlebank_pay_window);
            $(document).on("click", ".kakao-pay", fn_obj.open_kakao_pay_window);
            $(document).on("click", ".naver-pay", fn_obj.open_naver_pay_window);
            $(document).on("click", ".mobile-pop", fn_obj.open_mobile_pop_window);
            $(document).on("click", ".toss-pay", fn_obj.open_toss_window);
            $(document).on("click", "#coinBack", fn_obj.coin_modal_close);
        }

        const dom_obj = {
            pay_coin : $("#payCoin"),
            coin_price : $(".coin-price"),
            coin_price_pay : $(".coin-price-pay"),
            goods_no : $("#goodsNo"),
        }

        //////// 기능 ///////
        const fn_obj = {
            format_number(value) {
                return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            },
            pay_modal_open(){
                $("#user_donation_coin").hide();
                $("#user_donation_pay").show();
            },
            coin_modal_open(){
                $("#user_donation_coin").show();
                $("#user_donation_pay").hide();
            },
            coin_modal_close(){
                $("#user_donation_coin").hide()
            },
            pay_modal_select_box(){
                fn_obj.pay_modal_open();

                const goods_no = $(this).attr("data-no");
                const coin = $(this).attr("data-coin");
                dom_obj.goods_no.val(goods_no);
                dom_obj.pay_coin.text(fn_obj.format_number(coin));
                dom_obj.coin_price_pay.text(`${fn_obj.format_number(coin*100)} 원`);
            },
            /////////////////////////////////////////// 결제 관련 ///////////////////////////////////////////////////////////
            async open_kakao_pay_window() {
                const goods_no = dom_obj.goods_no.val();
                const url = `/proc/kakaopay2_call/${goods_no}`;
                const windowFeatures = "width=500,height=600";
                window.open(url, '_blank', windowFeatures);
            },
            async open_naver_pay_window(){
                const goods_no = dom_obj.goods_no.val();
                const url = `https://pay.novelpia.com/pay/naver/step1?goods=${goods_no}&site=novelpia`;
                const windowFeatures = "width=750,height=900,scrollbars=yes";
                window.open(url, '_blank', windowFeatures);
            },
            async open_mobile_pop_window(){
                const goods_no = dom_obj.goods_no.val();
                const url = `/proc/payjoa/mobilepop/${goods_no}`;
                const windowFeatures = "width=500,height=600";
                window.open(url, '_blank', windowFeatures);
            },
            async open_toss_window(){
                const goods_no = dom_obj.goods_no.val();
                let redirectUrl = encodeURIComponent(location.pathname + location.pathname);
                if("/event/novelgoods_purchase" === "/viewer/3929317") {
                    redirectUrl = encodeURIComponent("/event/novelgoods");
                }
                window.open(`https://pay.novelpia.com/toss/payment?goods=${goods_no}&_redirectrurl=${redirectUrl}`, '_blank', 'width=740,height=1040');
            },
            async open_settlebank_pay_window(){
                const dom_mchtTrdNo = $('#STPG_payForm [name="mchtTrdNo"]');
                const mehtod_type = $(this).attr('data-val');
                const goods_no = dom_obj.goods_no.val();
                const coin = dom_obj.pay_coin.text();

                //결제 data init
                fn_obj.stpg_init(mehtod_type, goods_no, coin);
                const trade_no =  dom_mchtTrdNo.val();

                //settle bank 결제준비
                await ajax_obj.payment_setting(trade_no, goods_no, mehtod_type);

                //settle bank 암호화 및 결제창 open
                await ajax_obj.pay_settlebank_proc();
            },
            stpg_init(init_method, goods_no, coin){
                let curr_date = new Date();
                let year = curr_date.getFullYear().toString();
                let month = ("0" + (curr_date.getMonth() + 1)).slice(-2).toString();
                let day = ("0" + (curr_date.getDate())).slice(-2).toString();
                let hours = ("0" + curr_date.getHours()).slice(-2).toString();
                let mins = ("0" + curr_date.getMinutes()).slice(-2).toString();
                let secs = ("0" + curr_date.getSeconds()).slice(-2).toString();
                let random4 = ("000" + Math.random() * 10000 ).slice(-4).toString();

                //날짜관련 셋팅
                $('#STPG_payForm').attr("method", "post");
                $('#STPG_payForm [name="method"]').val(init_method);
                $('#STPG_payForm [name="trdDt"]').val(year + month + day);  //요청일자 세팅
                $('#STPG_payForm [name="trdTm"]').val(hours + mins + secs); //요청시간 세팅
                $('#STPG_payForm [name="mchtTrdNo"]').val("PAYMENT" + year + month + day + hours + mins + secs + random4);//주문번호 세팅

                //데이터관련 셋팅
                $('#STPG_payForm [name="pmtPrdtNm"]').val(`${coin} 코인`);
                $('#STPG_payForm [name="plainTrdAmt"]').val(coin*100);
                $('#STPG_payForm [name="mchtParam"]').val(`0|${goods_no}`);
            },
        }
        const ajax_obj = {
            //셰틀뱅크 결제등록
            async payment_setting(trade_no, goods_no, init_method){
                const url = "/proc/pay_settlebank";
                const data = {
                    trade_no : trade_no,
                    goods_no : goods_no,
                    method : init_method,
                    cmd : "payment_setting",
                };

                const http_result = await http("post", url, data);
                const {status, errmsg, result } = http_result;
                if(status === 201){
                    alert("결제등록에 실패했습니다. 다시 시도해주세요.");
                    payment_flag = 0;
                    return false;
                }
                // console.log(result);
            },
            async pay_settlebank_proc(){
                let app_store = "WEB";
                const target = app_store === "WEB" ? "popup" : "blank"

                // form을 기반으로 실제 settlebank 통신
                //용도 : SHA256 해쉬 처리 및 민감정보 AES256암호화
                $.ajax({
                    type : "POST",
                    url : "/proc/pay_encryptParams",
                    dataType : "json",
                    data : $("#STPG_payForm").serialize(),
                    success : function(rsp){
                        //console.log("여기");
                        //console.log(rsp);
                        //암호화 된 파라미터 세팅
                        for(name in rsp.encParams) {
                            $('#STPG_payForm [name='+name+']').val( rsp.encParams[name] );
                            //console.log(name+' = '+rsp.encParams[name]);
                        };

                        //가맹점 -> 세틀뱅크로 결제 요청
                        SETTLE_PG.pay({
                            env : "https://npg.settlebank.co.kr",   //결제서버 URL
                            mchtId : $('#STPG_payForm [name="mchtId"]').val(),
                            method : $('#STPG_payForm [name="method"]').val(),
                            trdDt : $('#STPG_payForm [name="trdDt"]').val(),
                            trdTm : $('#STPG_payForm [name="trdTm"]').val(),
                            mchtTrdNo : $('#STPG_payForm [name="mchtTrdNo"]').val(),
                            mchtName : $('#STPG_payForm [name="mchtName"]').val(),
                            mchtEName : $('#STPG_payForm [name="mchtEName"]').val(),
                            pmtPrdtNm : $('#STPG_payForm [name="pmtPrdtNm"]').val(),
                            trdAmt : $('#STPG_payForm [name="trdAmt"]').val(),
                            notiUrl : $('#STPG_payForm [name="notiUrl"]').val(),
                            nextUrl : $('#STPG_payForm [name="nextUrl"]').val(),
                            cancUrl : $('#STPG_payForm [name="cancUrl"]').val(),
                            mchtParam : $('#STPG_payForm [name="mchtParam"]').val(),
                            mchtCustId : $('#STPG_payForm [name="mchtCustId"]').val(),
                            autoPayType : $('#STPG_payForm [name="autoPayType"]').val(),
                            plainMchtCustNm : $('#STPG_payForm [name="plainMchtCustNm"]').val(),
                            plainMchtCustId : $('#STPG_payForm [name="plainMchtCustId"]').val(),
                            pktHash : rsp.hashCipher,   //SHA256 처리된 해쉬 값 세팅

                            ui :{
                                type:target,   //popup, iframe, self, blank
                                width: "400",   //popup창의 너비
                                height: "660"   //popup창의 높이
                            }
                        }, function(rsp){
                            //iframe인 경우 전달된 결제 완료 후 응답 파라미터 처리
                            console.log(rsp);
                        });
                    },error : function(request,status,error){
                        console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
                    }
                });
            }
        }

        const init = ()=>{
            event_init();
        }
        init();
    })();
</script><script>
	let g_favoriDepth = 1; // toggle_btn
	let g_emoticon_ready = 0; // toggle_btn
	let g_isDown = false;
	let g_startX;
	let g_scrollLeft;
	let g_page = 1;
	let g_comment_cnt = 0;
	let g_comment_delete = 0;
	let g_user_block = [];
	let g_donation = [];
	let g_comment_call = 0;
	let g_isVisible = false;
	let g_commentload = false;
	let g_novel_emoticon = [];

	$(function(){
		////////////////////////////////////////////
		/// 노벨티콘 ///
		////////////////////////////////////////////

		// 스크롤바 숨김 + 기능 start
		$('#comment_box').on('mousedown', '.comment_box_wrap .emoticon_list .item_wrapper', function(e){
			g_isDown = true;
			$(this).addClass('active');
			g_startX = e.pageX - $(this).offset().left;
			g_scrollLeft = $(this).scrollLeft();
		});

		$('#comment_box').on('mouseleave', '.comment_box_wrap .emoticon_list .item_wrapper', function(){
			g_isDown = false;
			$(this).removeClass('active');
		});

		$('#comment_box').on('mouseup', '.comment_box_wrap .emoticon_list .item_wrapper', function(){
			g_isDown = false;
			$(this).removeClass('active');
		});

		$('#comment_box').on('mousemove', '.comment_box_wrap .emoticon_list .item_wrapper', function(e){
			if(!g_isDown) return;
			e.preventDefault();

			const x = e.pageX - $(this).offset().left;
			const walk = (x - g_startX) * 3 //숫자 늘리면 더 빠르게;
			$(this).scrollLeft(g_scrollLeft - walk);
		});
		// 스크롤바 숨김 + 기능 end

		// 즐찾/내역 토글
		$('#comment_box').on('click', '.favorite_box', function(e){
			let _comment_no = $(this).closest('div.comment').data("idx");

			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}

			emoticon_favorites(_comment_no);
		});

        // 즐찾/내역 이모티콘 탭
		$('#comment_box').on('click', '.emoticon_box .sort_tab > div', function(e){
			let _comment_no = $(this).closest('div.comment').data("idx");

			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}
            if(this.id == 'sort_tab2') {
                get_stamp_sort(_comment_no);
            } else {
                if(g_favoriDepth === 1) {
                    get_emoticon_group_sort(_comment_no);
                } else {
                    get_emoticon_sort(_comment_no);
                }
            }
		});

        // 리스트(stamp) 호출
		$('#comment_box').on('click', '.btn_stamp', function() {
			let _comment_no = $(this).closest('div.comment').data("idx");

			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}

            get_user_stamp(_comment_no);
        });

		// 리스트(emoticon_no) 호출
		$('#comment_box').on('click', '.emoticon_group_list .nav-item', function(){
			let _idx = $(this).data('idx');
			let _comment_no = $(this).closest('div.comment').data("idx");

			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}

			if(_idx != '') {
                g_favoriDepth = 1; // init;
                $('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');
                get_user_emoticon(_idx, _comment_no);
            }
		});

        // 미보유 로얄티콘
		$('#comment_box').on('click', '.stamp_wrap .stamp_list .stamp_ready', function(){
			let _idx = $(this).data('idx');
            openstoreStampModal.open(_idx);
		});

		// 사용 + 내역 추가
		$('#comment_box').on('click', '.emoticon_list_box .emoticon, .stamp_wrap .stamp_list:not(#gridEmoticon) .stamp', function(){
			let _idx = $(this).data('idx');
			let _comment_no = $(this).closest('div.comment').data("idx");
			let _type = $(this).data("type");


			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}

			if(_idx != ""){
				g_favoriDepth = 1; // init;
				$('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');
				set_update_history(_idx, _comment_no, _type);
			}
		});

		// 즐찾
		$('#comment_box').on('click', '.emoticon_view_box .emoticon_fav', function(){
			if($.cookie("secret_mode") == '1'){
				alert("시크릿모드에서는 즐겨찾기를 지정 할 수 없습니다.");
				return ;
			}
			let _is_fav = $("#fav_on_off").val();
			let _idx = $(this).parent().data('idx');
			let _type = $(this).parent().data('type');
			let _comment_no = $(this).closest('div.comment').data("idx");

			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}

			if(_idx != '' && _is_fav != ''){
				g_favoriDepth = 1; // init;
				$('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');
				set_update_favorite(_idx, _is_fav, _comment_no, _type);
			}
		});

		// 미보유콘 토글
		$('#comment_box').on('click', '.emoticon_shop', function(){
			if(g_emoticon_ready == 1){
				$("#comment_box .comment_box_wrap .emoticon_nav").show();
				$("#comment_box .comment_box_wrap .gacha_link").show();
				$("#comment_box .comment_box_wrap .sort_btn").show();
				$("#comment_box .comment_box_wrap .openstore_link").show();
                $('#comment_box .comment_box_wrap .emoticon_list .item_wrapper .btn_stamp').removeClass('off');

				get_user_emoticon_group();
				g_emoticon_ready = 0;
				$(this).css("font-weight", "normal");
			}else{
				$("#comment_box .comment_box_wrap .emoticon_nav").hide();
				$("#comment_box .comment_box_wrap .gacha_link").hide();
				$("#comment_box .comment_box_wrap .sort_btn").hide();
				$("#comment_box .comment_box_wrap .openstore_link").hide();
                $('#comment_box .comment_box_wrap .emoticon_list .item_wrapper .btn_stamp').addClass('off');
				get_emoticon_ready();
				g_emoticon_ready = 1;
				$(this).css("font-weight", "bold");
			}
		});

		// 정렬
		$('#comment_box').on('click', '.emoticon_list .sort_btn', function(){
			//console.log("정렬기능");
			let _comment_no = $(this).closest('div.comment').data("idx");

			// 수정창/답글창 닫기
			if(typeof _comment_no === "undefined"){
				$('#comment_box #comment_load .comment_box').remove();
				$('#comment_box #comment_load .comment_content').show();
				_comment_no = '';
			}

			g_favoriDepth = 1; // init
			$('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');
			get_emoticon_group_sort(_comment_no);
		});

		// 정렬 - 숨기기
		$("#comment_box").on("click", "#gridEmoticon .grid-square", function(){
			if(Number($(this).attr("data-hide")) == 1){
				$(this).attr("data-hide", 0);
			}else{
				$(this).attr("data-hide", 1);
			}
		});

		// 정렬 - 저장
		$("#comment_box").on("click", ".emoticon_sort_box .set_update_emoticon_sort_btn", function(){
			set_update_emoticon_sort();
		});

        // 로얄티콘 정렬 - 저장
		$("#comment_box").on("click", ".emoticon_box .set_update_stamp_sort_btn", function(){
			set_update_stamp_sort();
		});

		// 이하 링크들
		$('#comment_box').on('click', '.emoticon_list .gacha_link', function(){
			if(confirm(getLangTxt("comment.emoticon_page_move"))　) {
				location = '/event/novelticon';
			}
		});

		$('#comment_box').on('click', '.emoticon_list .openstore_link', function(){
			if(confirm(getLangTxt("comment.openstore_page_move"))　) {
				location = '/openstore_v2';
			}
		});

		$('#comment_box').on('click', '.emoticon_purchase', function(){
			let _i = Math.floor(Math.random() * g_novel_emoticon.length);
			//console.log(_i, Math.random(), g_novel_emoticon.length);
			$(this).data('group', g_novel_emoticon[_i]);
			get_emoticon_modal($(this));
		});

		$('#comment_box').on('click', '.emoticon_buy', function(){
			$("#comment_box .emoticon_box").remove();
			get_emoticon_modal($(this));
		});

        $('#comment_box').on('click', '.emoticon_trial_del_btn', function(){
			$("#comment_box .emoticon_box").remove();

            const _emoticon_group_no = $(this).data('group');
            delete_trial_emoticon(_emoticon_group_no);
		});


        $('#comment_box').on('click', '.emoticon_ready', function(){
			$("#comment_box .emoticon_box").remove();
			get_emoticon_modal($(this));
		});


		$('#comment_box').on('click', '.emoticon_tooltip', function(){
			get_emoticon_modal($(this));
		});


		$('#comment_box').on('click', '.stamp_tooltip', function(){
            let _idx = $(this).data('idx');
            openstoreStampModal.open(_idx);
		});

		////////////////////////////////////////////
		/// 댓글 ///
		////////////////////////////////////////////

		// 정렬(등록,최신,추천 등) 선택
		$("#comment_box").on("click", ".comment_list_wrap .sort_filter img", function(){
			get_comment_sort($(this).data("sort"));
		});

		// 대댓글 전부 토글
		$("#comment_box").on("click", ".reply_all_toggle", function(){
			if($(this).hasClass("active") == true){
				$(this).removeClass("active");
				$(this).find('i').removeClass('ion-ios-arrow-up');
				$(this).find('i').addClass('ion-ios-arrow-down');
				$("#comment_box #comment_load .option_rr > i").removeClass('ion-ios-arrow-up');
				$("#comment_box #comment_load .option_rr > i").addClass('ion-ios-arrow-down');
				$("#comment_box #comment_load .comment_re").stop().slideDown(100);
				$.cookie('VIEWER_REPLY', 'OFF', { expires: 365, path: '/', domain: '.novelpia.com', secure: false });
			}else{
				$(this).addClass("active");
				$(this).find('i').removeClass('ion-ios-arrow-down');
				$(this).find('i').addClass('ion-ios-arrow-up');
				$("#comment_box #comment_load .option_rr > i").removeClass('ion-ios-arrow-down');
				$("#comment_box #comment_load .option_rr > i").addClass('ion-ios-arrow-up');
				$("#comment_box #comment_load .comment_re").stop().slideUp(100);
				$.cookie('VIEWER_REPLY', 'ON', { expires: 365, path: '/', domain: '.novelpia.com', secure: false });
			}
		});

		// 대댓글 토글
		$("#comment_box").on("click", "#comment_load .comment_footer .option_rr", function(){
			//console.log("대댓글 토글");
			if($(this).find("i.icon").hasClass("ion-ios-arrow-down") == true){
				$(this).find("i.icon").removeClass("ion-ios-arrow-down");
				$(this).find("i.icon").addClass("ion-ios-arrow-up");
				$("#comment_box #comment_load .re_"+$(this).closest(".comment").data("idx")).stop().slideUp(100);
			}else{
				$(this).find("i.icon").removeClass("ion-ios-arrow-up");
				$(this).find("i.icon").addClass("ion-ios-arrow-down");
				$("#comment_box #comment_load .re_"+$(this).closest(".comment").data("idx")).stop().slideDown(100);
			}

		});

		// img to emoticon_no search
		$("#comment_box").on("click", "#comment_load .novel_tooltip_img", function(){
			let _this = $(this);
			if(_this.next("div").is(":visible") != true) {
				$(".novel_tooltip_img").next("div").hide();
				getImgtoGrpEmt(_this);
			}
		});

		// 입력(insert/update)
		$('#comment_box').on('click', '.set_commit_comment_btn', function(){
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 댓글을 입력 할 수 없습니다.");
				return;
			}
			let _this = $(this).closest('.comment_input_wrap');
			set_commit_comment(_this);
		});

		// 수정
		$("#comment_box").on("click", "#comment_load .comment_footer .option_upd", function(){
			//console.log("수정");
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 댓글을 수정 할 수 없습니다.");
				return;
			}

			// 댓글입력창 이모티콘 닫기
			$("#comment_box .emoticon_box").remove();

			// 버튼 토글 초기화
			g_favoriDepth = 1; // init
			$('#comment_box .favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');

			// 입력창 호출
			get_comment_inputbox("update", $(this).data("idx"), '');
		});

		// 삭제
		$("#comment_box").on("click", "#comment_load .comment_footer .option_del", function(){
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 댓글을 삭제 할 수 없습니다.");
				return;
			}

			// 댓글입력창 이모티콘 닫기
			$("#comment_box .emoticon_box").remove();

			// 버튼 토글 초기화
			g_favoriDepth = 1; // init
			$('#comment_box .favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');

			// 삭제창 호출
			comment_delete_proc($(this).data("idx"));
		});

		// 답글
		$("#comment_box").on("click", "#comment_load .comment_footer .option_re", function(){
			//console.log("답글");
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 답글을 입력 할 수 없습니다.");
				return;
			}

			// 댓글입력창 이모티콘 닫기
			$("#comment_box .emoticon_box").remove();

			// 버튼 토글 초기화
			g_favoriDepth = 1; // init
			$('#comment_box .favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');

			// 입력창 호출
			get_comment_inputbox("insert", '', $(this).data("idx"));
		});

		// 추천
		$("#comment_box").on("click", "#comment_load .comment_footer .option_vot", function(){
			//console.log("추천");
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 추천 할 수 없습니다.");
				return;
			}

			if($(this).attr("data-vote") == 1){
				//console.log("1");
				set_board_option("comment_unvote", $(this).data("idx"));
			}else{
				//console.log("0");
				set_board_option("comment_vote", $(this).data("idx"));
			}
		});

		// 비추
		$("#comment_box").on("click", "#comment_load .comment_footer .option_bad", function(){
			//console.log("비추");
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 비추천을 할 수 없습니다.");
				return;
			}

			if($(this).attr("data-vote") == 1){
				//console.log("1");
				set_board_option("comment_bad_unvote", $(this).data("idx"));
			}else{
				//console.log("0");
				set_board_option("comment_bad_vote", $(this).data("idx"));
			}
		});

		// 신고
		$("#comment_box").on("click", "#comment_load .comment_footer .option_rpt", function(){
			//console.log("신고");
			if(is_secret_mode() == '1'){
				alert("시크릿 모드에서는 신고 할 수 없습니다.");
				return;
			}

			if(confirm("신고 하시겠습니까?")){
				set_board_option("comment_report", $(this).data("idx"));
			}
		});

		// 페이징
		/*
		$("#comment_box").on("click", ".page_navigation > div", function(){
			if($(this).hasClass('disable') == false){
				//console.log($(this).data('page'));
				g_page = $(this).data('page');
				g_comment_cnt = 0; // init count
				get_comment_load();
			}
		});
		*/

		// 스크롤 위치값으로 비동기 댓글 추가 호출 - 22.01.25 ssChoi
		// 더보기 버튼을 넣는것으로 변경하여 주석처리 - 22.01.26 ssChoi
		// 더보기 버튼 대신 스크롤로 변경 - 23.01.26 ssChoi
		$('#comment_box').on('scroll',function() {
			var commentCurrentPercentage = ($("#comment_box").scrollTop() / ($('#comment_box').prop("scrollHeight") - $("#comment_box").height())) * 100;
			//console.log('commentCurrentPercentage = '+$('#comment_box').prop("scrollHeight")+" / "+$("#comment_box").height());
			if(commentCurrentPercentage > 95 &&!g_isVisible&&g_commentload){
				g_isVisible=true;
				g_commentload = false;
				//console.log("_page = "+_page+" g_page = "+g_page);
				if(_page > g_page){
					g_page++;
					let loader_html = `
						<div class="loader s_inv">
							<div class="dot"></div>
							<div class="dot"></div>
							<div class="dot"></div>
							<div class="dot"></div>
						</div>
					`;

					$('.loader').remove();
					$("#comment_load").after(loader_html);
					setTimeout(function() {
						get_comment_load();
					}, 1000);

					setTimeout(function() {
						g_isVisible=false;
					}, 3000);
				}else{
					if($('#comment_end').length == 0){
						console.log("Length 없음 ");
						var end_html = `<div id="comment_end" style="
                                    text-align: center;
                                    border: 1px solid #DDDDDD;
                                    font-size: 14px;
                                    max-width: 200px;
                                    margin: 15px auto;
                                    padding: 12px 0;
                                    border-radius: 40px;
                                    color: #000;
                                    ">더이상 댓글이 없습니다.</div>`;
						$("#comment_load").append(end_html);
					}
					g_isVisible=true;
				}
			}
		});



		////////////////////////////////////////////
		/// 모달 ///
		////////////////////////////////////////////

		// 닫기
		$(".novelticon-modal").on("click", "#detail-modal-close", function(){
			$(".novelticon-modal").modal('hide');
		});

		// 구매
		$(".novelticon-modal").on("click", ".detail-modal-button", function(){
			let _this = $(this);
			if($(this).data('state') == "2"){
				if(confirm("해당 이모티콘을 구매 하시겠습니까?")){
					_this.hide();
					$.ajax({
						data: {
							mode: 'setInsertEmoticon',
							emoticon_group: $(this).data('group'),
							coin: $(this).data('coin'),
							csrf: ""

						},
						type: "POST",
						url: "/proc/emoticon_openstore/",
						cache: false,
						success: function(data) {
							var t = data.split("|");
							if(t[0] == "OK") {
								alert("정상적으로 구매완료 되었습니다.");
								location = "/viewer/3929317";

							} else if(t[0]  == 'LOGIN') {
								if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
									location = "/page/login";
								}
							} else if(t[0]  == 'CSRF') {
								alert("잘못된 접근입니다.");
								location = "/page/login";
							} else if(t[0]  == 'READY') {
								alert("판매가 준비 중인 상품입니다.");
							} else if(t[0]  == 'SOLDOUT') {
								alert("구매가 종료된 상품입니다.");
							} else if(t[0]  == 'GAME') {
								alert("노벨피아 디펜스게임 클리어 보상 이모티콘입니다.");
							} else if(t[0]  == 'PAYMENT') {
								alert("노벨피아 결제자 혜택 전용 이모티콘입니다.");
							} else if(t[0]  == 'GACHA') {
								alert("노벨피아 가챠뽑기 전용 이모티콘입니다.");
							} else if(t[0]  == 'MILEAGE') {
								alert("가챠뽑기 마일리지 교환 전용 이모티콘입니다.");
							} else if(t[0]  == 'BOUGHT') {
								alert("이미 구매가 완료된 이모티콘입니다.");
							} else if(t[0]  == 'COIN') {
								if(confirm("코인이 부족합니다.\n충전 하시겠습니까?")) {
                                    open_coin_pay_modal($(".novelticon-modal").modal('hide'));
								}
							} else if(t[0]  == 'DEFAULT') {
								alert("기본 이모티콘은 구매하실 수 없습니다.");
							} else if(t[0] == "ERROR") {
								alert("로그아웃이 되었거나 유효하지 않은 접근입니다.");
								location = "/openstore";
							} else {
								alert(data);
							}
						},
						complete: function(){
							$('.loads').hide();
							_this.show();
						}
					});
				}
			}else if($(this).data('state') == "3"){
				if($.inArray( $(this).data('group'), [89, 90, 91, 92] ) >= 0){
					alert("다음 시즌 뽑기로 편성될 이모티콘입니다. 나중에 만나요~");
				}else{
					location = "/event/novelticon";
				}
			}else if($(this).data('state') == "4"){
				location = "/plus_shop";
			}else if($(this).data('state') == "5"){
				location = "/plus_shop";
			}else if($(this).data('state') == "6"){
				location = "/event/novelmileage";
			}else{

			}
		});


	});


	////////////////////////////////////////////

    async function delete_trial_emoticon(emoticon_group_no) {
        const param = {
            mode: 'delete_trial_emoticon',
            emoticon_group_no: emoticon_group_no,
            csrf: '',
        };

        const result = await http('post', '/proc/emoticon_proc', param);
        const {status, errmsg} = result;

        if(status !== 200) {
            if(status === 401) {
                if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
                    location = "/page/login";
                }
            } else {
                alert(errmsg);
            }

            return false;
        }

        get_user_emoticon_group()
    }


	// 상단 호출(start point) - 접근 체크
	function get_comment_box(){
		if(g_comment_call != 0){
			return false;
		}else{
			g_comment_call++;
		}

		g_comment_cnt = 0; // count init

		if("310060" != ""){
			$.ajax({
				url: "/proc/viewer",
				data: {
					"mode" : "get_comment_box",
					"novel_no" : "310060",
                    "content_no": 3929317,
					"is_allow_comment" : "1",
					"novel_mem_no" : "1210394",
					"is_early_bird" : "0",
					"content_viewdate" : "2024-10-05 10:00:00",
					"novel_epi_no" : "1",
					"novel_type" : "2",
					"permission_comment" : "",
					"is_contest" : "15",
				},
				type: "POST",
				dataType:"json",
				success: function(response){
					if (response.status == '200') {
						let _html = `
							<div class="comment_box_wrap">
								<div class="title">
									<div>
										<span>댓글</span>
										<span class="comment_counter">(0)</span>
									</div>
																		<div>
										<span class="emoticon_shop">미보유콘</span>
									</div>
																	</div>
								<div class="comment_allbox"><!-- 댓글, 대댓글, 댓글/대댓글 수정 templete -->
								</div>
								<div class="comment_list_wrap">
									<div>
										<div class="sort_filter"></div>
										<div id="comment_load">
											<div style='width:100%;height:50px;line-height:50px;text-align:center;'> 댓글을 불러오고 있습니다 </div>
										</div>
									</div>
								</div>
							</div>


						`;
						$("#comment_box").html('');
						$("#comment_box").append(_html);

						if(response.result && response.result.length > 0){
							g_novel_emoticon = response.result;
							$("#comment_box .emoticon_shop").after('<span class="emoticon_purchase">작가티콘</span>');
						}

						if("0" && "0" == 0){
							$("#comment_box .emoticon_shop").remove();
						}

					} else if(response.status == '401') {
						if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
							location = "/page/login";
						}
					} else {
						alert(response.errmsg);
					}
				},
				complete: function(){/*
					if($.cookie('DARKMODE') == 1) {
						$("#comment_box .c_inv").css("filter", "invert(1)");
					}else{
						$("#comment_box .c_inv").css("filter", "");
					}*/

					get_sort_filter();
					get_comment_inputbox('', '', '');
					get_user_block(); // -> get_novel_donation() -> get_comment_load()
				}
			});
		}
	}


	////////////////////////////////////////////
	/// 노벨티콘 ///
	////////////////////////////////////////////

	// 즐겨찾기/히스토리 toggle
	function emoticon_favorites(comment_no) {
		let _this = $("#comment_box .comment_box_wrap");
		if(comment_no != ""){
			_this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
		}

		if(g_favoriDepth == 0) {
			_this.find('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_0.png');
			g_favoriDepth = 1;
		}else if(g_favoriDepth == 1){
			_this.find('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_1.png');
			g_favoriDepth = 2;
		}else if(g_favoriDepth == 2){
			_this.find('.favorite_box img').attr('src','//images.novelpia.com/old/img/new/viewer/favorites_2.png');
			g_favoriDepth = 0;
		}

		get_emoticon_sort(comment_no);
	}

	// 이모티콘 그룹정렬 리스트
	function get_emoticon_group_sort(comment_no){
		//console.log("get_emoticon_group_sort", comment_no);
		$.ajax({
			url: "/proc/emoticon_proc",
			data: {
				"mode" : "get_user_emoticon_group",
				"target" : "sort"
			},
			type: "get",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					let _this = $("#comment_box .comment_box_wrap");
					if(comment_no != ""){
						_this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
					}
					_this.find(".emoticon_box").remove();

                    let _html = '<div class="sort_tab"><div id="sort_tab1" class="active">노벨티콘</div><div id="sort_tab2">로얄티콘</div></div>';
                    _html += '<div class="info">';
                    _html += '	노벨티콘 설정하기<br/>';
                    //_html += '	1. 드래그로 노벨티콘의 순서를 변경할 수 있습니다.<br/>';
                    _html += '	클릭 시 노벨티콘이 비활성화됩니다.(목록에서 보이지 않습니다.)';
                    _html += '</div>';
                    _this.find(".emoticon_list").after('<div class="emoticon_box emoticon_sort_box">'+_html+'</div>');

					if(response.data && response.data.length > 0){
						let _html = '';
						$.each(response.data, function(i, v){
                            let is_hide = v.is_hide ? 1 : 0;
                            _html += '<div class="grid-square" data-idx="'+v.emoticon_group+'" data-hide="'+is_hide+'"><img class="c_inv" src="'+v.emoticon_url+'" /></div>';
						});

                        _this.find(".emoticon_box").append('<div id="gridEmoticon">'+_html+'</div>');
						_html = '';
						_html += '<div class="btn_wrap">';
						_html += '	<button class="btn btn-primary set_update_emoticon_sort_btn" style="width:100%;">변경사항 저장</button>';
						_html += '</div>';
						$("#comment_box #gridEmoticon").after(_html);
					}

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				// Grid demo
				/*new Sortable(gridEmoticon, {
					animation: 150,
					delay: 50,
					ghostClass: 'blue-background-class',
					onChoose: function (/!**Event*!/evt) {
						//evt.oldIndex;  // element index within parent
						$("#comment_box .comment_box_wrap .emoticon_sort_box").css("background-color", "rgb(228, 229, 230)");
					},
					// Element is unchosen
					onUnchoose: function(/!**Event*!/evt) {
						// same properties as onEnd
						//console.log("@");
						$("#comment_box .comment_box_wrap .emoticon_sort_box").css("background-color", "rgb(248, 249, 250)");
					},
					onMove: function (/!**Event*!/evt, /!**Event*!/originalEvent) {
						//console.log("#");
						// Example: https://jsbin.com/nawahef/edit?js,output
						evt.dragged; // dragged HTMLElement
						evt.draggedRect; // DOMRect {left, top, right, bottom}
						evt.related; // HTMLElement on which have guided
						evt.relatedRect; // DOMRect
						evt.willInsertAfter; // Boolean that is true if Sortable will insert drag element after target by default
						originalEvent.clientY; // mouse position
						// return false; — for cancel
						// return -1; — insert before target
						// return 1; — insert after target
						// return true; — keep default insertion point based on the direction
						// return void; — keep default insertion point based on the direction
					}
				});*/

				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
				}else{
					$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
				}
			}
		});
	}

	// 이모티콘 정렬 저장
	function set_update_emoticon_sort() {
		var sort = [];
		var hide = [];
		// sort, hide
		$("#gridEmoticon .grid-square").each(function(i, v){
			sort.push($(this).data("idx"));
			if(Number($(this).attr("data-hide")) == 1){
				hide.push($(this).data("idx"));
			}
		});

		$.ajax({
            url: "/proc/emoticon_proc",
			data: {
                "mode" : "set_emoticon_array_sort",
				"sort_emoticon_group_no" : sort,
				"hide_emoticon_group_no" : hide,
				"csrf" : ""
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					get_user_emoticon_group();

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			}
		});
	}

    // 로얄티콘 정렬 저장
	function set_update_stamp_sort() {
		//console.log("set_update_emoticon_sort");
		var sort = [];
		var hide = [];
		// sort, hide
		$("#gridEmoticon .grid-square").each(function(i, v){
			sort.push($(this).data("idx"));
			if(Number($(this).attr("data-hide")) == 1){
				hide.push($(this).data("idx"));
			}
		});

		$.ajax({
			url: "/proc/stamp_proc",
			data: {
				"mode" : "set_stamp_array_sort",
				"sort_stamp_no" : sort,
				"hide_stamp_no" : hide,
				"csrf" : ""
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status === 200) {
					$("#comment_box .comment_box_wrap .emoticon_box").remove();
				} else if(response.status === 401) {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .comment_box_wrap .emoticon_group_list .c_inv").css("filter", "invert(1)");
				}else{
					$("#comment_box .comment_box_wrap .emoticon_group_list .c_inv").css("filter", "");
				}
			}
		});
	}

	// 미보유콘
	function get_emoticon_ready(){
		//console.log("get_emoticon_ready");
		$.ajax({
			url: "/proc/viewer",
			data: {
				"mode" : "get_emoticon_ready"
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					$("#comment_box .comment_box_wrap .emoticon_box").remove();
					$("#comment_box .comment_box_wrap .emoticon_group_list").html('');
					if(response.result.emoticon_save && response.result.emoticon_save.length > 0){
						$.each(response.result.emoticon_save, function(i, v){
							$("#comment_box .comment_box_wrap .emoticon_group_list").append('<span class="emoticon_ready" data-group="'+v.emoticon_group+'"><img class="c_inv" src="'+v.emoticon_url+'" /></span>');
						});
					}

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .comment_box_wrap .emoticon_group_list .emoticon_ready img").css("filter", "invert(1) grayscale(1)");
				}else{
					$("#comment_box .comment_box_wrap .emoticon_group_list .emoticon_ready img").css("filter", "grayscale(1)");
				}
			}
		});
	}

	// 이모티콘 즐겨찾기/히스토리 g_favoriDepth 2: 즐겨찾기 , 0: history
	function get_emoticon_sort(comment_no){
		$.ajax({
			url: "/proc/emoticon_proc",
			data: {
				"mode" : "get_emoticon_sort",
				"favoriDepth" : g_favoriDepth
			},
			type: "get",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					let _this = $("#comment_box .comment_box_wrap");
					if(comment_no != ""){
						_this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
					}
					_this.find(".emoticon_box").remove();
                    if(g_favoriDepth == 0){
                        let _html = '<div class="sort_tab"><div id="sort_tab1" class="active">노벨티콘</div><div id="sort_tab2">로얄티콘</div></div>';
                        _html += '<div class="info">최근 사용된 이모티콘 모음입니다.</div>';
                        _this.find(".emoticon_list").after('<div class="emoticon_box">'+_html+'</div>');
                    } else if(g_favoriDepth == 2){
                        let _html = '<div class="sort_tab"><div id="sort_tab1" class="active">노벨티콘</div><div id="sort_tab2">로얄티콘</div></div>';
                        _html += '<div class="info">이모티콘 <img src="//images.novelpia.com/old/img/new/viewer/star_comment.png" />클릭 시 선택한 노벨티콘을 즐겨찾기에서 추가 및 제거할 수 있습니다.</div>';
                        _this.find(".emoticon_list").after('<div class="emoticon_box">'+_html+'</div>');
                    }

					if(response.data && response.data.length > 0){
						let _html2 = '';
						$.each(response.data, function(i, v){
							if(Number(v.is_use) == 1){
								_html2 += '<div class="emoticon" data-idx="'+v.idx+'" data-use="'+v.is_use+'" data-state="'+v.state+'" data-fav="'+v.is_fav+'"><img class="emoticon_url c_inv" src="'+v.emoticon_url+'" /></div>';
							}
						});
						_this.find(".emoticon_box").append('<div class="emoticon_list_box">'+_html2+'</div>');
					}

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
				}else{
					$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
				}
			}
		});
	}

	// 로얄티콘 즐겨찾기/히스토리 g_favoriDepth 2: 즐겨찾기 , 0: history
	function get_stamp_sort(comment_no){
		$.ajax({
			url: "/proc/stamp_proc",
			data: {
				"mode" : "get_stamp_sort",
				"favoriDepth" : g_favoriDepth
			},
			type: "GET",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
                    if($(document).find(".emoticon_box").length == 0 ){
                        $("#comment_box .comment_box_wrap .emoticon_list").after(`<div class="emoticon_box"></div>`);
                    } else {
                        $("#comment_box .comment_box_wrap .emoticon_box").empty();
                    }

                    const emoticon_box = $("#comment_box .comment_box_wrap .emoticon_box").attr('class', 'emoticon_box stamp_wrap');
                    emoticon_box.append('<div class="sort_tab"><div id="sort_tab1">노벨티콘</div><div id="sort_tab2" class="active">로얄티콘</div></div>');
                    if(g_favoriDepth == 0){
                        emoticon_box.append('<div class="info">최근 사용된 로얄티콘 모음입니다.</div>');
                    } else if(g_favoriDepth == 1){
                        let _html = '<div class="info">';
                        _html += '	로얄티콘 설정하기<br/>';
                        //_html += '	1. 드래그로 로얄티콘의 순서를 변경할 수 있습니다.<br/>';
                        _html += '	클릭 시 로얄티콘이 비활성화됩니다.(목록에서 보이지 않습니다.)';
                        _html += '</div>';
                        emoticon_box.append(_html);
                    } else if(g_favoriDepth == 2){
                        emoticon_box.append('<div class="info">로얄티콘 <img src="//images.novelpia.com/old/img/new/viewer/star_comment.png" />클릭 시 선택한 로얄티콘을 즐겨찾기에서 추가 및 제거할 수 있습니다.</div>');
                    }

                    emoticon_box.append(`<div class="swiper stamp_swiper"><div class="swiper-wrapper stamp_list"></div></div>`);
                    const stamp_section = $('.stamp_list', emoticon_box);
                    if(g_favoriDepth === 1) {
                        stamp_section.attr('id', 'gridEmoticon');
                        let _html = '';
                        _html += '<div class="btn_wrap">';
                        _html += '	<button class="btn btn-primary set_update_stamp_sort_btn" style="width:100%;">변경사항 저장</button>';
                        _html += '</div>';
                        emoticon_box.append(_html);
                    }

                    if(response.data && response.data.length > 0) {
                        $.each(response.data, function (key, value) {
                            $('<div>', {
                                class: 'stamp c_inv swiper-slide grid-square',
                                html: '<img class="stamp_url" src="'+ G_CDN_DOMAIN_IMG + value.stamp_url +'">',
                                'data-idx': value.idx,
                                'data-use': 1,
                                'data-hide': Number(value.display === 0),
                                'data-state': value.state,
                                'data-fav': value.fav,
                                'data-type': 'stamp',
                            }).appendTo(stamp_section);
                        });
                    }

                    const stamp_swiper = new Swiper("#comment_box .comment_box_wrap .stamp_swiper", {
                        slidesPerView: 'auto',
                        spaceBetween: 14,
                        freeMode: true,
                    });
				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
				}else{
					$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
				}
			}
		});
	}

	// 이모티콘 그룹 리스트
	function get_user_emoticon_group(_this){
		$.ajax({
			url: "/proc/emoticon_proc",
			data: {
				"mode" : "get_user_emoticon_group"
			},
			type: "get",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
                    let $emoticon_list = $(".emoticon_group_list");
					if(_this) {
						$emoticon_list = _this.find('.emoticon_group_list');
                    }

                    $emoticon_list.html('');
                    $("#comment_box .comment_box_wrap .emoticon_box").remove();
                    if(response.data && response.data.length > 0){
                        $.each(response.data, function(i, v){
                            let html = '';

                            html += `<span class="nav-item" data-idx="${v.emoticon_group}">
                                        <img class="c_inv" src="${v.emoticon_url}"/>
                                    </span>`;
                            $emoticon_list.append(html);
                        });
                    }

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .comment_box_wrap .emoticon_group_list .c_inv").css("filter", "invert(1)");
				}else{
					$("#comment_box .comment_box_wrap .emoticon_group_list .c_inv").css("filter", "");
				}

									get_ad_banner(); // ad_banner
							}
		});
	}

	// 이모티콘 선택 리스트
	function get_user_emoticon(emoticon_group_no, comment_no){
        $.ajax({
            url: "/proc/emoticon_proc",
            data: {
                "mode" : "get_user_emoticon",
                "emoticon_group_no" : emoticon_group_no,
            },
            type: "get",
            dataType:"json",
            success: function(response){
                if (response.status == '200') {
                    let _this = $("#comment_box .comment_box_wrap");
                    if(comment_no && comment_no != ""){
                        _this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
                    }
                    _this.find(".emoticon_box").remove();
                    if(response.data) {
                        if(response.data.is_buy_emoticon !== undefined){
                            let _html = `
                                 <div class="emoticon_box emoticon_trial_box">
                                    <div>
                                        <div class="emoticon">
                                            <img class="emoticon_url c_inv" src="${response.data.emoticon_url}" />
                                        </div>
                                        <div class="emoticon_info">
                                            <div class="emoticon_group_name">${response.data.emoticon_group_name}<p>노벨피아</p></div>
                                            <div>`;
                            if(response.data.is_buy_emoticon === 1) {
                                _html += `        <button class="emoticon_buy" data-group="${response.data.emoticon_group}">구매하기</button>`;
                            } else {
                                _html += `        <button class="emoticon_different" onclick="location.href='/openstore_v2';">다른 이모티콘 보기</button>`;
                            }
                            _html += `
                                            </div>
                                        </div>
                                    </div>
                                    <div class="emoticon_trial_notice_box">
                                        <div class="emoticon_trial_notice_txt">한정 노벨티콘 무료 사용 기간이 끝났습니다.</div>
                                        <div class="emoticon_trial_del_btn" data-group="${response.data.emoticon_group}">삭제</div>
                                    </div>
                                </div>`;
                            _this.find(".emoticon_list").after(_html);
                        } else {
                            if(response.data.length > 0) {
                                let _html = '';
                                $.each(response.data, function(i, v){
                                    _html += '<div class="emoticon" data-idx="'+v.idx+'" data-use="'+v.is_use+'" data-state="'+v.state+'" data-fav="'+v.is_fav+'"><img class="emoticon_url c_inv" src="'+v.emoticon_url+'" /></div>';
                                });
                                _this.find(".emoticon_list").after('<div class="emoticon_box emoticon_list_box">'+_html+'</div>');
                            }
                        }
                    }

                } else if(response.status == '401') {
                    if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
                        location = "/page/login";
                    }
                } else {
                    alert(response.errmsg);
                }
            },
            complete: function(){
                if($.cookie('DARKMODE') == 1) {
                    $("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
                }else{
                    $("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
                }
            }
        });
	}

    async function get_user_stamp(comment_no) {
        let param;
        if (g_emoticon_ready === 1) {
            param = {
                mode: 'get_list_stamp_unsave'
            };
        } else {
            param = {
                mode: 'get_list_stamp_save'
            };
        }
        const result = await http('get', '/proc/stamp_proc', param);
        const {status, data, errmsg} = result;

        if(status === 200){
            if(g_emoticon_ready === 1) {
                let _this = $("#comment_box .comment_box_wrap");
                if(comment_no && comment_no != ""){
                    _this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
                }

                if($(document).find(".emoticon_box").length == 0 ){
                    _this.find(".emoticon_list").after(`<div class="emoticon_box"></div>`);
                } else {
                    _this.find(".emoticon_box").empty();
                }
                const emoticon_box = _this.find(".emoticon_box").attr('class', 'emoticon_box stamp_wrap');
                emoticon_box.append(`<div class="swiper stamp_swiper"><div class="swiper-wrapper stamp_list"></div></div>`);
                const stamp_section = $('.stamp_list', emoticon_box);

                if(data && data.length > 0) {
                    $.each(data, function(key, value) {
                        $('<div>', {
                            class: 'stamp_ready c_inv swiper-slide',
                            html: '<img class="stamp_url" src="'+ G_CDN_DOMAIN_IMG + value.stamp_url +'">',
                            'data-idx': value.idx,
                        }).appendTo(stamp_section);
                    });

                    const stamp_swiper = new Swiper("#comment_box .comment_box_wrap .stamp_swiper", {
                        slidesPerView: 'auto',
                        spaceBetween: 14,
                        freeMode: true,
                    });
					if($.cookie('DARKMODE') == 1) {
						_this.find(".emoticon_box .c_inv").css("filter", "invert(1)");
					}else{
						_this.find(".emoticon_box .c_inv").css("filter", "");
					}
                } else {
                    $('<div>', {
                        style: 'width: 100%; text-align: center',
                        html: `모든 로얄티콘을 보유하고 있습니다.`,
                    }).appendTo(stamp_section);
                }
            } else {
                let _this = $("#comment_box .comment_box_wrap");
                if(comment_no && comment_no != ""){
                    _this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
                }

                if($(document).find(".emoticon_box").length == 0 ){
                    _this.find(".emoticon_list").after(`<div class="emoticon_box"></div>`);
                } else {
                    _this.find(".emoticon_box").empty();
                }
                const emoticon_box = _this.find(".emoticon_box").attr('class', 'emoticon_box stamp_wrap');
                emoticon_box.append(`<div class="swiper stamp_swiper"><div class="swiper-wrapper stamp_list"></div></div>`);
                const stamp_section = $('.stamp_list', emoticon_box);

                if(data && data.length > 0) {
                    $.each(data, function(key, value) {
                        $('<div>', {
                            class: 'stamp c_inv swiper-slide',
                            html: '<img class="stamp_url" src="'+ G_CDN_DOMAIN_IMG + value.stamp_url +'">',
                            'data-idx': value.idx,
                            'data-use': 1,
                            'data-state': value.state,
                            'data-fav': value.fav,
                            'data-type': 'stamp',
                        }).appendTo(stamp_section);
                    });

                    const stamp_swiper = new Swiper("#comment_box .comment_box_wrap .stamp_swiper", {
                        slidesPerView: 'auto',
                        spaceBetween: 14,
                        freeMode: true,

                    });

					if($.cookie('DARKMODE') == 1) {
						_this.find(".emoticon_box .c_inv .stamp_url").css("filter", "invert(1)");
					}else{
						_this.find(".emoticon_box .c_inv .stamp_url").css("filter", "");
					}
                } else {
                    $('<div>', {
                        style: 'width: 100%; text-align: center',
                        html: `보유하고 있는 로얄티콘이 없습니다.`,
                    }).appendTo(stamp_section);
                }
            }
        } else if(status === 401) {
            if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
                location = "/page/login";
            }
        } else {
            alert(errmsg);
        }
    }

    // 로얄티콘 선택 리스트
    function get_stamp_view(idx, comment_no) {
        if(idx != ''){
			let _this = $("#comment_box .comment_box_wrap");
			if(comment_no != ""){
				_this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
			}
			let _use = _this.find(".emoticon_box .stamp[data-idx='"+idx+"']").data("use");
			let _state = _this.find(".emoticon_box .stamp[data-idx='"+idx+"']").data("state");
			let _fav = _this.find(".emoticon_box .stamp[data-idx='"+idx+"']").data("fav");
			let _url = _this.find(".emoticon_box .stamp[data-idx='"+idx+"']").find('img.stamp_url').attr("src");
			let _html = '';

			_html += '<div class="stamp" data-type="stamp" data-idx="'+idx+'" data-use="'+_use+'" data-state="'+_state+'">';
			_html += '	<div class="emoticon_fav">';
			if(Number(_fav) == 1){
				_html += '		<img class="c_inv" src="//images.novelpia.com/old/img/new/viewer/star_on.png">';
			}else{
				_html += '		<img class="c_inv" src="//images.novelpia.com/old/img/new/viewer/star_off.png">';
			}
			_html += '		<input type="hidden" id="fav_on_off" name="fav_on_off" value="'+_fav+'" />';
			_html += '	</div>';

			_html += '	<img class="stamp_url c_inv" src="'+_url+'"/>';
			_html += '</div>';
			_this.find(".emoticon_box").remove();
			_this.find(".emoticon_list").after('<div class="emoticon_box emoticon_view_box">'+_html+'</div>');
			_this.find("input[name='comment_img']").val(_url);

			if($.cookie('DARKMODE') == 1) {
				$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
			}else{
				$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
			}
		}
    }

	// 이모티콘 선택 리스트
	function get_emoticon_view(idx, comment_no){
		//console.log("get_emoticon_view", idx, comment_no);

		if(idx != ''){
			let _this = $("#comment_box .comment_box_wrap");
			if(comment_no != ""){
				_this = $("#comment_box .comment_box_wrap .comment[data-idx='"+comment_no+"']");
			}
			let _use = _this.find(".emoticon_box .emoticon[data-idx='"+idx+"']").data("use");
			let _state = _this.find(".emoticon_box .emoticon[data-idx='"+idx+"']").data("state");
			let _fav = _this.find(".emoticon_box .emoticon[data-idx='"+idx+"']").data("fav");
			let _url = _this.find(".emoticon_box .emoticon[data-idx='"+idx+"']").find('img.emoticon_url').attr("src");
			let _html = '';
			//console.log(_use, _state, _fav, _url);

			_html += '<div class="emoticon" data-idx="'+idx+'" data-use="'+_use+'" data-state="'+_state+'">';
			_html += '	<div class="emoticon_fav">';
			if(Number(_fav) == 1){
				_html += '		<img class="c_inv" src="//images.novelpia.com/old/img/new/viewer/star_on.png">';
			}else{
				_html += '		<img class="c_inv" src="//images.novelpia.com/old/img/new/viewer/star_off.png">';
			}
			_html += '		<input type="hidden" id="fav_on_off" name="fav_on_off" value="'+_fav+'" />';
			_html += '	</div>';
			_html += '	<img class="emoticon_url c_inv" src="'+_url+'" />';
			_html += '</div>';
			_this.find(".emoticon_box").remove();
			_this.find(".emoticon_list").after('<div class="emoticon_box emoticon_view_box">'+_html+'</div>');
			_this.find("input[name='comment_img']").val(_url);

			if($.cookie('DARKMODE') == 1) {
				$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
			}else{
				$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
			}
		}
	}

	// 이모티콘 선택 기록
	function set_update_history(idx, comment_no, type = 'emoticon') {
        if(idx != "") {
            let mode = ''
            let url = '';

            if(type === 'stamp') {
                mode = 'set_stamp_sort'
                url = '/proc/stamp_proc';
            } else {
                mode = 'set_emoticon_sort';
                url = '/proc/emoticon_proc';
            }

            $.ajax({
                url: url,
                data: {
                    mode : mode,
                    type: 'history',
                    idx : idx,
                    csrf : ""
                },
                type: "POST",
                dataType:"json",
                success: function(response){
                    if (response.status == '200') {
                        if(type === 'stamp') {
                            get_stamp_view(idx, comment_no);
                        } else {
                            get_emoticon_view(idx, comment_no);
                        }
                    } else if(response.status == '401') {
                        if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
                            location = "/page/login";
                        }
                    } else {
                        alert(response.errmsg);
                    }
                },
				complete: function(){
					if($.cookie('DARKMODE') == 1) {
						$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
					}else{
						$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
					}
				}
            });
        }
	}

	// 이모티콘 즐겨찾기
	function set_update_favorite(idx, is_fav, comment_no, type = 'emoticon'){
		if(idx != "" && is_fav != ""){
            let mode = ''
            let url = '';

            if(type === 'stamp') {
                mode = 'set_stamp_sort'
                url = '/proc/stamp_proc';
            } else {
                mode = 'set_emoticon_sort';
                url = '/proc/emoticon_proc';
            }
            const is_switch = is_fav == 1 ? 0 : 1
			$.ajax({
				url: url,
				data: {
					mode : mode,
                    type: 'favorite',
					idx : idx,
					is_switch : is_switch,
					csrf : ""
				},
				type: "POST",
				dataType:"json",
				success: function(response){
					if (response.status == '200') {
                        if(type === 'stamp') {
                            let _this = $("#comment_box .comment_box_wrap .emoticon_box .stamp[data-idx='"+idx+"']");
                            _this.attr('data-fav', response.result);
                            get_stamp_view(idx, comment_no);
                        } else {
                            let _this = $("#comment_box .comment_box_wrap .emoticon_box .emoticon[data-idx='"+idx+"']");
                            _this.attr('data-fav', response.result);
                            get_emoticon_view(idx, comment_no);
                        }
					} else if(response.status == '401') {
						if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
							location = "/page/login";
						}
					} else {
						alert(response.errmsg);
					}
				},
				complete: function(){
					if($.cookie('DARKMODE') == 1) {
						$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "invert(1)");
					}else{
						$("#comment_box .comment_box_wrap .emoticon_box .c_inv").css("filter", "");
					}
				}
			});
		}
	}

	// 광고 배너
	function get_ad_banner(){
		//console.log("get_ad_banner");
		$.ajax({
			url: "/proc/viewer",
			data: {
				"mode" : "get_ad_banner"
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					if(response.result && response.result.length != ""){
						let _html = '';
						_html += '<div class="ad_banner">';
						_html += '	<img class="c_inv" style="" src="'+response.result.img+'" alt="댓글광고" onclick="location.href='+response.result.src+'" />';
						_html += '</div>';

						$("#comment_box .ad_banner").remove();
						$("#comment_box .comment_input_wrap").after(_html);
					}
				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box .ad_banner .c_inv").css("filter", "invert(1)");
				}else{
					$("#comment_box .ad_banner .c_inv").css("filter", "");
				}
			}
		});
	}

	////////////////////////////////////////////
	/// 댓글 ///
	////////////////////////////////////////////

	// 댓글 정렬
	function get_sort_filter(){
		let _html = '';
		let _flag = '';
		g_page = 1;

		/*
		_flag = ($.cookie('COMMENT_SORT') == 'reg' || $.cookie('COMMENT_SORT') == '')? '_on' : '';
		_html += '<img class="c_inv" data-sort="" src="//images.novelpia.com/img/new/comment/reg'+_flag+'.png" />';
		_flag = ($.cookie('COMMENT_SORT') == 'new')? '_on' : '';
		_html += '<img class="c_inv" data-sort="new" src="//images.novelpia.com/img/new/comment/new'+_flag+'.png" />';
		_flag = ($.cookie('COMMENT_SORT') == 'vote')? '_on' : '';
		_html += '<img class="c_inv" data-sort="vote" src="//images.novelpia.com/img/new/comment/vote'+_flag+'.png" />';
		_flag = ($.cookie('COMMENT_SORT') == 'my')? '_on' : '';
		_html += '<img class="c_inv" data-sort="my" src="//images.novelpia.com/img/new/comment/my'+_flag+'.png" />';
		_html += '<span class="reply_all_toggle"><i class="icon ion-ios-arrow-down"></i> 대댓글</span>';
		*/

		let sort_comment = $.cookie('COMMENT_SORT');
		_html = `
			<img class="c_inv sort_reg" data-sort="" src="//images.novelpia.com/old/img/new/comment/reg.png" />
			<img class="c_inv sort_new" data-sort="new" src="//images.novelpia.com/old/img/new/comment/new.png" />
			<img class="c_inv sort_vote" data-sort="vote" src="//images.novelpia.com/old/img/new/comment/vote.png" />
			<img class="c_inv sort_my" data-sort="my" src="//images.novelpia.com/old/img/new/comment/my.png" />
			<span class="reply_all_toggle"><i class="icon ion-ios-arrow-down"></i> 대댓글</span>
		`;

		$("#comment_box .sort_filter").html('');
		$("#comment_box .sort_filter").append(_html);
		$("#comment_box .sort_filter .c_inv").css("filter", "");

		if(sort_comment == ''){
			$("#comment_box .sort_filter .sort_reg").attr("src", "/img/new/comment/reg_on.png");
		}else{
			$("#comment_box .sort_filter .sort_"+sort_comment).attr("src", "/img/new/comment/"+sort_comment+"_on.png");
		}
	}

	// 댓글창(+재귀 대댓글)
	function get_comment_inputbox(target, comment_no, comment_re_no){ // episode_no, comment_re_no
		let _html = `
			<div class="emoticon_list">
				<div>
					<div class="emoticon_nav">
						<span class="nav-menu favorite_box">
							<img src="//images.novelpia.com/old/img/new/viewer/favorites_0.png" alt="즐겨찾기 버튼" />
						</span>
					</div>
					<div class="item_wrapper">
                        <span class="btn_stamp">
                            <span class="nav-item"><img src="//images.novelpia.com/img/new/icon/btn_stamp_on.png"></span>
                        </span>
						<!-- emoticon_list -->
						<span class="emoticon_group_list"></span>
												<span class="nav-menu gacha_link">
							<img src="//images.novelpia.com/old/img/new/viewer/emoticon_fork.png" alt="노벨티콘 뽑기 페이지 이동">
						</span>
												<span class="nav-menu sort_btn" onclick="">
							<img src="//images.novelpia.com/old/img/new/viewer/emoticon_setting.png" alt="노벨티콘 세팅하기">
						</span>
					</div>
										<div class="nav-menu openstore_link" style="cursor:pointer;" onclick="">
						<img src="//images.novelpia.com/old/img/new/viewer/emoticon_shop.png" alt="노벨티콘 스토어가기">
					</div>
									</div> <!--이모티콘 라인 끝-->
			</div>
			<div class="comment_input_wrap">
				<div>
		`;
		if(is_secret_mode() == '1'){
			_html += `	<textarea rows="3" class="form-control" placeholder="시크릿 모드에서는 댓글을 입력 할 수 없습니다." name="comment_msg" style="-webkit-touch-callout: text;-webkit-user-select: text;user-select: text;background-color: #FFF;" readonly></textarea> `;
		}else{
			_html += `	<textarea rows="3" class="form-control" placeholder="댓글을 입력해 보세요." name="comment_msg" style="-webkit-touch-callout: text;-webkit-user-select: text;user-select: text;background-color: #FFF;"></textarea> `;
		}

		_html +=`	<input type="hidden" name="target" />
					<input type="hidden" name="comment_img" />
					<input type="hidden" name="content_no" value="3929317" />
					<input type="hidden" name="comment_no" />
					<input type="hidden" name="comment_re_no" />
				</div>
				<div>
					<button class="btn btn-dark set_commit_comment_btn"><i class="icon ion-edit"></i> 댓글입력</button>
				</div>
			</div>
		`;

		let _this = $("#comment_box #comment_load .comment");

		_this.find(".comment_box").remove();
		_this.find(".comment_content").show();
		if(target && target != ""){
			if(target == "update"){ // 수정
				if(comment_re_no && comment_re_no != ""){ // 대댓글
					_this = $("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"']");
					_this.find('.comment_content').after('<div class="comment_box">'+_html+'</div>');
					_this.find('.comment_content').hide();
					_this.find('.comment_box').addClass('comment_re_box');
				}else{ // 댓글
					_this = $("#comment_box #comment_load .comment[data-idx='"+comment_no+"']");
					_this.find('.comment_content').after('<div class="comment_box">'+_html+'</div>');
					_this.find('.comment_box input[name="target"]').val(target);
					_this.find('.comment_box input[name="comment_no"]').val(comment_no);
					_this.find('.comment_box input[name="comment_img"]').val(_this.find('.comment_content .comment_img > img').attr("src"));
					_this.find('.comment_box textarea[name="comment_msg"]').val(_this.find('.comment_content .comment_text').text());
					_this.find('.comment_content').hide();
					_this.find('.gacha_link').hide();
					_this.find('.sort_btn').hide();
					_this.find('.openstore_link').hide();
					_this.find('.comment_input_wrap button').html('<i class="icon ion-edit"></i> 댓글수정');
					if(_this.find('.comment_content .comment_img > img').attr("src") != ""){
						let _html2 = '';
						_html2 += '<div class="emoticon">';
						_html2 += '	<img class="emoticon_url c_inv" src="'+_this.find('.comment_content .comment_img > img').attr("src")+'" />';
						_html2 += '</div>';
						_this.find(".emoticon_list").after('<div class="emoticon_box emoticon_view_box">'+_html2+'</div>');
					}
                    if($.cookie('DARKMODE') == 1) {
						_this.find(".emoticon img.c_inv").css("filter", "invert(1)");
					}else{
						_this.find(".emoticon img.c_inv").css("filter", "");
					}
				}
			}else if(target == "insert"){ // 입력(댓글)
				if(comment_re_no && comment_re_no != ""){
					_this = $("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"']");
					_this.append('<div class="comment_box">'+_html+'</div>');
					_this.find('.gacha_link').hide();
					_this.find('.sort_btn').hide();
					_this.find('.openstore_link').hide();
					_this.find('.comment_box').addClass('comment_re_box');
					_this.find('.comment_box input[name="target"]').val(target);
					_this.find('.comment_box input[name="comment_re_no"]').val(comment_re_no);
				}
			}
			get_user_emoticon_group(_this);
		}else{
			$("#comment_box .comment_allbox").html('');
			$("#comment_box .comment_allbox").append(_html);
			$("#comment_box .comment_allbox .comment_input_wrap input[name='target']").val("insert");
			get_user_emoticon_group();
		}
	}

	// 차단리스트
	function get_user_block(){
		$.ajax({
			url: "/proc/viewer",
			data: {
				"mode" : "get_user_block",
				"mem_no" : "1210394"
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					g_user_block = response.result;

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				get_novel_donation();
			}
		});
	}

	// 후원리스트
	function get_novel_donation(){
		$.ajax({
			url: "/proc/viewer",
			data: {
				"mode" : "get_novel_donation",
				"mem_no" : "1210394"
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					g_donation = response.result;

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				get_comment_load();
			}
		});
	}

	// 댓글 리스트 호출 - 페이지, 대댓글
	function get_comment_load(comment_re_no = 0, comment_ori_no = 0){
		g_commentload = false;

		$.ajax({
			url: "/proc/viewer",
			data: {
				"mode" : "get_comment_list",
				"episode_no" : "3929317",
                "novel_no" : "310060",
				"story_mem_no" : "1210394",
				"comment_re_no" : comment_re_no,
				//"user_block" : g_user_block,
				"donation" : g_donation,
				"page" : g_page
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if (response.status == '200') {
					g_commentload = true;
					g_isVisible = true;

					let _html = `
						<div class="comment_wrap">
							<div class="comment_header">
								<div class="user_name"></div>
								<div class="user_img"></div>
							</div>
							<div class="comment_content">
								<div class="comment_regdate"></div>
								<div class="comment_img">
									<img class="c_inv novel_tooltip_img" src="" />
									<div class="novel_tooltip">
										<div class="novel_title"></div>
										<div class="novel_store_btn emoticon_tooltip">노벨티콘 보기</div>
										<div class="novel_store_btn stamp_tooltip">로얄티콘 보기</div>
									</div>
								</div>
								<div class="comment_text"></div>
							</div>
							<div class="comment_footer">
								<div>
									<span class="comment_option option_upd"><i class="icon ion-chatbubble-working"></i> 수정</span>
									<span class="line">|</span>
									<span class="comment_option option_del"><i class="icon ion-trash-a"></i> 삭제</span>
									<span class="line">|</span>
									<span class="comment_option option_re"><i class="icon ion-chatbubble-working"></i> 답글</span>
									<span class="line">|</span>
									<span class="comment_option option_vot"><i class="ion-thumbsup"></i> 추천 <span class="comment_vote">0</span>건</span>
									<span class="line">|</span>
									<span class="comment_option option_bad"><i class="ion-thumbsdown"></i> 비추 <span class="comment_bad">0</span>건</span>
									<span class="line">|</span>
									<span class="comment_option option_rpt"> 신고</span>
								</div>
							</div>
						</div>
					`;
					if(g_page == 1){
						if(comment_re_no == 0){
							$("#comment_load").html('');
							$(".page_navigation").remove();
						}
					}

					if(response.result && response.result.length > 0){
						if(comment_re_no != 0){ // 대댓글
							let _reply_cnt = Number($("#comment_box #comment_load .comment[data-idx='"+comment_ori_no+"'] .comment_reply").text());
							_reply_cnt += response.result.length;
							$("#comment_box #comment_load .comment[data-idx='"+comment_ori_no+"'] .comment_reply").text(_reply_cnt);
						}
						$.each(response.result, function(i, v){
							let _this = '';
							if(comment_re_no == 0){ // 댓글
								if(g_page == 1){
									$("#comment_load").append('<div class="comment" data-idx="'+v.comment_idx+'">'+_html+'</div>');
								}else if(g_page >= 2){
									$("#comment_load").append('<div class="comment more_comment'+g_page+'" data-idx="'+v.comment_idx+'">'+_html+'</div>');
								}

								_this = $("#comment_load .comment[data-idx='"+v.comment_idx+"']");
								if(Number(v.comment_child_cnt) > 0){
                                    if(_this.find('.option_rr').length === 0) {
                                        _this.find(".comment_footer > div").prepend("<span class='comment_option option_rr'><i class='icon ion-ios-arrow-down'></i> 대댓글 <span class='comment_reply'>0</span>건</span><span class='line'>|</span>");
                                        get_comment_load(v.comment_idx, v.comment_idx); // 대댓글 호출
                                    }
								}
							}else{ // 대댓글
								if(g_page == 1){
									$("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"']").after('<div class="comment comment_re re_'+comment_ori_no+'" data-idx="'+v.comment_idx+'">'+_html+'</div>');
								}else if(g_page >= 2){
									$("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"']").after('<div class="comment comment_re more_comment'+g_page+' re_'+comment_ori_no+'" data-idx="'+v.comment_idx+'">'+_html+'</div>');
								}
								_this = $("#comment_box #comment_load .comment_re[data-idx='"+v.comment_idx+"']");
								_this.append('<img class="arrow_right" src="//images.novelpia.com/old/img/layout/arrow_right.png" />');
								_this.find(".option_rr").hide();

								if(Number(v.comment_child_cnt) > 0){
									get_comment_load(v.comment_idx, comment_ori_no); // 대댓글 호출
								}
							}

							// common
							_this.attr("data-status", v.comment_status);
							if(v.is_block == 1){
								_this.addClass("block");
							}
							if(Number('1210394') == v.mem_no){
								_this.find(".user_name").addClass("writer");
								_this.find(".user_name").html('<img src="//images.novelpia.com/old/img/new/icon/novel_master.png" style="vertical-align: text-middle;height:18px;" class="c_inv" title="소설작가" onclick="alert(\'현재 보시는 소설의 작가입니다\');">'+v.user_name);
							}else{
                                let benefit_img = "";
                                if(v.benefit !== null){
                                    benefit_img = '<img style="filter:invert(1); width: 18px; height: 18px;margin-right:5px;"src="'+ G_CDN_DOMAIN_IMG + v.benefit.benefit_img +'" onclick="alert(\''+ v.benefit.benefit_memo +'\');" />';
                                }
								 _this.find(".user_name").html(benefit_img+v.user_name);

							}
							_this.find(".user_img").html(v.user_img);

							let _name = $("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"'] .user_name").text();
							let _msg = '';
							_msg += (comment_re_no == 0)? '' : _name+'님에게 메세지이며, ';
							if(v.comment_editdate && v.comment_editdate != ''){
								_msg += v.comment_editdate_txt;
								_this.find(".comment_regdate").text(_msg+' 수정됨');
								_this.find(".comment_regdate").addClass('comment_modify');
							}else{
								_msg += v.comment_regdate_txt;
								_this.find(".comment_regdate").text(_msg+' 작성됨');
							}

							if(v.comment_status == 0){
                                if(Number('0') >= 10){

                                }
                                else {
                                    _this.find(".user_name").hide();
                                    _this.find(".user_img").hide();
                                }

								_this.find(".comment_regdate").after('<span style="color: #999;">삭제된 댓글 입니다.</span><br/>');
							}

							if(v.comment_img && v.comment_img != ""){
                                let exp = /imagebox\/stamp/;
                                if(exp.test(v.comment_img)){
                                    _this.find(".comment_img").addClass('stamp');
                                    _this.find(".comment_img .novel_tooltip_img").addClass('stamp_url');
                                }else{
                                    _this.find(".comment_img .novel_tooltip_img").css("width","100px");
                                }
								_this.find(".comment_img .novel_tooltip_img").attr("src", v.comment_img);
							}else{
								_this.find(".comment_img").hide();
							}

							if(v.is_donate == 1){
								_this.find(".comment_text").addClass("donate");
							}

							_this.find(".comment_text").html(v.comment_msg);
							_this.find(".comment_vote").text(v.comment_vote);
							_this.find(".comment_bad").text(v.comment_bad);
							_this.find(".comment_option").attr("data-idx", v.comment_idx);
							_this.find(".option_vot").attr("data-vote", v.is_comment_vote);
							_this.find(".option_bad").attr("data-vote", v.is_comment_bad);

							if(v.mem_no != "0"){
								_this.find(".option_upd+.line").remove();
								_this.find(".option_upd").remove();
							}

							if(v.mem_no != "0" && Number("0") < 10){
								_this.find(".option_del+.line").remove();
								_this.find(".option_del").remove();
							}

							if(v.mem_no == "0" || v.mem_no == Number('1210394')){
								_this.find(".option_bad+.line").remove();
								_this.find(".option_bad").remove();
							}

							if(v.mem_no == "0"){
								_this.find(".option_rpt").prev(".line").remove();
								_this.find(".option_rpt").remove();
							}

							if(v.comment_status == 0 && Number("0") < 10){
								_this.find(".comment_img").remove();
								_this.find(".comment_text").remove();
							}
						});
						g_comment_cnt = Number(response.comment_counter);
						$("#comment_box .comment_counter").text('('+g_comment_cnt+')');

						if(comment_re_no == 0 && response.page && response.page != ""){
							//console.log(response.page);
							let _html = '';
							let _flag = 0;

							_flag = (g_page == 1)? ' disable ' : '';
							_html += '<div class="'+_flag+'" data-page="1"><i class="icon ion-arrow-left-a"></i></div>';
							_page = (g_page > 2)? g_page - 1 : 1;
							_html += '<div class="'+_flag+'" data-page="'+_page+'"><i class="icon ion-arrow-left-b"></i></div>';
							for(let _i = response.page.START; _i <= response.page.END; _i++){
								_flag = (_i == g_page)? ' active ' : '';
								_html += '<div class="'+_flag+'" data-page="'+_i+'">'+_i+'</div>';
							}
							_flag = (g_page == response.page.MAX_PAGE)? ' disable ' : '';
							_page = (response.page.MAX_PAGE < response.page.NEXT)? response.page.MAX_PAGE : response.page.NEXT;
							_html += '<div class="'+_flag+'" data-page="'+_page+'"><i class="icon ion-arrow-right-b"></i></div>';
							_html += '<div class="'+_flag+'" data-page="'+response.page.MAX_PAGE+'"><i class="icon ion-arrow-right-a"></i></div>';
							//$("#comment_box #comment_load").after('<div class="page_navigation">'+_html+'</div>');
							$('.comment_more').remove();
							/*
							// 더보기 누를때마다 댓글을 가져오는 부분
							// 더보기 버튼 형식에서 자동스크롤로 변경됨에 따라 주석처리 - ssChoi
							if(_page > g_page){
								$("#comment_box #comment_load").after(`
                                <div style="padding-bottom:5px;">
                                    <div class="comment_more" onclick="comment_more_function();" style="
                                    text-align: center;
                                    border: 1px solid #DDDDDD;
                                    font-size: 14px;
                                    max-width: 200px;
                                    margin: 15px auto;
                                    padding: 5px 0;
                                    border-radius: 40px;
                                    cursor: pointer;
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                    color: #000;
                                    ">
                                        댓글 더보기 <i class="icon ion-ios-arrow-down" style="font-size: 26px;margin-left: 5px;"></i>
                                    </div>
                                </div>
                                `);
							}else{
								$("#comment_box #comment_load").after(`
                                    <div class="comment_more" style="
                                    text-align: center;
                                    border: 1px solid #DDDDDD;
                                    font-size: 14px;
                                    max-width: 200px;
                                    margin: 15px auto;
                                    padding: 12px 0;
                                    border-radius: 40px;
                                    color: #000;
                                    ">
                                        더이상 댓글이 없습니다.
                                    </div>
                                `);
							}
							*/
						}
					}else{
						if(comment_re_no != 0){
							$("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"'] .option_rr+.line").remove();
							$("#comment_box #comment_load .comment[data-idx='"+comment_re_no+"'] .option_rr").remove();
						}
					}

				} else if(response.status == '401') {
					if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
						location = "/page/login";
					}
				} else {
					alert(response.errmsg);
				}
			},
			complete: function(){
				if(comment_re_no == 0){
					//$('#comment_box').stop().animate({ scrollTop: 0 }, 500);
				}
				$('.loader').remove();
				if($.cookie('VIEWER_REPLY') == 'ON') {
					$("#comment_box .reply_all_toggle").addClass("active");
					$("#comment_box .reply_all_toggle").find('i').removeClass('ion-ios-arrow-down');
					$("#comment_box .reply_all_toggle").find('i').addClass('ion-ios-arrow-up');
					$("#comment_box #comment_load .option_rr > i").removeClass('ion-ios-arrow-down');
					$("#comment_box #comment_load .option_rr > i").addClass('ion-ios-arrow-up');
					$("#comment_box #comment_load .comment_re").stop().slideUp(0);
				}
				if($.cookie('DARKMODE') == 1) {
					$("#comment_box").css("filter", "invert(1)");
					$("#comment_load img").css("filter", "invert(1)");
					// $("#comment_box #comment_load .user_img > img").css("filter", "invert(1)");
				}else{
					$("#comment_box").css("filter", "");
					$("#comment_load img").css("filter", "");
					// $("#comment_box #comment_load .user_img > img").css("filter", "");
				}
				g_isVisible=false;
				g_commentload = true;
			}
		});
	}

	// 댓글 리스트 정렬
	function get_comment_sort(sort_key) {
		$('#comment_load').html("<div style='width:100%;height:50px;line-height:50px;text-align:center;'> 댓글을 불러오고 있습니다 </div>");
		$.cookie('COMMENT_SORT', sort_key, { expires: 365, path: '/', domain: '.novelpia.com', secure: false });
		g_comment_cnt = 0; // count init
		get_sort_filter();
		get_comment_load();
	}

	// 이미지 url > emoticon_no
	function getImgtoGrpEmt(_this){
		//console.log("getImgtoGrpEmt",_this);
		$.ajax({
			data: {
				mode: 'getImgtoGrpEmt',
				img: _this.attr('src')
			},
			type: "POST",
			url: "/proc/emoticon_openstore/",
			cache: false,
			success: function(data) {
				var t = data.split("|");
				if(t[0] == "OK") {
					let _returnData = $.parseJSON(t[1]);
					if(_returnData[0].emoticon_group_name !== undefined) {
                        if(_returnData.length > 0){
                            _this.next("div").find(".novel_title").text(_returnData[0].emoticon_group_name.replace( /<.*?>/g, ' ' ));
                            _this.next("div").find(".novel_store_btn.stamp_tooltip").remove();
                            _this.next("div").find(".novel_store_btn").data('group', _returnData[0].emoticon_group);
                            _this.next("div").show();
                        }
                    } else if(_returnData[0].stamp_name !== undefined) {
                        if(_returnData.length > 0){
                            _this.next("div").find(".novel_title").text(_returnData[0].stamp_name.replace( /<.*?>/g, ' ' ));
                            _this.next("div").find(".novel_store_btn.emoticon_tooltip").remove();
                            _this.next("div").find(".novel_store_btn").data('idx', _returnData[0].idx);
                            _this.next("div").show();
                        }
                    }
				} else {
					alert(data);
				}
			},
			complete: function(){
				$('.loads').hide();
			}
		});
	}

	// 추천/비추/신고
	function set_board_option(option, value) {
		if(option != "" && value != ""){
			$.ajax({
				url: "/proc/viewer",
				data: {
					"mode" : "set_board_option",
					"option" : option,
					"value" : value,
					"csrf" : "",
					"novel_no" : "310060",
                    "content_no": 3929317,
					"novel_epi_no" : "1",
				},
				type: "POST",
				dataType:"json",
				success: function(response){
					if (response.status == '200') {
						//console.log(response.result);
						if(option == 'comment_vote' || option == 'comment_unvote') {
							let _this = $("#comment_box #comment_load .option_vot[data-idx='"+value+"']");
							_this.find(".comment_vote").text(response.result);
							if(_this.attr("data-vote") == 1){
								_this.attr("data-vote", 0);
							}else{
								_this.attr("data-vote", 1);
							}
						} else if(option == 'comment_bad_vote' || option == 'comment_bad_unvote') {
							let _this = $("#comment_box #comment_load .option_bad[data-idx='"+value+"']");
							_this.find(".comment_bad").text(response.result);
							if(_this.attr("data-vote") == 1){
								_this.attr("data-vote", 0);
							}else{
								_this.attr("data-vote", 1);
							}
						} else if(option == 'comment_report'){
							alert("신고 되었습니다.");
							g_comment_cnt = 0; // count init
							get_comment_load();
						}

					} else if(response.status == '401') {
						if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
							//location = "/page/login";
							$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
							location = "/?login_req=1";
						}
					} else {
						alert(response.errmsg);
					}
				}
			});
		}
	}

	// 댓글/대댓글 insert/update
	function set_commit_comment(_this){
        $('#comment_box .set_commit_comment_btn').prop('disabled', true);
        $('.loads').show(); // 연속으로 엔터나 클릭할때 중복등록 방지를 위해 로딩 삽입

		if(_this != ""){
			let _target = _this.find("input[name='target']").val();
			let _comment_msg = _this.find("textarea[name='comment_msg']").val();
			let _comment_img = _this.find("input[name='comment_img']").val();
			let _episode_no = _this.find("input[name='content_no']").val();
			let _comment_no = _this.find("input[name='comment_no']").val();
			let _comment_re_no = _this.find("input[name='comment_re_no']").val();

			//console.log(_target,_comment_msg,_comment_img,_episode_no,_comment_no,_comment_re_no);
			//return false;

			if(_target == "insert" && _episode_no != "" || _target == "update" && _comment_no != ""){
				$.ajax({
					url: "/proc/viewer",
					data: {
						"mode" : "set_commit_comment",
						"target" : _target,
						"comment_msg" : _comment_msg,
						"comment_img" : _comment_img,
						"episode_no" : _episode_no,
						"comment_no" : _comment_no,
						"comment_re_no" : _comment_re_no,
						"csrf" : ""
					},
					type: "POST",
					dataType:"json",
					success: function(response){
						if (response.status == '200') {
							// comment_box init
							$("#comment_box .emoticon_box").remove();
							_this.find("input[name='target']").val('insert');
							_this.find("textarea[name='comment_msg']").val('');
							_this.find("input[name='comment_img']").val('');
							//_this.find("input[name='content_no']").val(_episode_no); // 초기화 하지 않음
							_this.find("input[name='comment_no']").val('');
							_this.find("input[name='comment_re_no']").val('');

							//console.log(response.result);
							if(_target == "insert"){
								alert("댓글이 입력되었습니다.");
							}else if(_target == "update"){
								alert("댓글이 수정되었습니다.");
							}
							g_comment_cnt = 0; // count init
							$('.more_comment'+g_page).remove();

                            if(response.is_pass_mission === true) {
                                viewer_call_toast_msg('', 2);
                            }

							get_comment_load();
						} else if(response.status == '401') {
							if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
								location = "/page/login";
							}
						} else {
							alert(response.errmsg);
						}
					},
                    complete() {
                        $('.loads').hide();
                        $('#comment_box .set_commit_comment_btn').prop('disabled', false);
                    }


				});
			}
		}
	}

	// 댓글/대댓글 삭제
	function comment_delete_proc(comment_no) {
		//console.log("comment_delete_proc", comment_no);

		if(g_comment_delete == 0) {
			if(confirm('정말 댓글을 삭제하시겠습니까?')) {
				g_comment_delete = 1;
				$.ajax({
					url: "/proc/viewer",
					data: {
						"mode" : "set_delete_comment",
						"comment_no" : comment_no,
						"csrf" : ""
					},
					type: "POST",
					dataType:"json",
					success: function(response){
						if (response.status == '200') {
							//console.log(response.result);
							alert("댓글이 삭제되었습니다.");
							g_comment_cnt = 0; // count init
							$('.more_comment'+g_page).remove();
							get_comment_load();

						} else if(response.status == '401') {
							if(confirm("로그인이 필요합니다.\n로그인 하시겠습니까?")) {
								//location = "/page/login";
								$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
								location = "/?login_req=1";
							}
						} else {
							alert(response.errmsg);
						}
					},
					complete: function(){
						g_comment_delete = 0;
					}
				});
			}
		}
	}

	////////////////////////////////////////////
	/// 모달 ///
	////////////////////////////////////////////

	// 노벨티콘 구매창
	function get_emoticon_modal(target){
		let _this = target;
		if(_this.hasClass("disabled") != true){
			$.ajax({
				data: {
					mode: 'getEmoticon',
					emoticon_group: _this.data('group'),
					novel_no: _this.data('novelno'),
					img: _this.data('img')
				},
				type: "POST",
				url: "/proc/emoticon_openstore/",
				cache: false,
				success: function(data) {
					var t = data.split("|");
					if(t[0] == "OK") {
						let _returnData = $.parseJSON(t[1]);
						//console.log(_returnData);
						if(_returnData.length > 0){
							$.ajax({
								data: {
									mode: 'getIsEmoticonPurchase',
									group: _this.data('group')
								},
								type: "POST",
								url: "/proc/emoticon_openstore/",
								cache: false,
								success: function(data) {
									var t = data.split("|");
									if(t[0] == "OK") {
										let _returnData2 = $.parseJSON(t[1]);
										//console.log(_returnData2);

										$(".novelticon-modal .emoticon-list-wrapper").html('');
										$.each(_returnData, function(i, v){
											if(_returnData[0].state == "3"){
												let _flag = 0;
												$.each(_returnData2, function(i2, v2){
													if(v.idx == v2){
														_flag = 1;
													}
												});
												//console.log(_flag);
												if(_flag == 1){
													$(".novelticon-modal .emoticon-list-wrapper").append('<div><img class="c_inv" src="'+v.emoticon_url+'" alt=""></div>');
												}else{
													if($.cookie('DARKMODE') == 1){
														$(".novelticon-modal .emoticon-list-wrapper").append('<div><img style="filter:invert(1) grayscale(1); opacity: 0.3;" src="'+v.emoticon_url+'" alt=""></div>');
													}else{
														$(".novelticon-modal .emoticon-list-wrapper").append('<div><img style="filter:grayscale(1); opacity: 0.3;" src="'+v.emoticon_url+'" alt=""></div>');
													}
												}
											}else{
												$(".novelticon-modal .emoticon-list-wrapper").append('<div><img class="c_inv" src="'+v.emoticon_url+'" alt=""></div>');
											}
										});

										$(".novelticon-modal .modal-button-wrapper").show();
										$(".novelticon-modal .modal-thumb-wrapper").html('').append('<img class="c_inv" src="'+_returnData[0].emoticon_url+'" alt="">');
										$(".novelticon-modal .modal-desc-wrapper > h3").text(_returnData[0].emoticon_group_name.replace( /<.*?>/g, ' ' ));
                                        $(".novelticon-modal .modal-desc-wrapper > h4").remove();
										$(".novelticon-modal .detail-modal-button").data('state', _returnData[0].state);
										$(".novelticon-modal .detail-modal-button").prop('disabled', false);
										$(".novelticon-modal .detail-modal-button").css('background-color', '#4A32B6');

										if(_returnData[0].state == "2"){
											$(".novelticon-modal .modal-price-box h3").text(_returnData[0].novel_name);
											$(".novelticon-modal .modal-price").css('display', 'inline-block');
											$(".novelticon-modal .modal-price > span").text(_returnData[0].coin);
											if(_returnData2.length > 0){
												$(".novelticon-modal .modal-price-box h3").text('');
												$(".novelticon-modal .modal-price").css('display', 'none');
												$(".novelticon-modal .detail-modal-button").text('구매완료');
												$(".novelticon-modal .detail-modal-button").css('background-color', '#999');
												$(".novelticon-modal .detail-modal-button").prop('disabled', true);
											}else{
												$(".novelticon-modal .detail-modal-button").data('group', _returnData[0].emoticon_group);
												$(".novelticon-modal .detail-modal-button").data('coin', _returnData[0].coin);
												$(".novelticon-modal .detail-modal-button").text('구매하기');
											}
										}else if(_returnData[0].state == "3"){
											$(".novelticon-modal .detail-modal-button").data('group', _returnData[0].emoticon_group);
											$(".novelticon-modal .modal-price-box h3").text('');
											$(".novelticon-modal .modal-price").css('display', 'none');
											$(".novelticon-modal .detail-modal-button").text('노벨티콘 뽑기');
										}else if(_returnData[0].state == "4"){
											$(".novelticon-modal .modal-price-box h3").text('');
											$(".novelticon-modal .modal-price").css('display', 'none');
											$(".novelticon-modal .detail-modal-button").text('멤버십 가입하기');
										}else if(_returnData[0].state == "5"){
											$(".novelticon-modal .modal-price-box h3").text('');
											$(".novelticon-modal .modal-price").css('display', 'none');
											$(".novelticon-modal .detail-modal-button").text('감사합니다');
										}else if(_returnData[0].state == "6"){
											$(".novelticon-modal .modal-price-box h3").text('');
											$(".novelticon-modal .modal-price").css('display', 'none');
											$(".novelticon-modal .detail-modal-button").text('마일리지 구매');
										}else{
											$(".novelticon-modal .modal-price-box h3").text('');
											$(".novelticon-modal .modal-price").css('display', 'none');
											$(".novelticon-modal .modal-button-wrapper").hide();
										}

										$(".novelticon-modal").modal('show');
										//$("#comment_box").animate({scrollTop: 0}, 100);
									} else {
										alert(data);
									}
								},
								complete: function(){
									$('.loads').hide();
									if($.cookie('DARKMODE') == 1) {
										$(".detail-modal-wrapper.c_inv").css("filter", "invert(1)");
										$(".detail-modal-wrapper .c_inv").css("filter", "invert(1)");
									}else{
										$(".detail-modal-wrapper.c_inv").css("filter", "");
										$(".detail-modal-wrapper .c_inv").css("filter", "");
									}
									$(".novelticon-modal .emoticon-list-wrapper").scrollTop(0);
								}
							});
						}
					} else {
						alert(data);
					}
				},
				complete: function(){
					$('.loads').hide();


				}
			});
		}
	}

	function comment_more_function(){
		g_page++;
		get_comment_load();
	}


</script><div style="position:fixed;background-color:#fff;width:100%;right:0px;left:0px;bottom:60px;height:calc(100% - 120px);display:none;overflow-y:scroll;will-change: transform;" id="comment_box">

    <div style="position:relative;max-width:900px;margin:0px auto;">
                

        <br><br><br><br><br><br><br><br><br><br><br>
    </div>
</div>

<script>


    var check_v;
    var check_limit = 0;
    var playAlert;
    var episode_infom = "";
    var first_load = 1;
    var data_load = 0;
    var max_page = 1;
    var this_thumb_flag = 0;
    var this_thumb = '';
    var viewer_paging = localStorage['viewer_paging'];
    const g_content_no = 3929317;


    var novel_data = new Array();
    $.ajax({
        data: { "size": '14', "viewer_paging": viewer_paging },
        type: "POST",
        dataType: "JSON",
        url: "/proc/viewer_data/3929317",
        cache: false,
        success: function(data) {
            var json_m = new Array();

            
            $.each(data.s, function(key, value) {
                var json_t = new Object();
                //json_t.text = CryptoJSAesJson.decrypt(value.text, 'c121186a0a766f986f74b166b5c131f4') + " ";
                json_t.text = value.text;
                json_t.size = 11;
                json_t.align = 'left';
                json_m.push(json_t);
            });

            novel_data = json_m;

            setTimeout(function(){ data_load = 1; novel_drawing(novel_data); }, 10);
        }
    });

    $.fn.howMuchCols = function(){
        return Math.round($(this).find(' :last').position().left - $(this).position().left / $(this).outerWidth()) +1;
    };


    var move_key = 0;
    var this_page = 1;


    

    var window_width = window.innerWidth;
    $(window).resize(function (){
        // 설정창 리사이징 (iphone se)
        if($(window).height() < 562){ $("#option_panel_1").height(380 - (562 - $(window).height())); }else{ $("#option_panel_1").height(380); }
        if($(window).height() < 562){ $("#option_panel_2").height(380 - (562 - $(window).height())); }else{ $("#option_panel_2").height(380); }
        var width_size = window.innerWidth;
        if (window_width != window.innerWidth) {
            window_width = window.innerWidth;
            viewer_display();
        }
    })

    
    


    function check_start_position() {
                if(localStorage['viewer_paging'] == 1) {
            check_v = Math.ceil((parseInt($('#novel_drawing_page_c').scrollLeft()) + $('#novel_drawing_page').find(':last').position().left) / ((parseInt($('#novel_drawing_page_c').width()) + 20)));
            if(check_limit >= 30) {
                $('#novel_text').css("opacity", "1");

            } else if(check_v == 'NaN' || typeof check_v == 'undefined' || check_v == '' || check_v == 1 || max_page == 1) {
                //console.log("check_off");
                check_limit++;

            } else if(parseInt(localStorage['bookmark_' + $('#content_no').val()]) <= 0) {
                //localStorage['view_' + $('#content_no').val()] = 1;

            } else if(max_page < parseInt(localStorage['bookmark_' + $('#content_no').val()])) {
                //localStorage['view_' + $('#content_no').val()] = max_page;

            } else if(max_page == localStorage['bookmark_' + $('#content_no').val()]) {
                first_load = 0;
                //alert("(안내) 이미 끝까지 보신 에피소드 입니다.");
                $('#novel_text').css("opacity", "1");
                // 끝 페이지에 도달했으면 첫 페이지로 이동
                this_page = 1;
                $('#this_page_view').html(this_page);
            } else if(first_load == 1) {
                first_load = 0;
                $('#novel_text').css("opacity", "1");

                page_goto(localStorage['bookmark_3929317']);

                $('#page_navigation').val(localStorage['bookmark_3929317']).change();
            } else {
                $('#novel_text').css("opacity", "1");
            }

        } else {

            //console.log("H : " + $('#novel_text').outerHeight() + " / " + check_limit);

            var currentPercentage = (parseInt(localStorage['bookmark_' + $('#content_no').val()]) / ($("#novel_text").outerHeight() - $("#novel_box").height())) * 100;
            //console.log("H : " + currentPercentage);

            if(check_limit >= 30) {
                $('#novel_text').css("opacity", "1");
            } else if(currentPercentage < 0) {
                check_limit++;
            } else if(currentPercentage > 100) {
                check_limit++;
            } else if(currentPercentage > 98) {
                alert("(안내) 이미 끝까지 보신 에피소드 입니다.");
                $('#novel_text').css("opacity", "1");
                $('#novel_box').animate({ scrollTop: 0 }, 0);
            } else if(first_load == 1) {
                first_load = 0;
                $('#novel_text').css("opacity", "1");
                page_goto(localStorage['bookmark_3929317']);

            } else {
                $('#novel_text').css("opacity", "1");
            }
        }
            }

    if(localStorage['bookmark_3929317'] > 0) {
    } else {
        // if(!localStorage['viewer_paging']) {
        //     $("#novel_box").scrollTop(0);
        // }
        $('#novel_text').css("opacity", "1");
    }

    document.addEventListener('touchstart', handleTouchStart, false);
    document.addEventListener('touchmove', handleTouchMove, false);

    var xDown = null;
    var yDown = null;

</script>

<!-- 상단메뉴바 -->
<div style="position:fixed;background-color:#fff;width:100%;left:0px;right:0px;top:0px;height:60px;box-shadow: 0 1px 4px 0 rgba(0,0,0,0.16);will-change: transform;display:none;" align="center" id="header_bar">

    <div class="menu-top-wrapper">

        <div class="menu-top-left">
            <div class="menu-top-home footer_btn" onclick="pageload('/novel/310060', 1);">
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/home.svg">
            </div>

            <div class="menu-title-wrapper">
                
                                    <span class="menu-top-tag">EP.1</span>
                
                <div class="menu-top-title">
                    0. 튜토리얼                </div>
            </div>
        </div>

        <div class="menu-top-right">
            <div onclick="btn_list2();" class="menu-top-list">
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/list.svg" id="btn_list" class="footer_btn">
            </div>
            <div class="menu-top-like">
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/like.svg" onclick="novel_like_btn();" id="btn_like" class="footer_btn">
            </div>
            <div onclick="btn_theme2();" class="menu-top-setting">
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/setting.svg" id="btn_theme" class="footer_btn">
            </div>
            <div style="position: relative;">
                <!-- 테마박스 -->
                <div style="position: absolute;background-color:#fff;;width:300px;right:0px;top:40px;display:none;box-shadow: 0 1px 4px 0 rgba(0,0,0,0.4);will-change: transform;" id="theme_box">
                    <table style="width:100%;margin:0px 0px;cursor:pointer;">
                        <tr style="line-height:40px;">
                            <td id="btn_panel_1" style="text-align:center;font-size:13px;width:50%;" onclick="$('#option_panel_1').show();$('#option_panel_2').hide();$('#btn_panel_1').css('background-color', '');$('#btn_panel_2').css('background-color', 'rgba(0,0,0,0.2)');">일반설정</td>
                            <td id="btn_panel_2" style="text-align:center;font-size:13px;width:50%;background-color:rgba(0,0,0,0.2);" onclick="$('#option_panel_2').show();$('#option_panel_1').hide();$('#btn_panel_1').css('background-color', 'rgba(0,0,0,0.2)');$('#btn_panel_2').css('background-color', '');">고급설정</td>
                        </tr>
                    </table>
                    <div id="option_panel_1" style="overflow-y: auto;">                        <table style="width:100%;;margin:10px 0px;">
                                                        <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">폰트</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;font-family:auto;" id="font_0_btn" onclick="font_0_btn();" class="font_btn">기본</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;font-family:'Noto Sans KR';" id="font_1_btn" onclick="font_1_btn();" class="font_btn">고딕</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;font-family:'Noto Serif KR';" id="font_2_btn" onclick="font_2_btn();" class="font_btn">명조</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:35px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;font-family:'Yeon Sung';" id="font_3_btn" onclick="font_3_btn();" class="font_btn">연성</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:35px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;font-family:'Jua';" id="font_4_btn" onclick="font_4_btn();" class="font_btn">주아</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">배경색상</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#fff;" id="bg_1_btn" onclick="bg_1_btn();" class="bg_btn"></div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#e3e3e3;" id="bg_2_btn" onclick="bg_2_btn();" class="bg_btn"></div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#fffddb;" id="bg_3_btn" onclick="bg_3_btn();" class="bg_btn"></div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#c4ecbb;" id="bg_4_btn" onclick="bg_4_btn();" class="bg_btn"></div>
                                    <div style="font-size:16px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#717171;color:#fff;" id="bg_5_btn" onclick="bg_5_btn();" class="bg_btn bg_5_btn"><i class="icon ion-settings"></i></div>
                                </td>
                            </tr>
                            <script>

                                function bookmark() {
                                    if(localStorage['bookmark_3929317'] > 0) {
                                        if($.cookie('DARKMODE') == 1) {
                                            $('#bookmark_div').css('color', '#ffffff7a');
                                        } else {
                                            $('#bookmark_div').css('color', '#0000007a');
                                        }
                                        localStorage['bookmark_3929317'] = '';
                                        alert("북마크 해제 되었습니다");
                                    } else {
                                        if($.cookie('DARKMODE') == 1) {
                                            $('#bookmark_div').css('color', 'rgb(117, 242, 70)');
                                        } else {
                                            $('#bookmark_div').css('color', 'rgb(160, 73, 180)');
                                        }
                                        localStorage['bookmark_3929317'] = this_page;
                                        alert("" + this_page + "Page 가 북마크 되었습니다");
                                    }
                                }

                                const pickr1 = Pickr.create({
                                    el: '.bg_5_btn',
                                    theme: 'nano', // or 'monolith', or 'nano'
                                    default: $('#bg_5_btn').css("background-color"),
                                    useAsButton : true,
                                    defaultRepresentation : 'HEX',
                                    swatches: [
                                        'rgba(244, 67, 54, 1)',
                                        'rgba(233, 30, 99, 1)',
                                        'rgba(156, 39, 176, 1)',
                                        'rgba(103, 58, 183, 1)',
                                        'rgba(63, 81, 181, 1)',
                                        'rgba(33, 150, 243, 1)',
                                        'rgba(3, 169, 244, 1)',
                                        'rgba(0, 188, 212, 1)',
                                        'rgba(0, 150, 136, 1)',
                                        'rgba(76, 175, 80, 1)',
                                        'rgba(139, 195, 74, 1)',
                                        'rgba(205, 220, 57, 1)',
                                        'rgba(255, 235, 59, 1)',
                                        'rgba(255, 193, 7, 1)'
                                    ],

                                    components: {

                                        // Main components
                                        preview: true,
                                        opacity: false,
                                        hue: false,

                                        // Input / output Options
                                        interaction: {
                                            hex: true,
                                            rgba: false,
                                            hsla: false,
                                            hsva: false,
                                            cmyk: false,
                                            input: true,
                                            clear: false,
                                            save: true
                                        }
                                    },
                                    i18n: {

                                        // Strings visible in the UI
                                        'ui:dialog': 'color picker dialog',
                                        'btn:toggle': 'toggle color picker dialog',
                                        'btn:swatch': 'color swatch',
                                        'btn:last-color': 'use previous color',
                                        'btn:save': '저장',
                                        'btn:cancel': '닫기',
                                        'btn:clear': '삭제',

                                        // Strings used for aria-labels
                                        'aria:btn:save': 'save and close',
                                        'aria:btn:cancel': 'cancel and close',
                                        'aria:btn:clear': 'clear and close',
                                        'aria:input': 'color input field',
                                        'aria:palette': 'color selection area',
                                        'aria:hue': 'hue selection slider',
                                        'aria:opacity': 'selection slider'
                                    }

                                });

                                pickr1.on('init', instance => {
                                    //console.log('Event: "init"', instance);
                                }).on('show', (color, instance) => {
                                    $('.bg_btn').css("border", "1px solid #333");
                                    $('#bg_5_btn').css("border", "1px solid #999");
                                }).on('change', (color, source, instance) => {
                                    $('#novel_box').css({"background-color": color.toHEXA().toString()}, 'slow');
                                    $('#bg_5_btn').css("background-color", color.toHEXA().toString());
                                }).on('save', (color, source, instance) => {
                                    localStorage['viewer_bg'] = color.toHEXA().toString();
                                    bg_5_btn();
                                    pickr1.hide();
                                });

                            </script>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">글자색상</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#000;" id="color_1_btn" onclick="color_1_btn();" class="color_btn"></div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#e3e3e3;" id="color_2_btn" onclick="color_2_btn();" class="color_btn"></div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#fffddb;" id="color_3_btn" onclick="color_3_btn();" class="color_btn"></div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#c4ecbb;" id="color_4_btn" onclick="color_4_btn();" class="color_btn"></div>
                                    <div style="font-size:16px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;background-color:#e6c6b4;color:#fff;" id="color_5_btn" onclick="color_5_btn();" class="color_btn color_5_btn"><i class="icon ion-settings"></i></div>
                                </td>
                            </tr>
                            <script>
                                const pickr2 = Pickr.create({
                                    el: '.color_5_btn',
                                    theme: 'nano', // or 'monolith', or 'nano'
                                    default: $('#color_5_btn').css("background-color"),
                                    useAsButton : true,
                                    defaultRepresentation : 'HEX',
                                    swatches: [
                                        'rgba(244, 67, 54, 1)',
                                        'rgba(233, 30, 99, 1)',
                                        'rgba(156, 39, 176, 1)',
                                        'rgba(103, 58, 183, 1)',
                                        'rgba(63, 81, 181, 1)',
                                        'rgba(33, 150, 243, 1)',
                                        'rgba(3, 169, 244, 1)',
                                        'rgba(0, 188, 212, 1)',
                                        'rgba(0, 150, 136, 1)',
                                        'rgba(76, 175, 80, 1)',
                                        'rgba(139, 195, 74, 1)',
                                        'rgba(205, 220, 57, 1)',
                                        'rgba(255, 235, 59, 1)',
                                        'rgba(255, 193, 7, 1)'
                                    ],

                                    components: {

                                        // Main components
                                        preview: true,
                                        opacity: false,
                                        hue: false,

                                        // Input / output Options
                                        interaction: {
                                            hex: true,
                                            rgba: false,
                                            hsla: false,
                                            hsva: false,
                                            cmyk: false,
                                            input: true,
                                            clear: false,
                                            save: true
                                        }
                                    },
                                    i18n: {

                                        // Strings visible in the UI
                                        'ui:dialog': 'color picker dialog',
                                        'btn:toggle': 'toggle color picker dialog',
                                        'btn:swatch': 'color swatch',
                                        'btn:last-color': 'use previous color',
                                        'btn:save': '저장',
                                        'btn:cancel': '닫기',
                                        'btn:clear': '삭제',

                                        // Strings used for aria-labels
                                        'aria:btn:save': 'save and close',
                                        'aria:btn:cancel': 'cancel and close',
                                        'aria:btn:clear': 'clear and close',
                                        'aria:input': 'color input field',
                                        'aria:palette': 'color selection area',
                                        'aria:hue': 'hue selection slider',
                                        'aria:opacity': 'selection slider'
                                    }

                                });

                                pickr2.on('init', instance => {
                                    //console.log('Event: "init"', instance);
                                }).on('show', (color, instance) => {
                                    $('.color_btn').css("border", "1px solid #333");
                                    $('#color_5_btn').css("border", "1px solid #999");
                                }).on('change', (color, source, instance) => {
                                    $('#novel_text').css("color", color.toHEXA().toString());
                                    $('#color_5_btn').css("background-color", color.toHEXA().toString());
                                }).on('save', (color, source, instance) => {
                                    localStorage['viewer_color'] = color.toHEXA().toString();
                                    pickr2.hide();
                                });

                            </script>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">글자크기</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:11px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_12_btn" onclick="size_12_btn();" class="size_btn">가</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_14_btn" onclick="size_14_btn();" class="size_btn">가</div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_18_btn" onclick="size_18_btn();" class="size_btn">가</div>
                                    <div style="font-size:16px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_22_btn" onclick="size_22_btn();" class="size_btn">가</div>
                                    <div style="font-size:16px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;"  class="size_btn" onclick="$('#size_display').css('font-size', localStorage['viewer_fontsize'] + 'px');$('#font_size_custom').slideDown();"><i class="icon ion-settings"></i></div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;display:none;" id="font_size_custom">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;"></td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_down_btn" onclick="size_down_btn();" class="size_btn">▼</div>
                                    <div style="font-size:12px;width:115px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_display" class="size_btn">가A</div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="size_up_btn" onclick="size_up_btn();" class="size_btn">▲</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">줄간격(%)</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_130_btn" onclick="line_130_btn();" class="line_btn">130</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_160_btn" onclick="line_160_btn();" class="line_btn">160</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_200_btn" onclick="line_200_btn();" class="line_btn">200</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_250_btn" onclick="line_250_btn();" class="line_btn">250</div>
                                    <div style="font-size:12px;width:35px;height:35px;line-height:32px;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" onclick="$('#line_display').text(localStorage['viewer_fontline'] + '%');$('#line_size_custom').slideDown();" class="line_btn"><i class="icon ion-settings"></i></div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;display:none;" id="line_size_custom">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;"></td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_down_btn" onclick="line_down_btn();" class="line_btn">▼</div>
                                    <div style="font-size:12px;width:115px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_display" class="line_btn"><span></span></div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="line_up_btn" onclick="line_up_btn();" class="line_btn">▲</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">글자두께</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;font-weight:200;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="weight_200_btn" onclick="weight_200_btn();" class="weight_btn">벨</div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;font-weight:300;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="weight_300_btn" onclick="weight_300_btn();" class="weight_btn">벨</div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;font-weight:400;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="weight_400_btn" onclick="weight_400_btn();" class="weight_btn">벨</div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;font-weight:500;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="weight_500_btn" onclick="weight_500_btn();" class="weight_btn">벨</div>
                                    <div style="font-size:14px;width:35px;height:35px;line-height:32px;font-weight:700;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="weight_700_btn" onclick="weight_700_btn();" class="weight_btn">벨</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">다크모드</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="dark_off_btn" onclick="dark_off_btn();" class="dark_btn">미사용</div>
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="dark_on_btn" onclick="dark_on_btn();" class="dark_btn">사용</div>
                                </td>
                            </tr>

                        </table>
                    </div>
                    <div id="option_panel_2" style="display:none; overflow-y: auto;">                        <table style="width:100%;;margin:10px 0px;">
                            
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">일러스트</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="img_off_btn" onclick="img_off_btn();" class="img_btn">감추기</div>
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="img_on_btn" onclick="img_on_btn();" class="img_btn">보이기</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:30%;">뷰어방식</td>
                                <td style="text-align:center;font-size:14px;width:70%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:85px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="viewer_1_btn" onclick="viewer_1_btn();" class="viewer_btn">스크롤 방식</div>
                                    <div style="font-size:12px;width:85px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="viewer_2_btn" onclick="viewer_2_btn();" class="viewer_btn">페이지 방식</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:40%;">페이지 효과</td>
                                <td style="text-align:center;font-size:14px;width:60%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="animation_on_btn" onclick="animation_on_btn();" class="animation_btn">사용</div>
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="animation_off_btn" onclick="animation_off_btn();" class="animation_btn">미사용</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:40%;">정주행 기능</td>
                                <td style="text-align:center;font-size:14px;width:60%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="auto_nextepi_on_btn" onclick="auto_nextepi_on_btn();" class="auto_nextepi_btn">사용</div>
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="auto_nextepi_off_btn" onclick="auto_nextepi_off_btn();" class="auto_nextepi_btn">미사용</div>
                                </td>
                            </tr>
                            <tr style="line-height:40px;">
                                <td style="text-align:right;padding-right:10px;font-size:13px;width:40%;">네비/북마크</td>
                                <td style="text-align:center;font-size:14px;width:60%;display: -webkit-box;padding: 5px;">
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="navigation_on_btn" onclick="navigation_on_btn();" class="navigation_btn">사용</div>
                                    <div style="font-size:12px;width:65px;height:35px;line-height:32px;border:1px solid #ddd;user-select: none;border-radius:5px;text-align:center;padding:0px;cursor:pointer;margin-right:5px;" id="navigation_off_btn" onclick="navigation_off_btn();" class="navigation_btn">미사용</div>
                                </td>
                            </tr>
                            							                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
            <div style="text-align:center;font-size:20px;width:40px;cursor:pointer;border-radius:20px;height:40px;background-color:rgba(155,155,155,0.2);line-height:40px;top:80px;left:calc(50% - 20px);position:absolute;display:none;" onclick="page_up();" id="scroll_up_btn"><i class="icon ion-arrow-up-a"></i></div>
</div>

<!-- 하단메뉴바 -->

<div style="position:fixed;background-color:#fff;;width:100%;left:0px;right:0px;bottom:0px;height:60px;box-shadow: 0 -1px 4px 0 rgba(0,0,0,0.16); user-select:none;display:none;" id="footer_bar" align="center">
    <div class="menu-bottom-wrapper">
                    <div class="menu-bottom-item">
                <img src="//images.novelpia.com/img/new/viewer/navbar/prev_none.svg" class="footer_btn">
                <span class="epi-menu-none footer_btn">이전화</span>
            </div>
        
        <div class="menu-bottom-item" onclick="location.href='/mybook/last_view'">
            <img src="//images.novelpia.com/img/new/viewer/navbar/v2/recent.svg" class="footer_btn">
            <span class="footer_btn">최근기록</span>
        </div>
        
        
                <div id="recommend_tap">
            <div class="menu-bottom-item" id="menu-bottom-item" @click="add_recommend">
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/recommend_on.svg" id="btn_episode_vote" class="footer_btn" style="margin-top:2px;">
                <span id="btn_episode_text" class="footer_btn vote_btn">추천<span class="epi-comment-cnt">(3)</span></span>
            </div>
            <component :is="cancelModal" @reset_component="reset_component" v-if="cancelModalShow" @cancel_recommend="cancel_recommend" @open_toast="open_toast"></component>
        </div>

                    <div class="menu-bottom-item" onclick="btn_comment2();">
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/comment.svg" id="btn_comment" class="footer_btn">
                <span class="footer_btn ">
                댓글
            </span>
            </div>
            
        <!--            <div class="menu-bottom-item menu-next-item" onclick="pageload('/viewer///', 1);">-->
                <div class="menu-bottom-item menu-next-item" onclick="check_next_episode_link('3930273')">
                <span class="footer_btn">다음화</span>
                <img src="//images.novelpia.com/img/new/viewer/navbar/v2/next.svg" class="footer_btn">
            </div>
        
    </div>

    <div style="text-align:center;font-size:20px;width:40px;cursor:pointer;border-radius:20px;height:40px;background-color:rgba(155,155,155,0.2);line-height:40px;bottom:80px;;left:calc(50% - 20px);position:absolute;display:none;" onclick="page_down();" id="scroll_down_btn"><i class="icon ion-arrow-down-a"></i></div>

    </div>

<div id="i-am-progress-indicator"></div>

<div id="back_info_layer" style="display:none;position:fixed;top:calc(50% - 40px);width:240px;border-radius:10px;left:calc(50% - 120px);background-color:rgba(100,100,100,0.3);font-size:12px;text-align:center;padding:5px 0px;;box-shadow: 0 1px 4px 0 rgba(0,0,0,0.4);">한번 더 누르면 이전화로 이동합니다</div>

<div id="next_info_layer" style="display:none;position:fixed;top:calc(50% - 40px);width:240px;border-radius:10px;left:calc(50% - 120px);background-color:rgba(100,100,100,0.3);font-size:12px;text-align:center;padding:5px 0px;;box-shadow: 0 1px 4px 0 rgba(0,0,0,0.4);">한번 더 누르면 다음화로 이동합니다</div>


</div>

<!-- 좋아요 버튼 효과 -->
<link rel="stylesheet" href="/css/viewer_animation_ver2.css?tmp=1">
<script>
    // tts obj set
    tts_obj = {"agent":"WEB","app_version":0,"agent_origin":"axios\/1.7.7","name":"\ud55c\uad6d \uba78\ub9dd \ud6c4 100\ub144\uc774 \ud758\ub800\uc2b5\ub2c8\ub2e4","title":"0. \ud29c\ud1a0\ub9ac\uc5bc","ep":"1","thumb":"\/imagebox\/cover\/2cee947e7b165d4dcba1f26cdf1b5114_22741_ori.file","next_content":"3930273","novel_no":"310060","content_no":"3929317"};

    function like_animation() {
        var bubble, moveChar;
        console.log('ani');

        $(".move_animation").css('animation-play-state', 'running');
        $(".vote_btn").addClass('animate');
        $(".move_animation").addClass('move_item');
        bubble = setTimeout(function(){
            $(".vote_btn").removeClass('animate');
        }, 1000);
        moveChar = setTimeout(function(){
            $(".move_animation").removeClass('move_item');
        }, 2500);
    }

    if (["GOOGLE", "IOS"].includes(get_device())) {
        if ( ! localStorage['tts_btn']) {
            localStorage['tts_btn'] = 'on'    
        }
    } else {
        localStorage['tts_btn'] = 'off'
    }
</script>

<script>
    let toggle_navi_lock = 0;
    let toggle_navi_animate_lock = 0;

    
    let toggle_navi = 1;
    $("#comment_box").scroll(function(){
        up_down_btn_view('on');

    });

    let lastScroll = 0;//직전 스크롤 값
    let no_next_epi =  false;//다음화알림 체크
    $("#novel_box").scroll(function(){

        $('#scroll-btn').hide();
        const currentPercentage = ($("#novel_box").scrollTop() / ($("#novel_text").outerHeight() - $("#novel_box").height())) * 100;
        $('#i-am-progress-indicator').width(currentPercentage+'%');

        up_down_btn_view('on');

        if(localStorage['viewer_paging'] == 1) {
            //localStorage['bookmark_3929317'] = this_page;
            $('#page_navigation').val(this_page).change();

            const arr_page_data = localStorage.getItem("bookmark_3929317");
            if(arr_page_data==this_page){
                if($.cookie('DARKMODE') == 1) {
                    $('#bookmark_div').css('color', 'rgb(117, 242, 70)');
                } else {
                    $('#bookmark_div').css('color', 'rgb(160, 73, 180)');
                }
            }
            else {
                if($.cookie('DARKMODE') == 1) {
                    $('#bookmark_div').css('color', '#ffffff7a');
                } else {
                    $('#bookmark_div').css('color', '#0000007a');
                }
            }
        } else {
            this_page = Math.round($("#novel_box").scrollTop() / $('#novel_box').innerHeight()) + 1;

            const arr_page_data = localStorage.getItem("bookmark_3929317");
            if(arr_page_data==this_page){
                if($.cookie('DARKMODE') == 1) {
                    $('#bookmark_div').css('color', 'rgb(117, 242, 70)');
                } else {
                    $('#bookmark_div').css('color', 'rgb(160, 73, 180)');
                }
            }
            else {
                if($.cookie('DARKMODE') == 1) {
                    $('#bookmark_div').css('color', '#ffffff7a');
                } else {
                    $('#bookmark_div').css('color', '#0000007a');
                }
            }

            $('#this_page_view').html(this_page);

            //console.log(($("#novel_box").scrollTop() + $('#novel_box').innerHeight()) + "/" + $("#novel_text").outerHeight());
            if(($("#novel_box").scrollTop() + $('#novel_box').innerHeight()) >= $("#novel_text").outerHeight() - 100) {
                //localStorage['bookmark_3929317'] = this_page;
            } else if($("#novel_box").scrollTop() != 0) {
               const allheight = $("#novel_text").outerHeight();
               const check = check_login_popup();
              if(($("#novel_box").scrollTop() >= allheight/2) && (check == 1)){
                   $('#member_join_modal, #member_login_modal').css('background', 'linear-gradient(0deg, rgba(0,0,0,1) 15%, rgba(255,255,255,0) 100%)');
                   $('#member_join_modal, #member_login_modal').css('touch-action', 'none');
                   $('#novel_box').css('overflow','hidden');
                   $('#novel_box').scrollTop(allheight/2);

                   if($.cookie('FID')) {
                       $('#join_fid').val($.cookie('FID'));
                   } else {
                       $('.friend-code-input').hide();
                   }

                   $("#member_join_modal").show();

                   $(".basic-modal-close").click(function (){
                      // location = "/novel/310060";
                       $("#novel_box").scrollTop(0);
                      // return false;
                   });
                }

                if(toggle_navi_animate_lock == 0) {
                    $('#page_navigation').val(this_page).change();
                }
                //localStorage['bookmark_3929317'] = this_page;
            }




            //console.log(this_page);

                        updateMark();
        }

        if($('#member_join_modal, #member_login_modal, .curation-wrapper').css('display') == 'block'){
            $('body').addClass('scrollDisable').on('scroll touchmove mousewheel', function(e){
                return false;
            });
        }

        function check_login_popup(){//그라데이션 조건
            if(Number(0) === 1){
                return 1;
            }

            return 0;
        }


        //console.log("t : " + currentPercentage + " / n : " + $("#novel_box").scrollTop());

            const nowScroll = $(this).scrollTop();//지금 스크롤
            if (currentPercentage >= 99.9 && nowScroll > 1000 && nowScroll > lastScroll) {
                if (localStorage['viewer_nextepi'] == 'on' && $('#next_epi_auto_url').val() != '') {
                    if ($('#content_no_next').val() > 0) {
                        // 정주행 방해되지 않도록
                        // localStorage['bookmark_' + $('#content_no_next').val()] = 1;
                    }
                    pageload($('#next_epi_auto_url').val(), 1);
                } else if (localStorage['viewer_nextepi'] == 'on' && !no_next_epi) {
                    no_next_epi = true;
                    alert("다음 등록 된 회차가 없습니다.");
                }
            } else if (currentPercentage < 10) {
                $('#scroll_up_btn').hide();
            }
            else {
                no_next_epi = false;
            }
            lastScroll = nowScroll;

        if(toggle_navi == 0 && ($('#btn_theme').attr('src') == '/img/new/viewer/btn_theme.png') && $('#btn_comment').attr('src') != '//images.novelpia.com/img/new/viewer/navbar/v2/comment_on.svg' && toggle_navi_lock == 0) {
            $('#footer_bar').hide();
            $('#header_bar').hide();
            $('#theme_box').hide();
            $('#float-menu').hide();
            //console.log("scroll - off");
            up_down_btn_view('off');
            toggle_navi = 1;
        }
    });



    // 초기값 설정
    try
    {
        if(localStorage['viewer_font'] == 'NaN' || typeof localStorage['viewer_font'] == 'undefined' || localStorage['viewer_font'] == '') {
            localStorage['viewer_font'] = '1';
        }
        if(localStorage['viewer_fontsize'] == 'NaN' || typeof localStorage['viewer_fontsize'] == 'undefined' || localStorage['viewer_fontsize'] == '') {
            localStorage['viewer_fontsize'] = 18;
        }
        if(localStorage['viewer_fontline'] == 'NaN' || typeof localStorage['viewer_fontline'] == 'undefined' || localStorage['viewer_fontline'] == '') {
            localStorage['viewer_fontline'] = 200;
        }
        if(localStorage['viewer_bg'] == 'NaN' || typeof localStorage['viewer_bg'] == 'undefined' || localStorage['viewer_bg'] == '') {
            localStorage['viewer_bg'] = 1;
        }
        if(localStorage['viewer_weight'] == 'NaN' || typeof localStorage['viewer_weight'] == 'undefined' || localStorage['viewer_weight'] == '') {
            localStorage['viewer_weight'] = 400;
        }
        // 플로팅 관련 변수
        if(typeof localStorage['viewer_float'] == 'undefined'){
            localStorage['viewer_float'] = 'on';
        }
        if(typeof localStorage['viewer_float_position'] == 'undefined'){
            localStorage['viewer_float_position'] = 'right';
        }

    }
    catch (e)
    {
        localStorage['viewer_weight'] = 400;
        localStorage['viewer_font'] = '1';
        localStorage['viewer_fontsize'] = 18;
        localStorage['viewer_fontline'] = 200;
        localStorage['viewer_float'] = 'on';
        localStorage['viewer_float_position'] = 'right';
    }


    if(window.addEventListener) {
        window.addEventListener("hashchange", function() {
            if(location.hash == '#comments') {
                btn_comment_on();
                $('#float-menu').hide();
            } else if(location.hash == '#lists') {
                btn_list_on();
                $('#float-menu').hide();
            } else {
                btn_comment_off();
                btn_list_off();
                $('#float-menu').show();
            }
        }, false);
    } else if(window.attachEvent) {
        this.beforeHash = location.hash;
        setInterval(function() {
            if(beforeHash === location.hash) {
                return;
            }
            if(location.hash == '#comments') {
                btn_comment_on();
                $('#float-menu').hide();
            } else if(location.hash == '#lists') {
                btn_list_on();
                $('#float-menu').hide();
            } else {
                btn_comment_off();
                btn_list_off();
                $('#float-menu').show();
            }
            beforeHash = location.hash;
        }, 500);
    }

    if(location.hash == '#comments') {
        btn_comment_on();
        $('#float-menu').hide();
    } else if(location.hash == '#lists') {
        btn_list_on();
        $('#float-menu').hide();
    } else {
        btn_comment_off();
        btn_list_off();
        $('#float-menu').hide();
    }
        if(localStorage['viewer_paging'] == 1 && location.hash != '#comments') {
        //console.log("viewer_paging - off");
        up_down_btn_view('off');
    }
    
        viewer_display();



</script>
<div id="load_alert"></div>
<input type="hidden" id="comment_page" value="1">

<!-- BASIC MODAL -->
<!-- <div id="modaldemo1" class="modal fade s_inv">
  <div class="modal-dialog modal-dialog-vertical-center" role="document"  style="min-width: 300px;
max-width: 300px;
top: calc(50% - 200px);
position: fixed;
left: calc(50% - 160px);">
	<div class="modal-content bd-0 tx-14">
	  <div class="modal-header pd-y-20 pd-x-25">
		<h6 class="tx-14 mg-b-0 tx-uppercase tx-inverse tx-bold">Plus 멤버십 가입</h6>
		<button type="button" class="close" data-dismiss="modal" aria-label="Close">
		  <span aria-hidden="true">&times;</span>
		</button>
	  </div>
	  <div style="margin:0px 20px;">
		<h4 class="lh-3"><a href="" class="tx-inverse hover-primary" style="font-weight: 800;font-size: 20px;">월 9,900원 정기결제</a></h4>
		<p class="mg-b-5 plus_check1" >
- 해당 상품은 출판물로 면세항목을 적용 받습니다.<br>
- 본 결제는 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.<br>
- 휴대전화, ARS 결제 취소는 당월 결제건에 한해서 가능합니다.<br>
- 결제가 완료되기 전에 결제창을 닫으면 결제가 완료되지 않을 수 있습니다.<br>
- 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.
	</p>
	  </div>
	  <div class="modal-footer" style="display: block;line-height: 50px;text-align: center;padding:0px;">
	  <img src="/img/new/plus/check.png" style="cursor:pointer;" onclick="$('#plus_check1').hide();$('.plus_check1').hide();$('#goods1_box').show();" id="plus_check1">
	  <div style="display:none" id="goods1_box">

		<button type="button" class="btn" style="cursor:pointer;border: 1px solid #fbbf25;border-radius: 30px;background-color: #fbbf25;width: 275px;color: #333;font-weight: 700;line-height: 23px;margin:0px 5px 10px 5px;" onclick="window.open('/proc/kakaopay2_call/1/viewer_3929317', '_blank', 'width=500,height=600');"><img src="/img/new/icon/payment/kakao2.png" style="    height: 18px;vertical-align: sub;"> </button>
	<button type="button" class="btn" style="cursor:pointer;border: 1px solid #ddd;border-radius: 30px;background-color: #fff;width: 130px;color: #333;font-weight: 700;line-height: 23px;margin:0px 4px 20px 4px;" onclick="window.open('/proc/payjoa_auto/mobile-batch/1/viewer_3929317' , '_blank', 'width=500,height=600');"><img src="/img/new/icon/payment/mobile2.png" style="height: 22px;vertical-align: text-top;margin-right:2px;">휴대폰&nbsp; </button>
	<button type="button" class="btn" style="cursor:pointer;border: 1px solid #ddd;border-radius: 30px;background-color: #fff;width: 130px;color: #333;font-weight: 700;line-height: 23px;margin:0px 4px 20px 4px;" onclick="window.open('/proc/payjoa_card_auto/card-batch/1/viewer_3929317', '_blank', 'width=500,height=600');"><img src="/img/new/icon/payment/card2.png" style="    height: 22px;vertical-align: text-top;"> 신용카드&nbsp; </button>



	</div>
	  </div>
	</div>
  </div> -->
<!-- modal-dialog -->
<!-- </div> -->
<!-- modal -->

<!-- BASIC MODAL -->
<div id="modaldemo1" class="modal s_inv">
    <div class="modal-dialog modal-dialog-vertical-center" role="document"  style="min-width: 300px;
max-width: 300px;
top: 80px;
position: fixed;
left: calc(50% - 160px);">
        <div class="modal-content bd-0 tx-14">
            <div class="modal-header pd-y-20 pd-x-25" style="border: 1px solid #ddd;border-radius: 10px 10px 0 0;align-items: center;">
                <h6 class="tx-14 mg-b-0 tx-uppercase tx-inverse tx-bold" style="margin-bottom: 0;">
                    <img src="/img/new/plus/ico_plus_01.png" style="">
                    플러스 멤버십 가입
                </h6>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" style="color:#000;">&times;</span>
                </button>
            </div>
            <div style="padding: 20px;border-right: 1px solid #ddd;border-left: 1px solid #ddd;">
                <h4 class="lh-3" style="text-align: center;margin-bottom: 10px;"><a href="" class="tx-inverse hover-primary" style="font-weight: 800;font-size: 20px;">월 9,900원 정기구독</a></h4>
                <p class="mg-b-5 plus_check1" style="font-size: 12px;line-height: 22px;">
                    - 해당 상품은 출판물로 면세항목을 적용 받습니다.<br>
                    - 본 결제는 30일단위로 이용권이 지급되며, 하루 전 (29일째) 자동결제 됩니다.<br>
                    - 휴대전화, ARS 결제 취소는 당월 결제건에 한해서 가능합니다.<br>
                    - 결제가 완료되기 전에 결제창을 닫으면 결제가 완료되지 않을 수 있습니다.<br>
                    - 각 할인 혜택은 사전 예고 없이 종료될 수 있습니다.
                </p>
            </div>
            <div class="modal-footer" style="display: block;line-height: 50px;text-align: center;border: 1px solid #ddd;border-top: none;border-radius: 0 0 20px 20px;padding: 0px 20px 20px 20px;">
                <!-- <img src="/img/new/plus/check.png" style="cursor:pointer;" onclick="$('#plus_check1').hide();$('.plus_check1').hide();$('#goods1_box').show();" id="plus_check1"> -->
                <button style="cursor:pointer;font-size: 13px;color: #FFF;background-color: #5232dd;width: 100%;border-radius: 20px;white-space: nowrap;border:none;" onclick="$('#plus_check1').hide();$('.plus_check1').hide();$('#goods1_box').show();" id="plus_check1">구독 안내사항에 동의합니다</button>
                <div style="display:none;margin-left:none;" id="goods1_box">

                    <button type="button" class="settle_mobile_pay" style="cursor:pointer;border: 1px solid #ddd;border-radius: 30px;background-color: #fff;width: 100%;color: #333;font-weight: 700;line-height: 23px;margin-bottom:10px;" ><img src="/img/new/icon/payment/mobile2.png" style="height: 22px;vertical-align: text-top;margin-right:2px;">휴대폰&nbsp; </button>

                    <button type="button" class="settle_card_pay" style="cursor:pointer;border: 1px solid #ddd;border-radius: 30px;background-color: #fff;width: 100%;color: #333;font-weight: 700;line-height: 23px;margin-bottom:10px;" ><img src="/img/new/icon/payment/card2.png" style="    height: 22px;vertical-align: text-top;"> 신용카드&nbsp; </button>

                    <button type="button" class="btn" style="cursor:pointer;border: 1px solid #00c73c;border-radius: 30px;background-color: #00c73c;width: 100%;color: #333;font-weight: 700;line-height: 23px;margin-bottom:10px;" onclick="window.open('https://pay.novelpia.com/pay/naver/step1?goods=1&site=novelpia', '_blank', 'width=750,height=900');"><img src="/img/new/icon/payment/naver3.png" style=" height: 18px;vertical-align: sub;"></button>

                    <button type="button" class="btn" style="cursor:pointer;border: 1px solid #fbbf25;border-radius: 30px;background-color: #fbbf25;width: 100%;color: #333;font-weight: 700;line-height: 23px;margin-bottom:10px;" onclick="window.open('/proc/kakaopay2_call/1/viewer_3929317', '_blank', 'width=500,height=600');"><img src="/img/new/icon/payment/kakao2.png" style="    height: 18px;vertical-align: sub;"> </button>
                    <span style="display:flex;">


    </span>


                </div>
            </div>
        </div>
    </div><!-- modal-dialog -->
</div><!-- modal -->



<!-- 노벨티콘 레이어 팝업 -->
<div class="novelticon-modal">
    <div class="detail-modal-wrapper c_inv">
        <div class="detail-modal-top">
            <div>
                <img class="c_inv" src="/img/new/logo2.png" alt="" title="coin" />
            </div>
            <div id="detail-modal-close">
                <img src="/img/new/openstore/cancel.png" />
            </div>
        </div>
        <div class="modal-deco-line"></div>
        <div class="modal-content-wrapper">
            <div class="modal-thumb-wrapper">
                <!-- 대표 이모티콘 -->
            </div>
            <div class="modal-desc-wrapper">
                <div class="modal-price-box">
                    <h3><코인> 골드 코인</h3>
                    <div class="modal-price">
                        <img class="coin-img c_inv" src="/img/new/event/novelfund/coin.png" alt="디테일 코인 이미지" title="coin" />
                        <span><코인></span>
                    </div>
                </div>
                <h3><그룹명></h3>
                <h4><작품명></h4>
                <p class="modal-desc mobile_hidden">
                    이모티콘 구매에 대한 철회 및 환불은 유료서비스 이용약관 및 콘텐츠산업진흥법의 기준에 따른답니다.
                </p>
            </div>
        </div>
        <div class="modal-desc detail-mobile mobile_show">
            이모티콘 구매에 대한 철회 및 환불은 유료서비스 이용약관 및 콘텐츠산업진흥법의 기준에 따른답니다.
        </div>
        <div class="modal-deco-line"></div>

        <div class="emoticon-list-wrapper">
            <!-- 이모티콘 리스트 -->
        </div>
        <div class="modal-button-wrapper">
            <div class="detail-modal-button" data-group="" data-coin="">구매하기</div>
        </div>
    </div>
</div>



<script>
    (async function () {
        let sec = 0 ;
        await fn_novel_reading_time();
        setInterval(()=> {
            sec++;
            sessionStorage.setItem("read_time", sec );
        }, 1000);
    })();
</script>

<script>
    function payment_modal(){
        $.cookie("induce_flag_type","22", { expires: 1, path: "/", domain: "novelpia.com", secure: false });
        // $('.modal_override').show();
        // $('#novel_drawing').hide();
        $('#payment_app').show();
	//	$('#sub_sale_modal').show();
    }
    $('.modal_close').click(function(){
        const content_text = $('#novel_drawing').text();
        const content_length = content_text.length;
        if(content_text.length == 0){
            location.href="/novel/310060?login_req=1";
        }else{
            $('.modal_override').hide();
            $('#novel_drawing').show();
        }
    });

    function login_req(novel_no){
        if(confirm("로그인이 필요합니다.")){
            location.href="/novel/"+novel_no+"?login_req=1";
        }

    }
</script>

<script type="module">
    import recommend_cancel_component from '/js/component/viewer/recommend_cancel_component.js';
    import recommend_toast_component from '/js/component/viewer/recommend_toast_component.js';

    const components = new Vue({
        el: "#components",
        components: {
            recommend_toast_component,
        },
        data: {
            recommendToast: '',
            toastType: '',
            toastShow: false,
        },
        methods: {
            open_modal: function (type) {
                this.recommendToast = 'recommend_toast_component';
                this.toastType = type;
            },
        },
    })

    const recommend_button = new Vue({
        el: '#recommend_tap',
        data: function () {
            return {
                contentNo: document.getElementById('content_no').value,
                csrf: document.getElementById('csrf').value,
                cancelModal: "",
                count: '',
                recommendToast: '',
                toastType: '',
                cancelModalShow: false,
            }
        },
        components: {
            recommend_cancel_component,
        },
        methods: {
            add_recommend: async function () {
                this.reset_component();
                const url = '/proc/board_option';
                const data = {
                    option: 'add_vote_novel',
                    value: this.contentNo,
                    csrf: this.csrf,
                }

                const httpResult = await http("post", url, data);

                this.count = httpResult.count;

                const {errmsg, bingo_complete} = httpResult;

                if(errmsg === 'error') {
                    this.cancelModal = 'recommend_cancel_component';
                    this.cancelModalShow = true;
                    return;
                }

                if(errmsg === 'login') {
                    if(confirm("추천을 위해서는 로그인이 필요합니다. \n로그인 하시겠습니까?")) {
                        location = "/page/login"
                    }
                } else if(errmsg === 'plus') {
                    alert('PLUS 적용 회차는 PLUS 이용자만 추천이 가능합니다');
                    return false;
                } else if(errmsg === 'bad_request') {
                    alert('잘못된 접근입니다.');
                    return false;
                }

                if(bingo_complete){
                    viewer_call_toast_msg2(0);
                }
                like_animation();
                $('#btn_episode_vote').attr("src", "//images.novelpia.com/img/new/viewer/navbar/v2/recommend_on.svg");
                $('#btn_episode_text').html('추천<span class="epi-comment-cnt">('+this.count+')</span>');
                $('#btn_episode_text').css("color", "#7632FF");
            },
            cancel_recommend: async function () {
                this.reset_component();

                const url = '/proc/board_option';
                const data = {
                    option: 'remove_vote_novel',
                    value: this.contentNo,
                    csrf: this.csrf,
                }

                const httpResult = await http("post", url, data);

                const {count, errmsg, status } = httpResult;

                this.count = count;

                if(errmsg === 'login') {
                    if(confirm("추천을 위해서는 로그인이 필요합니다. \n로그인 하시겠습니까?")) {
                        location = "/page/login"
                    }
                } else if(errmsg === 'bad_request') {
                    alert('잘못된 접근입니다.')
                    return false;
                }

                $('#btn_episode_vote').attr("src", "//images.novelpia.com/img/new/viewer/navbar/v2/recommend.svg");
                $('#btn_episode_text').html('추천<span class="epi-comment-cnt">('+this.count+')</span>');
                $('#btn_episode_text').css("color", "#000");
            },
            reset_component: function () {
                components.recommendToast = '';
                this.cancelRecommendModal = '';
                this.cancelModalShow = false;
                components.toastShow = false;
            },
            open_toast: function (type) {
                components.recommendToast = 'recommend_toast_component';
                this.cancelModalShow = false;
                components.toastType = type;
                components.toastShow = true;
            },
        },
        mounted: async function () {
        },
    });
</script>
<script>
    gtag('event', '웹소설_뷰어유입', {'event_name' : 'view_viewer', 'content_id' : 'coin' , 'content_id' : '3929317'});
</script>
<script src='/js/nvsc.min.js?v=1728871305' type='text/javascript' ></script></div>
<script>
</script>
<style>
    /*옴니고딕*/
@font-face {
    font-family: 'OmniGothic';
    src: url('//images.novelpia.com/img/new/million_class_fonts/OmniGothic30.woff2') format('woff2');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'OmniGothic';
    src: url('//images.novelpia.com/img/new/million_class_fonts/OmniGothic40.woff2') format('woff2');
    font-weight: 400;
    font-style: normal;
}

@font-face {
    font-family: 'OmniGothic';
    src: url('//images.novelpia.com/img/new/million_class_fonts/OmniGothic50.woff2') format('woff2');
    font-weight: 500;
    font-style: normal;
}
    .basic-modal-close-no-member{
        display: block;
        width: 27px;
        height: 27px;
        background: url(//images.novelpia.com/old/img/new/menu/menu_close.png) no-repeat center;
        background-size: 32px;
        cursor: pointer;
        position: absolute;
        right: 10px;
        top: 10px;
    }
    .no-member-popup-container{
        font-family: 'NanumSquare';
        position: fixed;
        top:50%;
        left:50%;
        transform: translate(-50%, -50%);
        color: #fff;
        z-index: 9999;
        font-size: 14px;
        display: none;
    }
    .no-member-popup-container-background{
        position: fixed;
        top: 0px;
        left:0px;
        width: 100%;
        height: 100%;
        background-color: #000;
        opacity: 0.5;
        z-index: 9998;
        display: none;
    }
    .no-member-popup-container .suggest-popup-item{
        background-color: #fff;
        display: flex;
        justify-items: center;
        align-items: center;
        flex-direction: column;
        gap: 20px;
        max-width: 540px;
        width: 100%;
        padding: 35px;
        position: relative;
    }
    .welcome-blue{
        color: #005AD2;
    }
    .suggest-popup-item .main-title{
        font-size: 1.875rem;
        color: #000;
        font-weight: bold;
    }
    .suggest-popup-item .kawai-novel{
        max-width: 540px;
        width: 100%;
    }
    .suggest-popup-item .sub-text{
        font-family: 'OmniGothic', 'NanumSquareNeo-Variable', 'Apple SD Gothic Neo', sans-serif;
        font-size: 1.5rem;
        color: #000005;
        font-weight: 400;
        text-align: center;
    }
    .sub-text span{
        color: #6437FF;
    }
    .suggest-popup-item .sub-text-two{
        font-family: 'OmniGothic', 'NanumSquareNeo-Variable', 'Apple SD Gothic Neo', sans-serif;
        font-size: 1.1rem;
        color: #575757;
    }

    .no-member-popup-wrapper .btn-wrapper{
        display: flex;
        justify-items: center;
        align-items: center;
    }
    .no-member-popup-wrapper .move-btn{
        font-family: 'OmniGothic', 'NanumSquareNeo-Variable', 'Apple SD Gothic Neo', sans-serif;
        background-color: #201A74;
        color: #fff;
        text-align: center;
        font-size: 1.375rem;
        padding: 30px 0;
        cursor: pointer;
        width: 100%;
    }
    #suggestContentPopup .novel-img{
        max-width: 150px;
        width: 100%;
    }
    .recommend-botton-section button {
        font-family: 'OmniGothic', 'NanumSquareNeo-Variable', 'Apple SD Gothic Neo', sans-serif;
        text-align: center;
        width: 100%;
        height: 50px;
        cursor: pointer;
        border: 0;
        font-size: 16px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .recommend-botton-section{
        font-family: 'OmniGothic', 'NanumSquareNeo-Variable', 'Apple SD Gothic Neo', sans-serif;
        margin-top: 25px;
        display: flex;
        gap: 5px;
        justify-content: space-between;
        width: 100%;
    }
    .recommend-botton-section button.color-wt{
        background:#fff;
        color: #000;
        border:1px solid #000;
        height: 70px;
    }
    .recommend-botton-section button.color-bk{
        background:#000;
        color: #fff;
        height: 150px;
		padding: 0px;
		outline:none;
    }
    .recommend-botton-section button.color-bl{
        background:#0055e1;
        color: #fff;
        height: 70px;
    }
@media screen and (max-width: 891px) {
    .suggest-popup-item .main-title{
        font-size: 20px;
        font-weight: bold;
    }
    .suggest-popup-item .sub-text{
        font-size: 16px;
    }
    .suggest-popup-item .sub-text-two{
        font-size: 12px;
    }
    .suggest-popup-item .kawai-novel{
        max-width: 300px;
    }
    .no-member-popup-container .suggest-popup-item{
        max-width: 100%;
        gap: 10px;
        padding: 49px 25px;
    }
    .no-member-popup-container{
        width: 90%;
        max-width: 540px;
    }
    .no-member-popup-wrapper .move-btn{
        font-size: 14px;
        padding: 10px 0;
    }
    #suggestContentPopup .novel-img{
        max-width: 100px;
        width: 100%;
    }
    .recommend-botton-section button {
        font-family: 'OmniGothic', 'NanumSquareNeo-Variable', 'Apple SD Gothic Neo', sans-serif;
        text-align: center;
        width: 100%;
        height: 50px;
        cursor: pointer;
        border: 0;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .recommend-botton-section button.color-wt{
        background:#fff;
        color: #000;
        border:1px solid #000;
        height: 50px;
    }
    .recommend-botton-section button.color-bk{
        background:none;
        color: #fff;
        height: 100%;
		outline:none;
    }
}
</style>

<div class="no-member-popup-container-background" style="display: none"></div>
<div class="no-member-popup-container" style="display: none">
    <div class="no-member-popup-wrapper"  id="suggestNomalPopupWrapper" style="display: none">
				<!--a href="/page/age_auth?adult=1">
			<img src="//images.novelpia.com/img/new/event/sub_sale/ver2/member_popup_img_2.png" style="width:100%;max-width: 540px;">
		</a>-->
		        <div id="suggestNomalPopup" class="suggest-popup-item" style="display: none">
			<div class="basic-modal-close-no-member"></div>
            <img class="kawai-novel" src="//images.novelpia.com/img/modal_img_plus05.png"/>
            <div class="sub-text"> 본인인증 하시고<br><span>첫구독 무료 혜택</span> 받으세요
				                <div class="recommend-botton-section">
					<button class="color-bl go_auth">첫구독 무료 시작하기</button>
				</div>
				            </div>

        </div>
        <!--<div class="move-btn" onclick="location.href='/recommend';">첫구독 무료 시작하기</div>-->
    </div>

    <div class="no-member-popup-wrapper" style="display: none" id="suggestContentPopupWrapper">
				<!--<a href="/page/age_auth?adult=1">
			<img src="//images.novelpia.com/img/new/event/sub_sale/ver2/member_popup_img_2.png" style="width:100%; max-width: 540px;">
		</a>-->
		        <div id="suggestContentPopup" class="suggest-popup-item">
            <div class="basic-modal-close-no-member"></div>
            <img class="kawai-novel" src="//images.novelpia.com/img/modal_img_plus06.png"/>
            <div class="sub-text">
                <!--<b>첫구독 무료</b>로 편하게 이어보세요.-->


            </div>
            <div class="sub-text-two"><!---->최근 본 작품</div>
            <img src="//images.novelpia.com/imagebox/cover/cf84e3d9b39354780b733ccbb5ae3bdd_459543_ori.file" class="novel-img" style="width: 50%;"/>
            <div class="sub-text-two novel-name">소설제목</div>
			            <div class="recommend-botton-section">
		        <button class="color-wt goto-novel">괜찮아요, 그냥 볼게요</button>
		        <button class="color-bk go_auth">첫구독 무료 시작하기</button>
	        </div>
			        </div>
        
        <!--<div class="btn-wrapper">
            <div class="move-btn goto-novel">이어보기
</div>
            <div class="move-btn" style="background-color: #000;" onclick="location.href='/recommend';">첫구독 무료 시작하기
</div>
        </div>-->
    </div>
</div>
<script>

    const openWelcomePopup = () => {
        //$(".no-member-popup-container").show();
        //$(".no-member-popup-container-background").show();
		$(".no-member-popup-container").hide();
        $(".no-member-popup-container-background").hide();

		join_script_on();


        //쿠키값제거
        $.cookie('new_member', '', { expires: 0, path: '/', domain: 'novelpia.com', secure: false });
        
		return 0;

        const datatArray = JSON.parse(localStorage.getItem("userLastNovelData"));
        if(datatArray !== null){
            $("#suggestNomalPopupWrapper").hide(); //default 창 숨기기

            const lastContent = datatArray.slice(-1)[0];


            switch (lastContent.viewer_type){
                case "novel" :
                    $("#suggestContentPopup .novel-name").text(lastContent.content_data.novel_name);
                    $("#suggestContentPopup .novel-img").attr("src",lastContent.content_data.novel_thumb_all);
                    $('#suggestContentPopupWrapper .goto-novel').attr('data-val', `/viewer/${lastContent.episode_no}`);
                    break;
                case "comic" :
                    $("#suggestContentPopup .novel-name").text(lastContent.content_data.comic_title);
                    $("#suggestContentPopup .novel-img").attr("src",lastContent.content_data.thumb_img);
                    $('#suggestContentPopupWrapper .goto-novel').attr('data-val', `/comic_viewer/${lastContent.episode_no}`);
                    break;
            }

            //$("#suggestContentPopupWrapper").show();
			$("#suggestContentPopupWrapper").hide();
        }

    }

    $(".basic-modal-close-no-member").on("click", function(){
        $(".no-member-popup-container").hide();
        $(".no-member-popup-container-background").hide();
    });

    $(".no-member-popup-container-background").on("click",function(){
        $(".no-member-popup-container").hide();
        $(".no-member-popup-container-background").hide();
    });


    $('.goto-novel').on('click', function() {
        var dataValue = $(this).attr('data-val');
        location.href= dataValue;
    });

	$('.go_auth').on('click', function() {
		location.href= '/page/age_auth?adult=1';
	});

	function join_script_on() {

		const join_mem_no = "0";
		const mem_id = "";

		var time_now = new Date().getTime();
		var adnuo = "novelpia_joinno_"+time_now;

		try { window.novelpia.fcm_key(join_mem_no); } catch (e) { }
		// 회원가입 완료 gtag
		gtag('event', 'conversion', {'send_to': 'AW-16573513263/jxtzCJqpybEZEK_87t49'});
		gtag('event', 'conversion', {'send_to': 'AW-16583562065/lVzuCPuj_bMZENGm1OM9'});
		gtag('event', 'conversion', {'send_to': 'AW-16618390941/H1LVCNSnk7wZEJ2LovQ9', 'value': 1.0, 'currency': 'KRW' });

		//dv360
		window.dataLayer = window.dataLayer || [];
		window.dataLayer.push({
			'event': 'conversion_dv'
		});

		//RTBHOUSE 회원가입 완료 스크립트
		(rtbhEvents = window.rtbhEvents || []).push(
			{
				eventType: 'conversion',
				conversionClass: 'action',
				conversionSubClass: 'account',
				conversionId: join_mem_no,
				offerIds: null,
				conversionValue: null,
				conversionCurrency: null
			},
			{
				eventType : 'custom',
				name : 'signup-complete',
				value: '1'
			},
			{
				eventType: 'uid',
				id: join_mem_no
			}
		);

		// Criteo 세일즈 태그
		window.criteo_q = window.criteo_q || [];
		var deviceType = /iPad/.test(navigator.userAgent) ? "t" : /Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(navigator.userAgent) ? "m" : "d";
		window.criteo_q.push(
		 { event: "setAccount", account: 90950},
		 { event: "setEmail", email: mem_id },
		 { event: "setZipcode", zipcode: "" },
		 { event: "setSiteType", type: deviceType},
		 { event: "trackTransaction", id: join_mem_no, item: [
			{id: "join", price: 1, quantity: 1 }
		 ]}
		);
		// END Criteo 세일즈 태그

		// Facebook Pixel Code 가입전환
		// 페이스북 API 호출 중복으로 인해 주석처리 - 240620 ssChoi
		//fbq('track', 'CompleteRegistration', {}, {eventID : response.event_id});

		/* 틱톡 픽셀 스크립트 START */
		// add this before event code to all pages where PII data postback is expected and appropriate
		ttq.identify({
			"sha256_email": CryptoJS.SHA256(mem_id).toString(), // string. The email of the customer if available. It must be hashed with SHA-256 on the client side.
			// "phone_number": CryptoJS.SHA256('').toString(), // string. The phone number of the customer if available. It must be hashed with SHA-256 on the client side.
			"external_id": CryptoJS.SHA256(join_mem_no).toString(), //A unique ID from the advertiser such as user or external cookie IDs. It must be hashed with SHA256 on the client side.
		});

		ttq.track('CompleteRegistration', {
			"contents": [{
				"content_id": join_mem_no, // string. ID of the product. Example: "1077218".
				"content_type": "product", // string. Either product or product_group.
				"content_name": mem_id, // string. The name of the page or product. Example: "shirt".
			}],
			"value": "1", // number. Value of the order or items sold. Example: 100.
			"currency": "KRW", // string. The 4217 currency code. Example: "USD".
		});
		/* 틱톡 픽셀 스크립트 END */

		// Twitter conversion tracking event code
		// Insert Twitter Event ID
		twq('event', 'tw-o9p8p-obsfd', {
			email_address: mem_id, // use this to pass a user’s email address
			phone_number: "" // phone number in E164 standard
		});

		// Insert Twitter Event ID
		// 2023-06-09 cjd 트위터계정 추가
		twq('event', 'tw-of6p2-of6p7', {
			email_address: mem_id, // use this to pass a user’s email address
			phone_number: "" // phone number in E164 standard
		});

		// Insert Twitter Event ID
		// 2024-08-09 cjd 트위터계정 변경
        twq('event', 'tw-on0nz-on7vq', {
            email_address: mem_id, // use this to pass a user’s email address
            phone_number: "" // phone number in E164 standard
        });
		// End Twitter conversion tracking event code

		// 회원가입 완료 gtag - UA
		gtag('event', 'conversion', {'send_to': 'UA-187123192-1'}); // 추후 확인 필요
		gtag('event', 'sign_up', {'event_name' : 'sign_up'});

		// 카카오 광고 스크립트 회원가입
		kakaoPixel('5947846367882331136').pageView();
		kakaoPixel('5947846367882331136').completeRegistration();

		// 가입완료/구매완료 등에 삽입 (성과 측정을 위한 선택사항) 애드픽 가입완료 전환
		adpick_webtracking({ event: 'registered' });

        TenpingScript.SendConversion(join_mem_no);

		console.log("join_complete");
		
	}

</script>
<div class="basic-modal-background" id="member_join_modal">
    <div class="basic-modal-wrapper" style="background:transparent; border:0; padding:0; outline:0;">
									<div><img class="change-image" src="//images.novelpia.com/img/new/event/sub_sale/ver2/new/log_first_bnr_02.png" style="width:100%;"></div>
				<div class="basic-modal-wp-inner">
			<div class="basic-modal-top">
				<div class="basic-modal-name"></div>
				<div class="basic-modal-close"></div>
			</div>
			<div class="basic-modal-contents join-contents">
				<!--<img src="//images.novelpia.com/img/new/logo2.png" alt="노벨피아 로고">-->
				<!--로그인/회원가입 전환 탭-->
				<div class="tap-join-login">
					<div class="tab-join active" onclick="location.href='javascript:member_join_modal_on();';">회원가입</div>
					<div class="tab-login" onclick="location.href='javascript:member_login_modal_on();';">로그인</div>
				</div>
				<div class="join-sns">
					<div class="form-tit ">
						<div class="tit-line txt-sns"></div>
						<div>
							<span class="form-tit-t-bold">SNS 계정</span>으로 <span class="form-tit-t-bold">1초</span>만에 가입하기
						</div>
						<div class="tit-line txt-sns"></div>
					</div>
										<div class="sns-btns">
						<a href="#" onclick="join_sns_submit('naver');">
							<input type="hidden" id="naver_url" value="https://nid.naver.com/oauth2.0/authorize?response_type=code&client_id=A8OQVi3byB1jFOckQ0RZ&redirect_uri=https%3A%2F%2Fnovelpia.com%2Fproc%2Flogin_naver%3Fredirectrurl%3D&state=c121186a0a766f986f74b166b5c131f4">
							<img src="/img/new/menu/logo_naver.png" alt="네이버로 회원가입">
						</a>
						<a href="#" onclick="join_sns_submit('kakao');">
							<input type="hidden" id="kakao_url" value="https://kauth.kakao.com/oauth/authorize?client_id=8ef49d8a2a7a8f64a329817bb7015402&redirect_uri=https%3A%2F%2Fnovelpia.com%2Fproc%2Flogin_kakao&response_type=code&state=c121186a0a766f986f74b166b5c131f4">
							<img src="/img/new/menu/logo_kakao.png" alt="카카오로 회원가입">
						</a>
						<a href="#" onclick="join_sns_submit('google');">
							<input type="hidden" id="google_url" value="https://novelpia.com/proc/login_google">
							<img src="/img/new/menu/logo_google.png" alt="구글로 회원가입">
						</a>
						<a href="#" onclick="join_sns_submit('apple');"><img id="" class="apple_join_id" src="/img/new/menu/logo_apple.png" alt="애플로그인으로 회원가입"></a>
                        						<a href="#" onclick="join_sns_submit('facebook');">
							<input type="hidden" id="facebook_url" value="https://www.facebook.com/v2.10/dialog/oauth?client_id=271442058762092&state=b92b1e79769f2191a45452d63f29c380&response_type=code&sdk=php-sdk-5.7.0&redirect_uri=https%3A%2F%2Fnovelpia.com%2Fproc%2Flogin_facebook&scope=email">
							<img src="//images.novelpia.com/img/new/menu/logo_facebook_wt.png" alt="페이스북으로 회원가입">
						</a>
					</div>
				</div>
				<!--
				<div class="join-banner">
										<img src="//images.novelpia.com/img/new/menu/join_modal_banner_comic.png" alt="배너">
									</div>
				-->
				<!--이메일가입하기 버튼
				<div class="">
					<button class="btn-email-join"><img src="//images.novelpia.com/img/new/common/icon_email_join.svg"> 이메일로 가입하기</button>
				</div>-->
				<!--이메일가입창-->
				<div class="email-form-wrapper">
					<input type="hidden" name="redirectrurl" value="">
					<div class="join-box">
						<div class="form-tit txt-login2">
							<div class="tit-line txt-email2"></div>
							<div>
								<span class="form-tit-t-bold">이메일</span>로 가입하기
							</div>
							<div class="tit-line txt-email2"></div>
						</div>
						<div>
							<input type="email" id="join_name" name="join_email" required placeholder=" ">
							<label for="join_name">이메일을 입력해주세요.</label>
						</div>
						<div>
							<input type="password" name="join_password" id="join_password" required placeholder=" ">
							<label for="join_password">패스워드</label>
						</div>
						<div>
							<input type="password" name="join_password_re" id="join_password_re" required placeholder=" ">
							<label for="join_password">패스워드 확인</label>
						</div>
						<!--
						<div class="fid_box">
							<div style="width:100%;">
								<input type="text" name="join_fid" id="join_fid" placeholder=" " value="">
								<label for="join_fid">추천인코드 입력</label>
							</div>
							<input type="hidden" name="is_confirm_fid" id="is_confirm_fid" value="" />
													</div>
						-->
					</div>
					<div class="join-box">
						<button type="button" id="join_btn" onclick="join_form_submit();">회원가입</button>
					</div>
					<div class="join-check">
						<div class="all-agree-check-toggle-add">
							<input type="checkbox" id="all_agree_check">
							<label for="all_agree_check" style="font-weight:500;">전체 동의하기</label>
						</div>
						<div class="all-agree-item">
							<input type="checkbox" id="tos_agree_check">
							<label for="tos_agree_check">
								<a href="#" onclick="popup_open('term')">이용약관</a>동의(필수)
							</label>
							<input type="checkbox" id="tos_agree_check2">
							<label for="tos_agree_check2">
								<a href="#" onclick="popup_open('policy')">개인정보 수집 및 이용</a>동의(필수)
							</label>
							<!--
							<label for="tos_agree_check">
								<a href="#" onclick="popup_open('term')">이용약관</a> 및
								<a href="#" onclick="popup_open('policy')">개인정보방침</a>에 동의합니다.(필수)
							</label>
							-->

							<input type="checkbox" id="age_agree_check"><label for="age_agree_check">만 14세 이상(필수)</label>
							<input type="checkbox" id="alarm_agree_check"><label for="alarm_agree_check"><a href="#" onclick="open_popup();">혜택정보 알림</a>(선택)</label>
						</div>
					</div>
				</div>
				<!--230316추천인코드-->
				<div class="friend-code-input">
					<p>추천인코드</p>
					<input type="text" name="join_fid" id="join_fid" value="" readonly>
				</div>
				<!--ID/PW찾기-->
				<!--
				<div class="find-idpw">
					<a href="/page/id_search_new">아이디/패스워드 찾기</a>
					|
					<a href="javascript:member_login_modal_on();">로그인</a>
				</div>
				-->
			</div>
			<!--231106 혜택수신동의모달-->
			<div class="ad-agree-pop" style="display:none;">
				<div class="ad-modal-close"></div>
				<p class="title"><span>혜택 정보 알림 수신 동의</span> (선택)</p>
				<p class="title-info">노벨피아에서 제공하는 이벤트 및 서비스(제휴 서비스 포함) 안내 등 광고성 정보를 받으시려면 혜택 정보 이용에 동의하여 주시기 바랍니다.</p>
				<table>
					<thead>
						<tr>
							<th style="width:70px;">선택 정보 수집 항목</th>
							<th>목적</th>
							<th>보유 및 이용기간</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>이메일,<br>휴대폰 번호</td>
							<td>이벤트 혜택 및 정보 전송</td>
							<td>목적 달성 후 즉시 파기 관련 법령에서 별도의 보관기간을 정한 경우 해당 시점까지 보관</td>
						</tr>
					</tbody>
				</table>
				<p class="s-txt">동의를 거부할 권리가 있으며, 혜택 등의 여부와 관계 없이 회원가입을 할 수 있습니다. 다만, 동의 거부 시 상기 목적에 명시된 서비스를 제공받으실 수 없습니다.</p>
				<div class="ad-agree-check">
					<input type="checkbox" id="ad-agree" name="ad-agree" data-gtm-form-interact-field-id="2" onclick="ad_checked();"><label for="ad-agree">위 혜택 정보 알림 수신에 동의합니다.</label>
				</div>
			</div>
		</div>
    </div>
</div>
<!-- 회원가입 modal END -->

<script>
$(".all-agree-toggle").click(function(){
  $(".all-agree-item").toggle();
});

//$(".btn-email-join").click(function(){
//  $(".email-form-wrapper").show();
//  $(".btn-email-join").hide();
//});

$('#member_join_modal .sns-btns a').click(function (){
    inc_stat("stat_induce_pay", {
        flag_type: 48,
        item_no: 1
    });
});

</script>

<style>
	.join-box .fid_box { display: flex; justify-content: center; align-items: center; }
	.join-box .fid_box #join_fid+label:before { content: ''; padding-left: 10px; }
	.join-box .fid_box > div { width: calc(100% - 110px); }
	.join-box .fid_box > div .mem_no_target { height: 60px; line-height: 55px; }
	.join-box .fid_box > div .mem_no_target .s_inv { filter: invert(0); }
	.join-box button.getChkFid { width: 110px; margin: 0px; margin-bottom: 4px; }
</style>
<script>
	// 추천인 체크
	$('.join-box').on('click', 'button.getChkFid', function(){
		let _fid = $('#join_fid').val();
		console.log(_fid);
		getConvartFid(_fid);
	});

	// 추천인 확인
	function getConvartFid(code){
		$.ajax({
			url: "/proc/event_recommend",
			data: {
				"mode" : "getConvartFid",
				"code" : code
			},
			type: "POST",
            async: false,
			dataType: "json",
			success: function(response){
				if (response.status == '200') {
					//console.log(response.result);
					if(Object.keys(response.result).length > 0){
						// $('.join-box .fid_box > div').append('<div class="mem_no_target">'+response.result.target+'</div>');
						// $('.join-box .fid_box > div input').hide();
						// $('.join-box .fid_box button.getChkFid').hide();
						//$('.join-box #is_confirm_fid').val('1');
						$('.join-box #join_fid').val(response.result.fid);
						$.cookie('FID', response.result.fid, { expires: 2, path: '/', domain: 'novelpia.com', secure: false });
                        return;
					}
				}

                //$('.join-box #is_confirm_fid').val('');
                $('.join-box #join_fid').val('');
                $.cookie('FID', '', { expires: 0, path: '/', domain: 'novelpia.com', secure: false });
			},
		});
	}
</script>

<!-- 로그인 modal -->
<div class="basic-modal-background" id="member_login_modal" style="padding:0;">
    <div class="basic-modal-wrapper" style="background:transparent; border:0; padding:0; outline:0;">
		
									<div><img class="change-image" src="//images.novelpia.com/img/new/event/sub_sale/ver2/new/log_first_bnr_02.png" style="width:100%;"></div>
				<div class="basic-modal-wp-inner">
			<div class="basic-modal-top">
				<div class="basic-modal-name"></div>
				<div class="basic-modal-close"></div>
			</div>
			<div class="basic-modal-contents login-contents">
				<!--<img src="//images.novelpia.com/img/new/logo2.png" alt="노벨피아 로고">-->
				<!--로그인/회원가입 전환 탭-->
				<div class="tap-join-login">
					<div class="tab-join" onclick="location.href='javascript:member_join_modal_on();';">회원가입</div>
					<div class="tab-login active" onclick="location.href='javascript:member_login_modal_on();';">로그인</div>
				</div>
				<div class="sns-login">
					<div class="form-tit txt-login">
						<div class="tit-line txt-sns login"></div>
						<div>
							<span class="form-tit-t-bold">SNS 계정</span>으로 <span class="form-tit-t-bold">간편하게</span> 로그인
						</div>
						<div class="tit-line txt-sns login"></div>
					</div>					
															<div class="sns-btns">
						<a href="https://nid.naver.com/oauth2.0/authorize?response_type=code&client_id=A8OQVi3byB1jFOckQ0RZ&redirect_uri=https%3A%2F%2Fnovelpia.com%2Fproc%2Flogin_naver%3Fredirectrurl%3D&state=c121186a0a766f986f74b166b5c131f4" onclick="$('.loads').show();"><img src="/img/new/menu/logo_naver.png" alt="네이버로 로그인"><div class="last-login-ballon last-login-naver">최근 로그인</div></a>
						<a href="https://kauth.kakao.com/oauth/authorize?client_id=8ef49d8a2a7a8f64a329817bb7015402&redirect_uri=https%3A%2F%2Fnovelpia.com%2Fproc%2Flogin_kakao&response_type=code&state=c121186a0a766f986f74b166b5c131f4" onclick="$('.loads').show();"><img src="/img/new/menu/logo_kakao.png" alt="카카오로 로그인"><div class="last-login-ballon last-login-kakao">최근 로그인</div></a>
						<a href="https://novelpia.com/proc/login_google" onclick="$('.loads').show();"><img src="/img/new/menu/logo_google.png" alt="구글로 로그인"><div class="last-login-ballon last-login-google">최근 로그인</div></a>
												<a href="https://appleid.apple.com/auth/authorize?client_id=com.novelpia.service&redirect_uri=https://novelpia.com/proc/login_apple&response_type=code id_token&state=593391a4c51d660fcceca9505265581a&scope=email name&response_mode=form_post"><img id="" class="apple_login_id" src="/img/new/menu/logo_apple.png" alt="애플로그인으로 로그인"><div class="last-login-ballon last-login-apple">최근 로그인</div></a>
												<a href="https://www.facebook.com/v2.10/dialog/oauth?client_id=271442058762092&state=b92b1e79769f2191a45452d63f29c380&response_type=code&sdk=php-sdk-5.7.0&redirect_uri=https%3A%2F%2Fnovelpia.com%2Fproc%2Flogin_facebook&scope=email" onclick="$('.loads').show();">
							<img src="//images.novelpia.com/img/new/menu/logo_facebook_wt.png" alt="페이스북으로 로그인">
							<div class="last-login-ballon last-login-facebook">최근 로그인</div>
						</a>
					</div>
					<script type="text/javascript" src="https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/ko_KR/appleid.auth.js"></script>
					<script type="text/javascript">
						AppleID.auth.init({
							clientId : 'com.novelpia.service',
							scope : 'email name',
							redirectURI: 'https://novelpia.com/proc/login_apple',
							state : 'c121186a0a766f986f74b166b5c131f4',
							usePopup : false
						});
					</script>
				</div>				
				<form action="/proc/login" id="login_box" method="post">

					<input type="hidden" name="redirectrurl" value="">
					<div class="login-box">
						<div class="last-login-ballon in-form last-login-basic">최근 로그인</div>
						<div class="form-tit txt-login2">
							<div class="tit-line txt-email2"></div>
							<div>
								<span class="form-tit-t-bold">이메일</span>로 로그인
							</div>
							<div class="tit-line txt-email2"></div>
						</div>
						<input type="email" name="email" value="" placeholder="이메일을 입력해주세요." required>
						<input type="password" name="wd" placeholder="비밀번호를 입력해주세요.">
						<div class="login-check">
							<input type="checkbox" id="idsave" name="idsave" ><label for="idsave">아이디저장</label>
                            <div>
							    <a class="find-idpw-txt" href="/id_search">아이디</a>/<a class="find-idpw-txt" href="/pw_search">패스워드 찾기</a>
                            </div>
						</div>
						<button type="submit" style="margin-top:0;">이메일 로그인하기</button>
					</div>
				</form>
				<!--
				<div class="find-idpw">
					<a href="/page/id_search_new">아이디/패스워드 찾기</a>
					|
					<a href="javascript:member_join_modal_on();">회원가입</a>
				</div>
				-->
			</div>
		</div>
    </div>
</div>
<!-- 로그인 modal END -->
<style>
#total_event_auth_modal .event_plus_ad {
	background:#fff;
	border-radius:10px;
}

#total_event_join_modal .event_plus_ad {
	background:#fff;
	border-radius:10px;
}

#total_event_guide_modal .event_plus_ad {
	background:#fff;
	border-radius:10px;
}

#total_event_modal .event_plus_ad {
	background:#fff;
	border-radius:10px;
}

.disable_scroll {
	height:100%;
	min-height:100%;
	overflow:hidden !important;
	touch-action:none;
}

</style>

<script type="text/javascript" src="//wcs.naver.net/wcslog.js"> </script>

<script>
	// login , join 관련 scripts
	// 22.01.20 - sschoi

    let this_url = window.location.href;
    if(this_url.indexOf("viewer") !==  -1) {
        //$('.change-image').attr('src', '//images.novelpia.com/img/new/banner/join_banner_viewer.png');
    }

	$(".basic-modal-close").click(function(){
		$(".basic-modal-background").hide();
		$('.ad-agree-pop').hide();
		$.cookie('_redirectrurl', '', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });

		// 에피소드 리스트로 넘기기
	/*	if(this_url.indexOf("viewer") !=  -1){
			if($.cookie('out_url')){
				location.href = $.cookie('out_url');
				$.cookie('out_url', '', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
			}
			else {
				$.cookie('out_url', '', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
				history.go(-1);
				return false;
			}
		}*/

	/*	if(this_url.includes('intro_landing')){
			return ;
		}
        if(this_url.includes('user_free_ticket')){
            return;
        }*/

         if(this_url.includes('viewer') ){
          /*  if($.cookie('out_url')){
                location.href = $.cookie('out_url');
                $.cookie('out_url', '', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
            }
            else {*/
                $.cookie('out_url', '', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
                //history.go(-1);
                return false;
           // }
         }
         else if (this_url.includes('comic_episode')){
             return false;
         }
        else if(this_url.includes('comic')){
            location.href = '/comic_main';
        }
        else {
            // location.href = '/';
            return false;
        }

    /*    if(this_url.includes('comic')){
            location.href = '/comic_main';
        }
        else if(this_url.includes('viewer') ){
            location.href = '/';
        }
        else {
            // location.href = '/';
            return;
        }*/

    })

	$("#all_agree_check").click(function(){
		if($("#all_agree_check").prop("checked")) {
			$("#tos_agree_check").prop("checked",true);
            $("#tos_agree_check2").prop("checked",true);
			$("#age_agree_check").prop("checked",true);
			$("#alarm_agree_check").prop("checked",true);
		}else{
			$("#tos_agree_check").prop("checked",false);
            $("#tos_agree_check2").prop("checked",false);
			$("#age_agree_check").prop("checked",false);
			$("#alarm_agree_check").prop("checked",false);
		}
	});

    $(".join-check input[type='checkbox']").click(function(){
        if($(this).attr("id") != "all_agree_check" && $(this).prop("checked") == false){
            $("#all_agree_check").prop("checked",false);
        }

        if($(".join-check input[type='checkbox']:checked").length == 4 && $("#all_agree_check").prop("checked") == false){
            $("#all_agree_check").prop("checked",true);
        }
    });

	/*
	$("#tos_agree_check").click(function(){
		if($('#tos_agree_check').is(':checked')){
			if($('age_agree_check').is(':checked')){
				if($('alarm_agree_check').is(':checked')){
					$("#all_agree_check").prop("checked",true);
				}
			}
		}
	});
	*/

	$("#age_agree_check").click(function(){

	});
	$("#alarm_agree_check").click(function(){

	});


	function member_join_modal_on(){
		$('#member_login_modal').hide();
		$('#member_join_modal').show();
		//$(".email-form-wrapper").hide();
		//$(".btn-email-join").show();

        if($.cookie('FID')) {
            $('#join_fid').val($.cookie('FID'));
        } else {
            $('.friend-code-input').hide();
        }
		const reurl = $.cookie('_redirectrurl');

		if(reurl == '' || reurl === null || reurl == undefined){//쿠키값이 없을때는 '', 쿠키 자체가 안구워졌을때는 undefined
			$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		}
	}

	function member_login_modal_on(){
		$('#member_join_modal').hide();
		$('#member_login_modal').show();

		$('.last-login-ballon').hide();

		let last_login = $.cookie('last_login');
		if(reurl !== '' || reurl !== null || reurl !== undefined){
			$('.last-login-'+last_login).show();
		}
		// 현재페이지 쿠키저장
		var reurl = $.cookie('_redirectrurl');
		if(reurl == '' || reurl === null || reurl == undefined){
			$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		}
	}

	function modal_all_close(){
		$('#member_join_modal').hide();
		$('#member_login_modal').hide();
	}

	function popup_open(name){
		if(name == 'term'){
			var url = "/page/terms_of_use";
		}else if(name == 'policy'){
			var url = "/page/privacy_policy_simple";
		}
		var name = "terms_popup";
		//var option = "width = 500, height = 500, top = 100, left = 200, location = no"
		var option = "location = no";
		window.open(url, name, option);
	}
	function open_popup(){
		$('.ad-agree-pop').show();
	}

	function ad_checked(){
		const ad_checkbox = document.getElementById('ad-agree');
		const ad_checked = ad_checkbox.checked;
		if(ad_checked === true){
			$("#alarm_agree_check").prop("checked",true);
			$('.ad-agree-pop').hide();
		}else{
			$("#alarm_agree_check").prop("checked",false);
			$('.ad-agree-pop').hide();
		}
	}

	$('.ad-modal-close').click(function(){
		$('.ad-agree-pop').hide();
	});


	

	function all_agree_check(){
		$('input:checkbox[id="all_agree_check"]').is(":checked") == true;
		$('input:checkbox[id="tos_agree_check"]').is(":checked") == true;
        $('input:checkbox[id="tos_agree_check2"]').is(":checked") == true;
		$('input:checkbox[id="age_agree_check"]').is(":checked") == true;
		$('input:checkbox[id="alarm_agree_check"]').is(":checked") == true;
	}

	function join_sns_submit(sns){
		var tos_agree = $('#tos_agree_check').prop("checked");
		var tos_agree2 = $('#tos_agree_check2').prop("checked");
		var age_agree = $('#age_agree_check').prop("checked");
		var alarm_agree = $('#alarm_agree_check').prop("checked");
		var location_url = '';
		var fid = $('#join_fid').val();

        //RTBHOUSE 회원가입 시작 스크립트
        (rtbhEvents = window.rtbhEvents || []).push(
            {
                eventType: 'basket',
            },
            {
                eventType: 'custom',
                name: 'signup-start',
                value: '1'
            },
            {
                eventType: 'UID',
                id: '0'
            });

		if(!tos_agree){
			alert("이용약관 동의 후 가입이 가능합니다.");
			return false;
		}
		if(!age_agree){
			alert("개인정보방침에 동의 후 가입이 가능합니다.");
			return false;
		}
		if(!tos_agree2){
			alert("만 14세 이상만 가입이 가능합니다.");
			return false;
		}

        if(fid != '') {
            getConvartFid(fid);
        }


		if(alarm_agree){
			//location_url = $('#'+sns+'_url').val()+"&alarm=1";
			$.cookie('alarmchk', '1', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		}else{
			//location_url = $('#'+sns+'_url').val()+"&alarm=0";
			$.cookie('alarmchk', '0', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		}

		if(sns == 'apple'){
			//appleid-signin
			$('.apple_join_id').attr('id','appleid-signin');
			AppleID.auth.init({
				clientId : 'com.novelpia.service',
				scope : 'email name',
				redirectURI: 'https://novelpia.com/proc/login_apple',
				state : 'c121186a0a766f986f74b166b5c131f4',
				usePopup : false
			});
			//$('#appleid-signin').unbind('click');
			$('#appleid-signin')[0].click();
			//$('#appleid-signin').trigger("click");
		}else{
			location_url = $('#'+sns+'_url').val();
			location.href = location_url;
		}
	}

	function login_sns_apple(){
		$('.apple_login_id').attr('id','appleid-signin');
		AppleID.auth.init({
			clientId : 'com.novelpia.service',
			scope : 'email name',
			redirectURI: 'https://novelpia.com/proc/login_apple',
			state : 'c121186a0a766f986f74b166b5c131f4',
			usePopup : false
		});
		$('#appleid-signin')[0].click();
	}

	function join_form_submit(){

		var fid = $('#fid').val();
		var name = $('#join_name').val();
		var pw1 = $('#join_password').val();
		var pw2 = $('#join_password_re').val();
		var tos_agree = $('#tos_agree_check').prop("checked");
		var tos_agree2 = $('#tos_agree_check2').prop("checked");
		var age_agree = $('#age_agree_check').prop("checked");
		var alarm_agree = $('#alarm_agree_check').prop("checked");
		var fid = $('#join_fid').val();
		//var is_recommend = $('#is_confirm_fid').val();

        //RTBHOUSE 회원가입 시작 스크립트
        (rtbhEvents = window.rtbhEvents || []).push(
            {
                eventType: 'basket',
            },
            {
                eventType: 'custom',
                name: 'signup-start',
                value: '1'
            },
            {
                eventType: 'UID',
                id: '0'
            });

		var regExp = /^[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}$/i; // 검증에 사용할 정규식 변수 regExp에 저장
		if (name.match(regExp) != null){
			//alert('Good!');
		}else{
			alert("잘못된 이메일 규칙입니다.");
			return false;
		}
		if(pw1.length == 0){
			alert("패스워드를 작성해주세요.");
			return false;
		}
		if(pw1.length < 4){
			alert("패스워드가 너무 짧게 작성되었습니다.");
			return false;
		}
		if(pw1.length > 27){
			alert("패스워드가 너무 길게 작성되었습니다.");
			return false;
		}
		if ( pw1 != pw2 ) {
			alert( "패스워드가 서로 다르게 작성되었습니다." );
			return false;
		}
		if(!tos_agree){
			alert("이용약관 동의후 가입이 가능합니다.");
			return false;
		}
		if(!tos_agree2){
			alert("개인정보방침에 동의후 가입이 가능합니다.");
			return false;
		}
		if(!age_agree){
			alert("만 14세 이상만 가입이 가능합니다.");
			return false;
		}

        if(fid != '') {
            getConvartFid(fid);
            fid = $('#join_fid').val();
        }

		var preUrl = document.referrer;
		var preurlArr = preUrl.split('/');
		var return_pid = $.cookie('return_pid');

        $('#join_btn').prop('disabled', true);

        inc_stat("stat_induce_pay", {
            flag_type: 48,
            item_no: 1
        });


		$.ajax({
			url: "/proc/join_ver2",
			data: {
				"fid" : fid,
				"email" : name,
				"password" : pw1,
				"conpassword" : pw2,
				"tos_agree" : tos_agree,
				"age_agree" : age_agree,
				"alarm_agree" : alarm_agree
			},
			type: "POST",
			dataType:"json",
			success: function(response){
				if(response.status == '200'){
					//console.log(preurlArr);
					var time_now = new Date().getTime();
					var adnuo = "novelpia_joinno_"+time_now;
                    try {
						// 마케팅 스크립트 다른 파일로 교체
                    } catch (e) {

                    } finally {
                        //alert(response['result']['msg']);
                        //alert(response['result']['return_url']);

                        setTimeout(function (){
                            if($.cookie('FID')){ // 추천인
                                location = '/page/age_auth_recommend';
                                return false;
                            }else{
                                //새로운 맴버 체크값 쿠키게 담기
								const new_member_popup = $.cookie('new_member_popup');
								if(new_member_popup == 1){
									//$.cookie('new_member', 0, { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
								}else{
									$.cookie('new_member', 1, { expires: 1, path: '/', domain: 'novelpia.com', secure: false });
								}

                                //location.href = "/";
                                //마케팅 redirect_url이 있을경우 해당 url로 이동
                                if(response['result']['return_url']){
                                    location = response['result']['return_url'];
                                }else{
                                    location.reload();
                                }
                            }
                        }, 300);
                    }
				}else {
					var errmsg = response['result'] || "연동 오류" ;
                    $('#join_btn').prop('disabled', false);
					alert(errmsg);
				}
			},
			error : function(request,status,error){
                $('#join_btn').prop('disabled', false);
				console.log("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
			},
			complete: function(){

			}
		});

	}

	$(document).ready(function(){
		// 비플러스 30분 이용권 프로모션
		let mem_no = "0";
		if(mem_no != 0){
			get_event_plus_list().then(function () {
                proc_additional_modal(); 
            });
		}

        if($.cookie("new_member") == 1){
            //새회원팝업창 open
            openWelcomePopup();
        }

	});

	function login_chk(){
		return 0;
	}

	function get_ignore_list() {
		const ignore_storage = localStorage.getItem('event_plus_ignore') ? JSON.parse(localStorage.getItem('event_plus_ignore')) : {};
		const mem_no = "0";
		const nowTtl = Date.now();
		let ignore_list = ignore_storage[mem_no] ? ignore_storage[mem_no] : [];
		ignore_list = ignore_list.filter((val) => val.expire > nowTtl);
		ignore_storage[mem_no] = ignore_list;
		localStorage.setItem('event_plus_ignore', JSON.stringify(ignore_storage));

		return ignore_list;
	}

	function set_ignore_list(ignore_list, ttl) {
		const ignore_storage = localStorage.getItem('event_plus_ignore') ? JSON.parse(localStorage.getItem('event_plus_ignore')) : {};
		const mem_no = "0";
		const nowTtl = Date.now();

		ignore_list = ignore_list.map((val) => {
			return {idx: val, expire: nowTtl + ttl};
		});

		if (ignore_storage[mem_no]){
			ignore_storage[mem_no] = ignore_storage[mem_no].concat(ignore_list);
		}
		else {
			ignore_storage[mem_no] = ignore_list;
		}
		localStorage.setItem('event_plus_ignore', JSON.stringify(ignore_storage));

		return true;
	}

	async function get_event_plus_list(){
		const ignore_obj = get_ignore_list();
		const ignore_list = ignore_obj.map((val) => val.idx);
		const data = {
			cmd : "event_list",
			ignore_list: ignore_list,
		};

		const response = await http("get","/proc/member_plus",data);
		const {status, errmsg, result, code} = response;
		_dev.log(response);
		
				if (!ignore_list.includes(0)){
			if (code == 100) {
				//2024_100원 이벤트
				if($("#world_novelpia_modal").css('display') === 'block') {
					$("#total_event_modal").hide();
				}else{
					$('#total_event_auth_modal').show();
				}
				return;
			}
			else if (code == 101) {
				$('#total_event_join_modal').show();
				return;
			}
		}

		const { event_list } = result;

		if (!event_list || event_list.length == 0){
			event_idx = 0;
			return;
		}

		await get_event_plus_check(event_list);
	}

	let event_idx;

	async function get_event_plus_check(event_list){
		const data = {
			cmd : "event_check",
			event_list,
		};

		const response = await http("get","/proc/member_plus",data);
		const {status, errmsg, result, code} = response;
		_dev.log(response);

		const {plus_minute = 0, idx = 0, end_dt, first_check, fn_method} = result;

		event_idx = idx;
		if (!plus_minute || !idx){
			set_ignore_list(event_list, 1000 * 60 * 60 * 24 * 365);
			return;
		}

		let span_red_dot = $('<span id="free_ticket_alarm"></span>');
		let span_red_dot_m = $('<span id="free_ticket_alarm_m"></span>');
		$('#btn_free_ticket > a').append(span_red_dot);
		$('#btn_m_free_ticket > a').append(span_red_dot_m);
        $('#sideTicket').addClass("create-new");
        $('#sideTicketM').addClass("create-new");

		event_list = event_list.filter((val) => val != idx);
		set_ignore_list(event_list, 1000 * 60 * 60 * 24 * 365);
		
		let day = Math.floor(plus_minute / 1440);
		let hour = Math.floor(plus_minute / 60);
		let minute = plus_minute % 60;

		const time = new Date(end_dt);
		const koreanDay = ['일', '월', '화', '수', '목', '금', '토'];
		const end_hour = time.getMinutes() == 59 ? time.getHours() + 1 : time.getHours();

		if (day >= 4) {
			$('.txt-main-tit').text(`${day ? day + "일" : ""} 무료이용권`);
			$('.coupon-notice01').text(`- 본 쿠폰은 ${day ? day + "일" : ""}간 이용 가능합니다.`);
			$('.coupon-notice03').text(`${day ? day + "일" : ""} 이용권을 사용하시겠어요?`);
		}
		else{
			$('.txt-main-tit').text(`${hour ? hour + "시간" : ""}${minute ? minute + "분" : ""} 무료이용권`);
			$('.coupon-notice01').text(`- 본 쿠폰은 ${hour ? hour + "시간" : ""}${minute ? minute + "분" : ""}동안 이용 가능합니다.`);
			$('.coupon-notice03').text(`${hour ? hour + "시간" : ""}${minute ? minute + "분" : ""} 이용권을 사용하시겠어요?`);
		}
		$('.coupon-notice02').text(`- 사용기한은 ${(time.getMonth() + 1) + '월 ' + time.getDate() + '일(' + koreanDay[time.getDay()] + ') ' + end_hour + '시'}까지 입니다.`);
		$('.coupon-notice03').text(`${hour ? hour + "시간" : ""}${minute ? minute + "분" : ""} 이용권을 사용하시겠어요?`);

		if (fn_method == 'fn_check_new_join'){ 			const today = new Date();
			$('.coupon-notice02').text(`- 사용기한은 ${(today.getMonth() + 1) + '월 ' + today.getDate() + '일(' + koreanDay[today.getDay()] + ') 24시'}까지 입니다.`);
		}

		if (first_check == 1) {
			get_event_plus_insert();
		}
		else {
			if($("#world_novelpia_modal").css('display') === 'block') {
				$("#total_event_modal").hide();
			}else{
				$('#total_event_modal').show();
			}
		}

		let hottime_stat = $.cookie('hottime_stat');
		hottime_stat = Number(hottime_stat);
		_dev.log(hottime_stat);
		if(hottime_stat != 1){
			hottime_stat_plus_view();
		}
	}

	async function get_event_plus_insert(){
		if (!event_idx){
			return;
		}

		const data = {
			cmd : "event_insert",
			event_idx
		}

		const response = await http("get","/proc/member_plus",data);
		const {status, errmsg = "연동 오류", result} = response;

		const {plus_minute, idx, fn_method, first_check} = result;

		if(plus_minute > 0){
			let day = Math.floor(plus_minute / 1440);
			let hour = Math.floor(plus_minute / 60);
			let minute = plus_minute % 60;

			hottime_stat_plus();
			const toastr_msg =  "플러스 이용권이 적용되었습니다.";
			if (day >= 4) {
				toastr.info(`${day ? day + "일" : ""}`, toastr_msg, {timeOut: 2000});
			}
			else{
				toastr.info(`${hour ? hour + "시간" : ""} ${minute ? minute + "분" : ""}`, toastr_msg, {timeOut: 2000});
			}

			if (fn_method == 'fn_check_new_join'){
				set_ignore_list([event_idx], 1000 * 60 * 60);
			}
			else{
				set_ignore_list([event_idx], 1000 * 60 * 60 * 24 * 365);
			}

			$("#total_event_modal").hide();

			if (first_check){
				$("#total_event_guide_modal").show();
			}

			return idx;
		}else{
			set_ignore_list([event_idx], 1000 * 60 * 60 * 24 * 365);
			alert(errmsg);
			return 0;
		}
	}

	function proc_additional_modal() {
				if (typeof wn_modal_open === 'function') {
			wn_modal_open(); 		}
	}

	function hottime_stat_plus_view(){
		$.cookie('hottime_stat', '1', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		inc_stat("stat_induce_pay", {
			flag_type : 44,
			item_no : 0
		})
	}

	function hottime_stat_plus(){
		inc_stat("stat_induce_pay", {
			flag_type : 45,
			item_no : 0
		})
	}

	$("#total_event_auth_modal").on("click", ".detail-modal-hottime-btn", function(){
		location.href = '/page/age_auth?adult=2';
		$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		$('#total_event_auth_modal').hide();
	});

	$("#total_event_join_modal").on("click", ".detail-modal-hottime-btn", function(){
		location.href = '/page/age_auth?adult=2';
		$.cookie('_redirectrurl', 'L3ZpZXdlci8zOTI5MzE3', { expires: 365, path: '/', domain: 'novelpia.com', secure: false });
		$('#total_event_join_modal').hide();
	});

	$("#total_event_guide_modal").on("click", ".detail-modal-hottime-btn", function(){
		location.href = '/plus';
		$('#total_event_guide_modal').hide();
	});

	$("#total_event_modal").on("click", ".detail-modal-hottime-btn", function(){
		get_event_plus_insert();
		$('#total_event_modal').hide();
		proc_additional_modal();
	});

	$("#total_event_modal").on("click", ".detail-modal-href-btn", function(){
		location.href = '/user_free_ticket';
	});

	$("#total_event_auth_modal").on("click", ".event-plus-close", function(){
		$('#total_event_auth_modal').hide();
		proc_additional_modal();
	});
	
	$("#total_event_join_modal").on("click", ".event-plus-close", function(){
		$('#total_event_join_modal').hide();
		proc_additional_modal();
	});

	$("#total_event_guide_modal").on("click", ".event-plus-close", function(){
		$('#total_event_guide_modal').hide();
		proc_additional_modal();
	});

	$("#total_event_modal").on("click", ".event-plus-close", function(){
		$('#total_event_modal').hide();
        proc_additional_modal();
	});

	$("#total_event_auth_modal").on("click", ".hottime-modal-close-btn", function(){
		$('#total_event_auth_modal').hide();
		set_ignore_list([0], 1000 * 60 * 60 * 24);
	});

	$("#total_event_join_modal").on("click", ".hottime-modal-close-btn", function(){
		$('#total_event_join_modal').hide();
		set_ignore_list([0], 1000 * 60 * 60 * 24);
	});

	$("#total_event_modal").on("click", ".hottime-modal-close-btn", function(){
		$('#total_event_modal').hide();
		if (!event_idx){
			return;
		}
		set_ignore_list([event_idx], 1000 * 60 * 60 * 24);
		proc_additional_modal();
	});

	$("#total_event_modal").on("click", ".coupon-notice-folder", function(){
		$(".coupon-notice-detail").removeClass("hide");
		$(".coupon-notice-folder").hide();
	});

    $('#member_login_modal .sns-btns a').click(function (){
        inc_stat("stat_induce_pay", {
            flag_type: 49,
            item_no: 1
        });
    });

    $('#member_login_modal button').click(function (){
        inc_stat("stat_induce_pay", {
            flag_type: 49,
            item_no: 1
        });
    });

</script>

<script>
function datatable_clear() {
	var activeRequestsTable = $('#datatable1').DataTable();
	activeRequestsTable.state.clear();
}
try
{
	if (!!window.navigator.userAgent.match(/(MSIE|Trident|Edge)/)){
		isPrivateMode().then((inPrivate) => {
			console.log('is in private mode: ', inPrivate);
			$.cookie('PRIVATE_MODE', inPrivate, { expires: 365, path: '/', domain: '.novelpia.com', secure: true });
		});
	} else {
		isPrivateWindow(function(is_private) {
		    if(is_private) {
			console.log('is in private mode: ', is_private);
			$.cookie('PRIVATE_MODE', is_private, { expires: 365, path: '/', domain: '.novelpia.com', secure: true });
		    } else {
			console.log('is in private mode: ', is_private);
			$.cookie('PRIVATE_MODE', is_private, { expires: 365, path: '/', domain: '.novelpia.com', secure: true });
		    }
		});
	}
}
catch (e)
{
	console.log('is in private mode: ',e);
	$.cookie('PRIVATE_MODE', 'error', { expires: 365, path: '/', domain: '.novelpia.com', secure: true });
}
$(window).bind("pageshow", function(event) { if (event.originalEvent && event.originalEvent.persisted) { $('.loads').hide();   } });
window.onpageshow = function (event) { if (event.persisted) { $('.loads').hide(); } else { } }

</script>
<!--사이트 연관 채널 마크업-->
<script type="application/ld+json">
	{
		"@context": "https://schema.org",
		"@type": "Organization",
		"name": "노벨피아",
		"url": "https://novelpia.com",
		"sameAs": [
			"https://blog.naver.com/adnovelpia",
			"https://www.instagram.com/novelpia_official/",
			"https://www.facebook.com/novelpia.page",
			"https://twitter.com/novel_pia",
			"https://www.youtube.com/channel/UC4Mw_07vcLJ9uOZuukobTYQ"
		]
	}
</script>


<script>
    // 공통 함수
    const _gotoOutlink = function (_url) {
                                    window.open(_url, '_blank');
                        }
</script>
<script>
    // http("get", "/proc/marketing", {cmd : "facebook_marketing", event_name : "S_VIEW"});
</script>
<!--RTBHOUSE 다른 페이지 코드-->
<script>
    const has_rtbhEvents = rtbhEvents.filter(v => v.eventType !== 'init');
    if(has_rtbhEvents.length == 0){
       (rtbhEvents = window.rtbhEvents || []).push(
           {
               eventType: 'placebo'
           },
           {
               eventType: 'uid',
               id: '0'
           });
    }
</script>



</body>
<!-- Google Tag Manager (noscript) -->
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TPMXGV7"
			height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<!-- End Google Tag Manager (noscript) -->
</html>
